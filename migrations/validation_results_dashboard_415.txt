
🔍 Validating migration results...
============================================================
📊 Validating 11 questions

📝 Validating Question 1/11
--------------------------------------------------
  🔍 Validating Question 4164: 2 Number of Failed Transactions split by Error Groups
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_granularity as (
    select distinct granularity
    from MD__FATPAY_DASHBOARD_HELP_TA...
    ❌ SQL Error detected in response
    📄 Response: {"data":{"rows":[["2025-06-16T00:00:00Z","PIN",672],["2025-06-23T00:00:00Z","error with 3D",452],["2025-06-23T00:00:00Z","system error",178],["2025-06-09T00:00:00Z","Do not honor",267],["2025-06-09T00:00:00Z","Not sufficient funds",10233],["2025-06-16T00:00:00Z","problem with violation",247],["2025-06-16T00:00:00Z","card limit",1578],["2025-06-16T00:00:00Z","transaction error",4536],["2025-06-23T00:00:00Z","problem with violation",7],["2025-06-16T00:00:00Z","incorrect data",328],["2025-06-23T00:00:00Z","card permission",36],["2025-06-16T00:00:00Z","merchant error",290],["2025-06-23T00:00:00Z","other",380],["2025-06-09T00:00:00Z","card permission",1067],["2025-06-16T00:00:00Z","Bank fraud monitoring",22],["2025-06-16T00:00:00Z","system error",9271],["2025-06-23T00:00:00Z","transaction error",98],["2025-06-16T00:00:00Z","Do not honor",209],["2025-06-09T00:00:00Z","incorrect data",243],["2025-06-09T00:00:00Z","problem with violation",219],["2025-06-16T00:00:00Z","card permission",1215],["2025-06-23T00:00:00Z","Not sufficient funds",233],["2025-06-16T00:00:00Z","Not sufficient funds",10517],["2025-06-09T00:00:00Z","error with 3D",8797],["2025-06-16T00:00:00Z","Acquirer fraud monitoring",4969],["2025-06-09T00:00:00Z","transaction error",4602],["2025-06-23T00:00:00Z","Acquirer fraud monitoring",121],["2025-06-23T00:00:00Z","incorrect data",4],["2025-06-16T00:00:00Z","other",23845],["2025-06-09T00:00:00Z","other",21474],["2025-06-23T00:00:00Z","Do not honor",12],["2025-06-09T00:00:00Z","card limit",1142],["2025-06-09T00:00:00Z","Bank fraud monitoring",7],["2025-06-09T00:00:00Z","merchant error",264],["2025-06-23T00:00:00Z","Bank fraud monitoring",2],["2025-06-23T00:00:00Z","PIN",19],["2025-06-23T00:00:00Z","card limit",60],["2025-06-23T00:00:00Z","merchant error",8],["2025-06-16T00:00:00Z","error with 3D",14315],["2025-06-09T00:00:00Z","Acquirer fraud monitoring",4509],["2025-06-09T00:00:00Z","PIN",729],["2025-06-09T00:00:00Z","system error",11410]],"cols":[{"display_name":"CREATED_AT","source":"native","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"name":"CREATED_AT","base_type":"type/DateTime","database_type":"DATETIME","effective_type":"type/DateTime"},{"display_name":"GROUP_ERROR","source":"native","field_ref":["field","GROUP_ERROR",{"base-type":"type/Text"}],"name":"GROUP_ERROR","base_type":"type/Text","database_type":"VARCHAR","effective_type":"type/Text"},{"display_name":"COUNT_GROUP","source":"native","field_ref":["field","COUNT_GROUP",{"base-type":"type/BigInteger"}],"name":"COUNT_GROUP","base_type":"type/BigInteger","database_type":"BIGINT","effective_type":"type/BigInteger"}],"native_form":{"params":["week","2025-06-09T00:00:00Z","2025-06-24T00:00:00Z","week"],"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where ?\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        STATUS_NAME = 'error' and\n        `MART__FATPAY`.`CREATED_AT` >= ? AND `MART__FATPAY`.`CREATED_AT` < ?\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and day(CREATED_AT) <= 31\n)\n\nselect \n    date_trunc(?, MART__FATPAY.CREATED_AT) as CREATED_AT,\n    MART__FATPAY.GROUP_ERROR,\n    count(distinct MART__FATPAY.ORDER_ID) as COUNT_GROUP\nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\ngroup by 1, 2"},"results_timezone":"Etc/UTC","format-rows?":true,"results_metadata":{"columns":[{"display_name":"CREATED_AT","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"base_type":"type/DateTime","effective_type":"type/DateTime","name":"CREATED_AT","semantic_type":"type/CreationTimestamp","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/DateTime":{"earliest":"2025-06-09T00:00:00Z","latest":"2025-06-23T00:00:00Z"}}}},{"display_name":"GROUP_ERROR","field_ref":["field","GROUP_ERROR",{"base-type":"type/Text"}],"base_type":"type/Text","effective_type":"type/Text","name":"GROUP_ERROR","semantic_type":null,"fingerprint":{"global":{"distinct-count":14,"nil%":0.0},"type":{"type/Text":{"percent-json":0.0,"percent-url":0.0,"percent-email":0.0,"percent-state":0.0,"average-length":14.5}}}},{"display_name":"COUNT_GROUP","field_ref":["field","COUNT_GROUP",{"base-type":"type/BigInteger"}],"base_type":"type/BigInteger","effective_type":"type/BigInteger","name":"COUNT_GROUP","semantic_type":null,"fingerprint":{"global":{"distinct-count":41,"nil%":0.0},"type":{"type/Number":{"min":2.0,"q1":98.0,"q3":4536.0,"max":23845.0,"sd":5804.470810475593,"avg":3299.690476190476}}}}]},"insights":[{"previous-value":null,"unit":null,"offset":6550315.073130822,"last-change":null,"col":"COUNT_GROUP","slope":-323.2295918368121,"last-value":11410,"best-fit":["+",6550315.073130822,["*",-323.2295918368121,"x"]]}]},"cached":null,"database_id":16,"started_at":"2025-06-23T08:45:36.462771991Z","json_query":{"type":"native","database":16,"native":{"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{granularity}}\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        STATUS_NAME = 'error' and\n        {{CREATED_AT}}\n        and {{CARD_GEOSCHEME}}\n        and {{CARD_COUNTRY}}\n        and {{STATUS}}\n        and {{BUSINESS_NAME}}\n        and {{USER_NAME}}\n        and {{FIAT_CURRENCY}}\n        and {{ACQUIRER}}\n        and {{CARD_BRAND}}\n        and {{PAYMENT_TERMINAL}}\n        and {{ERROR_GROUP}}\n        and {{ERROR_NAME}}\n        and {{HAS_ID_PROVIDER}}\n        and {{SHOP}}\n        and {{is_aft}}\n        and day(CREATED_AT) <= {{day_number}}\n)\n\nselect \n    date_trunc({{granularity}}, MART__FATPAY.CREATED_AT) as CREATED_AT,\n    MART__FATPAY.GROUP_ERROR,\n    count(distinct MART__FATPAY.ORDER_ID) as COUNT_GROUP\nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\ngroup by 1, 2","template-tags":{"HAS_ID_PROVIDER":{"id":"0cab7ecd-bcfe-9d5f-7320-9e4448c813ce","name":"HAS_ID_PROVIDER","display-name":"Has id provider","type":"dimension","dimension":["field",756250,null],"widget-type":"string/=","default":null},"CARD_COUNTRY":{"id":"29492df1-225c-ccb0-9a4e-272c5f987ac5","name":"CARD_COUNTRY","display-name":"Card country","type":"dimension","dimension":["field",756254,null],"widget-type":"string/=","default":null},"ERROR_GROUP":{"id":"bb7f9117-7da8-bc24-8190-7626f33e6af0","name":"ERROR_GROUP","display-name":"Error group","type":"dimension","dimension":["field",756269,null],"widget-type":"string/=","default":null},"FIAT_CURRENCY":{"id":"5cab7ad0-e021-f0c5-4e22-a66c43242330","name":"FIAT_CURRENCY","display-name":"Fiat currency","type":"dimension","dimension":["field",756268,null],"widget-type":"string/=","default":null},"is_aft":{"type":"dimension","name":"is_aft","id":"92bbfa75-da6c-4943-91ea-dca9e22219be","display-name":"Is Aft","default":null,"dimension":["field",760549,null],"widget-type":"string/=","options":null},"ERROR_NAME":{"id":"4ed8b652-3c97-6a86-8a35-7a397b6f42ea","name":"ERROR_NAME","display-name":"Error name","type":"dimension","dimension":["field",756230,null],"widget-type":"string/contains","default":null},"PAYMENT_TERMINAL":{"id":"cd9daa34-226e-58e4-673d-7fd1179e7dee","name":"PAYMENT_TERMINAL","display-name":"Payment terminal","type":"dimension","dimension":["field",756239,null],"widget-type":"string/=","default":null},"SHOP":{"id":"5b9ce965-4e78-48d5-eb6d-66003017f7db","name":"SHOP","display-name":"Shop","type":"dimension","dimension":["field",756245,null],"widget-type":"string/="},"BUSINESS_NAME":{"id":"1a7ca3c6-ac96-dcc3-dbdc-20e1d3c55320","name":"BUSINESS_NAME","display-name":"Business name","type":"dimension","dimension":["field",756258,null],"widget-type":"string/=","default":null},"day_number":{"type":"number","name":"day_number","id":"98c78ebf-1968-4ccd-b539-798aa9f939e8","display-name":"Month-to-Date Day Number","default":"31","required":true},"granularity":{"id":"37799d21-54a5-2233-9de5-517db3c5bab0","name":"granularity","display-name":"Granularity","type":"text","required":true,"default":"week","values-source-type":"static-list","values-source-config":{"values":[["hour"],["day"],["week"],["month"],["quarter"],["year"]]}},"ACQUIRER":{"id":"0add554f-79fc-6685-f405-66c92af72b79","name":"ACQUIRER","display-name":"Acquirer","type":"dimension","dimension":["field",756224,null],"widget-type":"string/=","default":null},"CREATED_AT":{"id":"7e66dcc1-f9af-d388-5804-ea74427d78fb","name":"CREATED_AT","display-name":"Created at","type":"dimension","dimension":["field",756256,null],"widget-type":"date/all-options","default":"past14days~","required":true},"CARD_GEOSCHEME":{"id":"0d642257-5a4e-bc22-1afa-998bdf910c28","name":"CARD_GEOSCHEME","display-name":"Card geoscheme","type":"dimension","dimension":["field",756227,null],"widget-type":"string/=","default":null},"USER_NAME":{"id":"0ed73475-19ec-3399-0857-ad2c1e797d73","name":"USER_NAME","display-name":"User name","type":"dimension","dimension":["field",756263,null],"widget-type":"string/contains","default":null},"STATUS":{"id":"f05b9ffc-bfb1-f94b-4509-3fa683d56e44","name":"STATUS","display-name":"Status","type":"dimension","dimension":["field",756257,null],"widget-type":"string/=","default":null},"CARD_BRAND":{"id":"45d19436-bb36-cae1-7b66-470806737fb6","name":"CARD_BRAND","display-name":"Card brand","type":"dimension","dimension":["field",756238,null],"widget-type":"string/=","default":null}}},"middleware":{"js-int-to-string?":true,"userland-query?":true,"add-default-userland-constraints?":true}},"average_execution_time":null,"status":"completed","context":"ad-hoc","row_count":42,"running_time":163}

📝 Validating Question 2/11
--------------------------------------------------
  🔍 Validating Question 4166: 2 Number of Transactions split by Error Groups table
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_fatpay as (
    select *
    from MART__FATPAY
    where -- IS_CARD_BINDING = FALSE an...
    ❌ SQL Error: Getting syntax error at line 34, column 21. Detail message: No viable statement for input 'with filtered_fatpay as (
    select *
    from MART__FATPAY
    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and 
        `MART__FATPAY`.`CREATED_AT` >= '2025-06-09 00:00:00' AND `MART__FATPAY`.`CREATED_AT` < '2025-06-24 00:00:00'
        and 1 = 1
        and 1 = 1
        and 1 = 1
        and 1 = 1
        and 1 = 1
        and 1 = 1
        and 1 = 1
        and 1 = 1
        and 1 = 1
        and 1 = 1
        and 1 = 1
        and 1 = 1
        and 1 = 1
        and 1 = 1
        and day(CREATED_AT) <= 31
),

count_groups as (
    select 
        case 
            when STATUS_NAME='error' then concat('Error: ', GROUP_ERROR)
            when STATUS_NAME in('complete') then 'Successful: complete transaction'
            when STATUS_NAME in('void') then 'Merchant Void transaction'
            else 'other statuses'
        end as GROUP_NAME,
        count(distinct ORDER_ID) as N_GROUPS
    from filtered_fatpay
    group by grouped sets'.

📝 Validating Question 3/11
--------------------------------------------------
  🔍 Validating Question 4161: 2 Number of Failed Transactions split by Error Names table
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_fatpay as (
    select *
    from MART__FATPAY
    where -- IS_CARD_BINDING = FALSE an...
    ❌ SQL Error detected in response
    📄 Response: {"data":{"rows":[["Total Errors",null,138587,1.0],["Not sufficient funds","Insufficient funds",9216,0.06649974384321762],["other","Blocked due to risk score",7350,0.05303527747912863],["error with 3D","Secure 3d timeout",7219,0.05209002287371831],["system error","Timeout",6877,0.04962225894203641],["other","challenge/authentication failed.",6093,0.04396516267759602],["system error","Transaction timed out",5583,0.04028516383210547],["Not sufficient funds","[0.1.0] Insufficient funds.",5315,0.03835136051722023],["other","External decline, call to issuer",4649,0.03354571496605021],["Acquirer fraud monitoring","[0.1.0] Suspected fraud.",4468,0.032239676160101594],["system error","processing.errors.fraud_error",3854,0.027809246177491396],["error with 3D","Authentication 3DS failed",3615,0.026084697698918368],["other","Client verification unsuccessful",3120,0.022512934113589296],["transaction error","Ineligible transaction or Invalid transaction code",3009,0.021711993188394296],["system error","Processing error",2909,0.020990424787317715],["other","Unsupported card. Try another one",2829,0.02041317006645645],["Not sufficient funds","Insufficient Funds",2715,0.019590582089229147],["error with 3D","No 3DS payment prohibited or 3DS not passed",2491,0.01797426887081761],["error with 3D","[0.1.0] Failed 3DSecure Authentication.",1934,0.013955132876821059],["other","Challenge failed",1746,0.012598584282797087],["other","Declined by issuing bank",1698,0.01225223145028033],["other","[0.1.0] Policy.",1687,0.012172858926161906],["other","[0.1.0] Do not honor.",1613,0.011638898309365237],["card limit","[0.1.0] Exceeds withdrawal limit.",1435,0.010354506555448924],["Not sufficient funds","Insufficient funds/over credit limit",1341,0.009676232258436938],["Acquirer fraud monitoring","[0.1100.1116] Declined by acquirer's antifraud",1308,0.009438114686081666],["error with 3D","[ERROR_3DS_FAILURE] ERROR_3DS_FAILURE",1305,0.00941646763404937],["Acquirer fraud monitoring","[ERROR_PROCESSING_CARD - [59]] Suspected Fraud",1301,0.009387604898006307],["other","null error",1219,0.008795918809123511],["Acquirer fraud monitoring","Suspected fraud",1180,0.008514507132703644],["transaction error","Transaction declined by the issuing bank",1175,0.008478428712649816],["other","Declined by Risk Check",1148,0.008283605244359138],["other","[N] Authentication failed",1072,0.0077352132595409386],["error with 3D","[180000] 3Dv2 failed, status 'N': not authenticated/account not verified; transaction denied",1051,0.007583683895314856],["error with 3D","[0.9075.0] 3D Secure authentication failed, payment not allowed.",1033,0.007453801583121072],["card permission","[0.1.0] Transaction not permitted to cardholder.",982,0.007085801698572016],["Not sufficient funds","Not sufficient funds",967,0.006977566438410529],["Not sufficient funds","[ERROR_PROCESSING_CARD - [51]] Insufficient Funds",843,0.00608282162107557],["other","The authentication is cancelled or abandoned",810,0.005844704048720299],["other","Routing cannot be performed with the provided parameters",713,0.0051447826996760156],["transaction error","[180001] No transaction registered on processor's side",692,0.004993253335449934],["other","Security",676,0.004877802391277681],["transaction error","Transaction expired",668,0.004820076919191555],["other","[R] Authentication failed",624,0.004502586822717859],["error with 3D","Fail to authenticate 3ds challenge. 14",619,0.004466508402664031],["Not sufficient funds","Insufficient funds Insufficient funds",563,0.004062430098061146],["error with 3D","[ERROR_3DS_FAILURE] 3DS Verification timeout",528,0.003809881157684343],["error with 3D","Failed 3DSecure Authentication",515,0.003716077265544387],["system error","Restricted or invalid card status, call to issuer",510,0.003679998845490558],["transaction error","Transaction declined",509,0.0036727831614797924],["error with 3D","Fail to authenticate 3ds challenge. ",502,0.003622273373404432],["other","Service temporary unavailable. Please try again",490,0.003535685165275242],["Do not honor","Do not honor",488,0.0035212537972537108],["other","Uses limit exceeded, call to issuer",477,0.003441881273135287],["PIN","[0.1.0] Invalid CVV2.",430,0.003102744124629294],["Acquirer fraud monitoring","Suspected Fraud",425,0.0030666657045754653],["other","[ERROR_PROCESSING_CARD - [05]] Do Not Honor",421,0.003037802968532402],["other","Order not found",416,0.003001724548478573],["transaction error","[90806] The transaction has been declined with the following code: 9896:90806. Please contact support.",409,0.0029512147604032124],["merchant error","[0.1.0] Invalid merchant.",405,0.0029223520243601493],["other","Payment failed",403,0.0029079206563386176],["transaction error","[0.1.0] Blocked, first used-transaction from new cardholder, and card not properly unblocked.",383,0.0027636069761233016],["other","No acquirer configured for this card type No acquirer configured for this card type",374,0.0026986658200264095],["error with 3D","Fail to authenticate 3ds challenge. 01",371,0.002677018767994112],["transaction error","transaction declined by authorization system",369,0.0026625873999725803],["system error","risk management transaction timeout",359,0.0025904305598649226],["error with 3D","[ERROR_3DS_AUTHENTICATION_FAILURE] The request attempted an operation that requires a card, but the 3DS authentication failed. The request was rejected. Corrective action: Try the request again. If the error persists, advise the customer to contact the ca",349,0.0025182737197572643],["Acquirer fraud monitoring","Fraudulent card Suspected fraud",332,0.0023956070915742457],["other","[0.1.0] Expired card.",325,0.0023450973034988853],["other","[90093] The sender has exceeded the daily quantity limit.",321,0.002316234567455822],["card permission","[ERROR_PROCESSING_CARD - [57]] Transaction not Permitted to Cardholder",318,0.0022945875154235244],["other","Authorization declined 05 DECLINED",305,0.0022007836232835693],["other","[ERROR_PROCESSING_CARD - [82]] Negative CAM, dCVV, iCVV, or CVV results",299,0.0021574895192189745],["other","Expired card",295,0.002128626783175911],["card limit","Withdrawal limit exceeded",292,0.0021069797311436137],["transaction error","Risk Blocked Transaction",288,0.0020781169951005506],["error with 3D","3D-Secure Challenge failed Card authentication failed",285,0.0020564699430682533],["PIN","Decline for CVV2 failure",272,0.0019626660509282977],["PIN","Invalid CVV2",262,0.0018905092108206397],["other","Session not found or inactive",228,0.0016451759544546026],["problem with violation","Restricted card",226,0.0016307445864330709],["card permission","Transaction not Permitted to Cardholder",221,0.001594666166379242],["system error","processing.errors.default",220,0.0015874504823684761],["other","Bad Parameters in request",216,0.0015585877463254129],["card limit","[ERROR_PROCESSING_CARD - [61]] Withdrawal Amount Limit Exceeded",211,0.001522509326271584],["other","[0.1.0] Exceeds withdrawal frequency.",210,0.0015152936422608181],["Acquirer fraud monitoring","[0.1.0] Security violation.",209,0.0015080779582500523],["card permission","Transaction not permitted to issuer/cardholder",207,0.0014936465902285207],["incorrect data","Invalid input document",197,0.0014214897501208627],["transaction error","transaction declined (maximum transaction frequency exceeded)",197,0.0014214897501208627],["PIN","[ERROR_PROCESSING_CARD - [N7]] CVV2 Failure",192,0.0013854113300670336],["transaction error","Transaction limit exceeded",186,0.0013421172260024389],["system error","[ERROR_PROCESSING_CARD - [59]] [Suspected Fraud] The request attempted a card operation, but the card issuer suspects fraud in this transaction. The request was rejected. Corrective action: Consider not doing business with this customer.",186,0.0013421172260024389],["card permission","transaction declined (transaction not permitted)",183,0.0013204701739701415],["other","[0.1.0] Life Cycle.",182,0.0013132544899593756],["transaction error","Transaction rejected, card is blocked , Block type: PERMANENT",180,0.001298823121937844],["error with 3D","3D-Secure Authentication rejected 3D-Secure Authentication rejected",178,0.0012843917539163126],["other","User Authentication Failed",177,0.0012771760699055467],["error with 3D","3D secure verification failed",175,0.001262744701884015],["other","Bad CVV",175,0.001262744701884015],["other","Declined - Do Not Honour",173,0.0012483133338624835],["card limit","Exceeds withdrawal limit",167,0.0012050192297978887],["other","Policy",166,0.0011978035457871229],["error with 3D","Invalid 3DS flow",159,0.0011472937577117622],["other","[0.1100.1109] Not allowed to process this CC company.",157,0.0011328623896902307],["card permission","Transaction not permitted to cardholder",153,0.0011039996536471675],["other","[ERROR_PROCESSING_CARD - [78]] Blocked, first used",151,0.001089568285625636],["error with 3D","[180005] 3Dv2 error: Not authenticated/account not verified; transaction denied.",149,0.0010751369176041042],["transaction error","transaction declined (invalid CVV)",144,0.0010390584975502753],["error with 3D","Fail to start 3ds authentication. 01",140,0.001010195761507212],["error with 3D","[180004] 3Dv2 failed, status 'U': authentication/account verification could not be performed; technical or other problem",134,9.669016574426173E-4],["problem with violation","[0.1.0] Restricted card.",132,9.524702894210857E-4],["other","Cardholder selected “Cancel”",132,9.524702894210857E-4],["other","Unable to authorize, call to issuer",131,9.452546054103198E-4],["other","Session expired",119,8.586663972811303E-4],["other","Cancelled by user",115,8.298036612380671E-4],["PIN","Transaction declined Decline for CVV2 failure",114,8.225879772273013E-4],["card permission","[0.1.0] Transaction not permitted on terminal.",113,8.153722932165354E-4],["other","Not authenticated because the issuer is rejecting authentication",110,7.937252411842381E-4],["other","[0.1.0] System Error.",108,7.792938731627064E-4],["transaction error","Blocked, first use - transaction from new cardholder, and card not properly unblocked",105,7.576468211304091E-4],["card limit","Exceeds withdrawal amount limit",103,7.432154531088774E-4],["Acquirer fraud monitoring","Fraud/Security",103,7.432154531088774E-4],["card limit","[0.1100.1201] Invalid Amount.",96,6.927056650335168E-4],["other","[0.1100.1290] NextAction is DoChallenge but challenge result is not allowing Sale/Auth.",95,6.85489981022751E-4],["error with 3D","3D-Secure: Not Authenticated, but Mandatory 3D-Secure: Not Authenticated, but Mandatory",95,6.85489981022751E-4],["error with 3D","[180006] 3Dv2 error: Authentication/account verification rejected; issuer is rejecting authentication/verification and request that authorization not be attempted.",93,6.710586130012194E-4],["other","Ineligible account or Account not found",92,6.638429289904537E-4],["incorrect data","Invalid card number",90,6.49411560968922E-4],["other","[0.1.0] Negative CAM, dCVV, iCVV, or CVV results.",87,6.277645089366247E-4],["error with 3D","3D Secure authentication failed, payment not allowed",86,6.205488249258588E-4],["transaction error","Transaction Cannot be Completed",85,6.13333140915093E-4],["error with 3D","3D-Secure Challenge failed Transaction timed out at the ACS",83,5.989017728935614E-4],["system error","processing.errors.card_cardholder",78,5.628233528397324E-4],["card limit","[ERROR_PROCESSING_CARD - [61]] [Withdrawal Amount Limit Exceeded] The request attempted a card operation, but the transaction would exceed the card limit. The request was rejected. Corrective action: Advise the cardholder to add funds to the account or us",78,5.628233528397324E-4],["card permission","[ERROR_PROCESSING_CARD - [57]] [Transaction not Permitted to Cardholder] The request attempted a card operation, but the card is not authorized for this type of transaction. The request was rejected. Corrective action: Advise the customer to contact the c",75,5.41176300807435E-4],["system error","Transaction Timed Out at ACS—other timeouts",73,5.267449327859034E-4],["card limit","[ERROR_PROCESSING_CARD - [51]] [Insufficient Funds] The request attempted a card operation, but the transaction would exceed the card limit. The request was rejected. Corrective action: Advise the cardholder to add funds to the account or use a different ",72,5.195292487751377E-4],["transaction error","Blocked, first used-transaction from new cardholder, and card not properly unblocked",72,5.195292487751377E-4],["other","[0.1.-1] UNEXPECTED SYSTEM ERROR - PLEASE RETRY LATER.",71,5.123135647643718E-4],["other","[0.1.0] Blocked by cardholder, contact cardholder.",70,5.05097880753606E-4],["incorrect data","Cardholder name is of incorrect format or invalid",66,4.7623514471054285E-4],["other","Exceeds approval amount limit",66,4.7623514471054285E-4],["card limit","Exceeds withdrawal frequency limit",65,4.6901946069977704E-4],["other","[U] Authentication failed",63,4.545880926782454E-4],["merchant error","Invalid merchant or service provider",61,4.4015672465671385E-4],["other","Soft Decline - Authentication is Advised",60,4.3294104064594803E-4],["other","[90026] The sender has exceeded the daily decline quantity limit.",58,4.185096726244164E-4],["card limit","Exceeds withdrawal amount limit 61 EXCEEDS APPROVAL AMOUNT LIMIT",58,4.185096726244164E-4],["other","Duplicate Challenge Request",57,4.1129398861365065E-4],["card limit","[0.1.0] Invalid amount.",57,4.1129398861365065E-4],["problem with violation","[ERROR_PROCESSING_CARD - [62]] Restricted Card",57,4.1129398861365065E-4],["transaction error","Transaction Error",55,3.9686262059211903E-4],["error with 3D","Fail to authenticate 3ds challenge. 22",55,3.9686262059211903E-4],["transaction error","[0.1.0] Invalid transaction.",55,3.9686262059211903E-4],["incorrect data","[0.1100.10050]  Missing Mandatory field : sg_FirstName.",54,3.896469365813532E-4],["other","[0.1.0] Soft Decline - Authentication is Advised.",53,3.824312525705874E-4],["other","Request error",51,3.6799988454905584E-4],["Acquirer fraud monitoring","[0.1.0] Transaction cannot be completed; violation of law.",50,3.6078420053829003E-4],["card limit","Invalid Value/Amount",50,3.6078420053829003E-4],["other","[ERROR_PROCESSING_CARD - [54]] Expired Card",50,3.6078420053829003E-4],["PIN","[0.1.0] Cryptographic error found in PIN.",48,3.463528325167584E-4],["error with 3D","[ERROR_CARD_AUTHENTICATION_FAILURE] 3DS Verification timeout",47,3.3913714850599265E-4],["other","Cannot validate session",47,3.3913714850599265E-4],["other","Blocked by BIN Country: GB",45,3.24705780484461E-4],["other","NextAction is DoChallenge but challenge result is not allowing Sale/Auth",44,3.174900964736952E-4],["other","Blocked, first used or special condition—new cardholder not activated or card is temporarily blocked",44,3.174900964736952E-4],["transaction error","[188831] [E01587] Transaction rejected, business card not supported",43,3.102744124629294E-4],["incorrect data","[0.1.0] Invalid Card Number.",42,3.0305872845216365E-4],["transaction error","maximum total volume of transactions per account already exceeded",42,3.0305872845216365E-4],["other","Format error",41,2.9584304444139783E-4],["transaction error","Transaction declined Activity amount limit exceeded",41,2.9584304444139783E-4],["transaction error","[0.1.0] Transaction not supported, blocked by issuer.",40,2.88627360430632E-4],["card limit","Exceeds Withdrawal Value/Amount Limits",39,2.814116764198662E-4],["system error","[ERROR_PROCESSING_CARD - [15]] Invalid Issuer",39,2.814116764198662E-4],["other","[ERROR_PROCESSING_CARD - [19]] Re-enter",38,2.741959924091004E-4],["transaction error","[ERROR_PROCESSING_CARD - [12]] Invalid Transaction",38,2.741959924091004E-4],["other","[REQUEST_DECLINED_RP] Your request was declined. For more information, please log in to Client Portal.",37,2.6698030839833464E-4],["other","Lifecycle",37,2.6698030839833464E-4],["system error","[ERROR_PROCESSING_CARD - [05]] [Do Not Honor] The request attempted a card operation, but the card issuer refused the transaction. The request was rejected. Corrective action: Advise the customer to use a different payment method.",36,2.5976462438756883E-4],["transaction error","[90954] The transaction has been declined with the code 9944:90954; please contact support.",36,2.5976462438756883E-4],["error with 3D","Declined by 3-D Secure",35,2.52548940376803E-4],["merchant error","[ERROR_PROCESSING_CARD - [03]] Invalid Merchant",34,2.453332563660372E-4],["other","error response from connector/acquirer",34,2.453332563660372E-4],["transaction error","transaction declined (wrong expiry date)",33,2.3811757235527142E-4],["error with 3D","Invalid card type for 3D-Secure Invalid card type for 3D-Secure",33,2.3811757235527142E-4],["other","Error",32,2.309018883445056E-4],["merchant error","Invalid merchant 03 INVALID MERCHANT NUMBER",32,2.309018883445056E-4],["PIN","Negative Online CAM, dCVV, iCVV, or CVV results/Offline PIN authentication interrupted/Policy (Mastercard use only)",32,2.309018883445056E-4],["transaction error","Transaction declined Do not honour",32,2.309018883445056E-4],["other","Blocked by cardholder, contact cardholder",31,2.2368620433373983E-4],["Bank fraud monitoring","[180009] [E0200] Transaction rejected, card is blocked",31,2.2368620433373983E-4],["error with 3D","Fail to start 3ds authentication. 11",30,2.1647052032297402E-4],["card permission","Transaction declined Transaction not permitted to cardholder",29,2.092548363122082E-4],["Acquirer fraud monitoring","[ERROR_PROCESSING_CARD - [83]] Fraud/Security related",29,2.092548363122082E-4],["incorrect data","Invalid card data",28,2.0203915230144242E-4],["card permission","[ERROR_PROCESSING_CARD - [58]] Transaction not Permitted to Acquirer or Terminal",28,2.0203915230144242E-4],["transaction error","Transaction declined 'Blocked, first used', the transaction is from a new Cardholder, and the card has not been properly unblocked",28,2.0203915230144242E-4],["error with 3D","Fail to authenticate 3ds challenge. 11",28,2.0203915230144242E-4],["error with 3D","Fail to start 3ds authentication. 12",27,1.948234682906766E-4],["other","Payment not found",27,1.948234682906766E-4],["transaction error","Transaction failed 84 LIFE CYCLE",27,1.948234682906766E-4],["transaction error","transaction declined for unknown reason",26,1.8760778427991083E-4],["Acquirer fraud monitoring","[ERROR_PROCESSING_CARD - [93]] Violation, cannot complete",26,1.8760778427991083E-4],["transaction error","Transaction failed 83 SECURITY",26,1.8760778427991083E-4],["other","[90023] A duplicate credit card has been identified.",26,1.8760778427991083E-4],["system error","processing.errors.missing_params",25,1.8039210026914501E-4],["other","Negative CAM, dCVV, iCVV, or CVV results",25,1.8039210026914501E-4],["transaction error","The transaction has been declined with the code 9939:90949; please contact support.",23,1.6596073224761342E-4],["incorrect data","Invalid/nonexistent account specified (general)",22,1.587450482368476E-4],["card limit","[ERROR_PROCESSING_CARD - [65]] Authentication Required or Activity Limit Exceeded",22,1.587450482368476E-4],["Acquirer fraud monitoring","83, MAC 01: Fraud/Security - Retry using authentication",20,1.44313680215316E-4],["other","[0.1.0] Closed account.",19,1.370979962045502E-4],["PIN","Invalid CVV2 code",19,1.370979962045502E-4],["problem with violation","transaction declined (restricted card)",19,1.370979962045502E-4],["other","Fail to retrieve card details. Not Found",19,1.370979962045502E-4],["other","Expired card Expired card or expiration date missing",19,1.370979962045502E-4],["other","OTP tries limit was exceeded",19,1.370979962045502E-4],["error with 3D","3D-Secure Challenge failed ACS technical issue",19,1.370979962045502E-4],["other","Expired Card",18,1.2988231219378442E-4],["Acquirer fraud monitoring","Authentication failed due to suspected fraud",18,1.2988231219378442E-4],["Not sufficient funds","51: Insufficient funds",18,1.2988231219378442E-4],["transaction error","Transaction not allowed at terminal",18,1.2988231219378442E-4],["Acquirer fraud monitoring","[0.1.0] Pick-up card.",18,1.2988231219378442E-4],["transaction error","Transaction not supported, blocked by issuer",17,1.226666281830186E-4],["transaction error","[ERROR_PROCESSING_CARD - [1A]] The request attempted a card operation, but there was a problem with the transaction. The request was rejected. Corrective action: Contact the issuing bank with the two-digit error that appears at the end of the error code.",17,1.226666281830186E-4],["other","[189739] [E9002] Error mpi connection",16,1.154509441722528E-4],["error with 3D","Exceeds withdrawal count limit OR soft-decline of EMV 3DS authentication",16,1.154509441722528E-4],["other","Exceeds withdrawal frequency",16,1.154509441722528E-4],["transaction error","transaction declined (limit exceeded)",16,1.154509441722528E-4],["error with 3D","3D Secure transaction rejected",15,1.0823526016148701E-4],["Acquirer fraud monitoring","Security Violation",15,1.0823526016148701E-4],["other","Payment amount limit excess",15,1.0823526016148701E-4],["transaction error","[784022] Transaction declined, check response code for reason",15,1.0823526016148701E-4],["problem with violation","[180095] [E0204] Transaction rejected, user is on aml list",15,1.0823526016148701E-4],["error with 3D","Fail to authenticate 3ds challenge. 19",15,1.0823526016148701E-4],["other","[2009G] Blocked by cardholder/contact cardholder",15,1.0823526016148701E-4],["error with 3D","3D-Secure Challenge failed Authentication attempted but not performed by the cardholder",15,1.0823526016148701E-4],["transaction error","Transaction declined 82 POLICY",14,1.0101957615072121E-4],["error with 3D","3D-Secure unauthenticated, but mandatory",14,1.0101957615072121E-4],["incorrect data","Invalid cvv",14,1.0101957615072121E-4],["incorrect data","[ERROR_PROCESSING_CARD - [14]] Invalid Card Number",14,1.0101957615072121E-4],["other","Blocked by BIN Country: ZA",13,9.380389213995541E-5],["PIN","Transaction declined Negative online CAM, dCVV, iCVV, or CVV results, or Offline PIN authentication was interrupted",13,9.380389213995541E-5],["transaction error","[ERROR_PROCESSING_CARD - [82]] The request attempted a card operation, but there was a problem with the transaction. The request was rejected. Corrective action: Contact the issuing bank with the two-digit error that appears at the end of the error code.",13,9.380389213995541E-5],["card limit","Invalid amount",13,9.380389213995541E-5],["other","[0.1.0] Issuer or switch inoperative.",13,9.380389213995541E-5],["system error","processing.errors.card_expiration",13,9.380389213995541E-5],["other","[ERROR_PROCESSING_CARD - [46]] Closed Account",13,9.380389213995541E-5],["transaction error","Transaction declined (additional customer authentication required)",13,9.380389213995541E-5],["Acquirer fraud monitoring","Fraud/Security (Mastercard use only)",12,8.65882081291896E-5],["other","Unknown error",12,8.65882081291896E-5],["incorrect data","[0.1.0] Invalid Issue Number.",12,8.65882081291896E-5],["Acquirer fraud monitoring","[59] Suspected Fraud",12,8.65882081291896E-5],["transaction error","[ERROR_PROCESSING_CARD - [N7]] The request attempted a card operation, but there was a problem with the transaction. The request was rejected. Corrective action: Contact the issuing bank with the two-digit error that appears at the end of the error code.",11,7.93725241184238E-5],["error with 3D","Technical Error in 3D system",11,7.93725241184238E-5],["error with 3D","Fail to start 3ds authentication. 04",11,7.93725241184238E-5],["merchant error","Invalid merchant",11,7.93725241184238E-5],["other","[ERROR_PROCESSING_CARD - [78]] [Blocked, first used] The request attempted a card operation, but the card is new and has not yet been unblocked. The request was rejected. Corrective action: Advise the cardholder to complete the process for unblocking the ",11,7.93725241184238E-5],["other","{\"validation_error\":{\"cvv\":\"cvv must have a length of 3\"}}",11,7.93725241184238E-5],["other","Blacklisted country",11,7.93725241184238E-5],["other","Blocked by BIN Country: TR",11,7.93725241184238E-5],["other","Message Version Number received is not valid for the receiving component. 2.2.0",10,7.2156840107658E-5],["transaction error","Fail to authenticate transaction. Invalid Input",10,7.2156840107658E-5],["other","[0.1.0] Account Not Yet Activated.",10,7.2156840107658E-5],["other","Issuer not available",10,7.2156840107658E-5],["card limit","Limit reached Exceeds withdrawal frequency limit",10,7.2156840107658E-5],["error with 3D","3D-Secure Challenge rejected by issuer Authentication rejected",10,7.2156840107658E-5],["transaction error","Transaction declined Additional customer authentication required",10,7.2156840107658E-5],["other","Life cycle",9,6.494115609689221E-5],["system error","[ERROR_PROCESSING_CARD - [93]] [Violation, cannot complete] The request attempted a card operation, but there was an issue with the customer’s account. The request was rejected. Corrective action: Try again. Advise the customer to contact the card issuer,",9,6.494115609689221E-5],["merchant error","Invalid Merchant, or Merchant is not active",9,6.494115609689221E-5],["error with 3D","3D-Secure Challenge failed Exceeds ACS maximum challenges",9,6.494115609689221E-5],["error with 3D","Fail to authenticate 3ds challenge. 26",9,6.494115609689221E-5],["system error","[0.1.0] Invalid transaction; contact card issuer.",9,6.494115609689221E-5],["error with 3D","[180003] 3Dv2 failed, status 'R': not authenticated because the issuer is rejecting authentication.",9,6.494115609689221E-5],["error with 3D","Cardholder failed 3D-Secure authentication",9,6.494115609689221E-5],["other","UNEXPECTED SYSTEM ERROR - PLEASE RETRY LATER",9,6.494115609689221E-5],["system error","Transaction Timed Out at ACS—First CReq not received by ACS",8,5.77254720861264E-5],["other","Blocked by BIN Country: BW",8,5.77254720861264E-5],["error with 3D","Fail to start 3ds authentication. 08",8,5.77254720861264E-5],["other","standard_error",8,5.77254720861264E-5],["Acquirer fraud monitoring","Transaction cannot be completed- violation of law.",8,5.77254720861264E-5],["PIN","[0.1.0] Incorrect PIN.",8,5.77254720861264E-5],["other","[0.1100.1277] DS responded with an error, please verify request and try again.",8,5.77254720861264E-5],["transaction error","Invalid transaction 12 INVALID TRANSACTION",8,5.77254720861264E-5],["problem with violation","Transaction declined Restricted card (card invalid in region or country)",8,5.77254720861264E-5],["transaction error","[784021] Transaction declined, check response code for reason",8,5.77254720861264E-5],["card limit","Exceeds withdrawal count limit",8,5.77254720861264E-5],["error with 3D","3D-Secure Authentication Required",7,5.0509788075360605E-5],["other","[ERROR_CREATE_PAYMENT] The request tried to create a payment, but the payment method was not found. The request was rejected. Corrective action: Use the ID of the payment method in the 'payment_method' field. Alternatively, if the customer has a default p",7,5.0509788075360605E-5],["other","Blocked by BIN Country: LV",7,5.0509788075360605E-5],["system error","processing.errors.card_number",7,5.0509788075360605E-5],["incorrect data","Invalid account number (no such number)",7,5.0509788075360605E-5],["system error","processing.errors.card_cardholder_empty",7,5.0509788075360605E-5],["system error","[ERROR_PROCESSING_CARD - [54]] [Expired Card] The request attempted a card operation, but the card has expired. The request was rejected. Corrective action: Advise the cardholder to use a different payment method, or contact the card issuer to issue a new",6,4.32941040645948E-5],["system error","Refer to Card Issuer",6,4.32941040645948E-5],["PIN","Allowable number of PIN tries exceeded 75 PIN ENTRY TRIES EXEEDED",6,4.32941040645948E-5],["system error","[0.1.0] Timeout/Retry.",6,4.32941040645948E-5],["PIN","Negative online CAM, dCVV, iCVV, CVV, CAVV, dCVV2, TAVV, or DTVV results or Offline PIN authentication interrupted",6,4.32941040645948E-5],["problem with violation","Restricted Card",6,4.32941040645948E-5],["PIN","[0.1.0] PIN tries exceeded.",6,4.32941040645948E-5],["other","[ERROR_CREATE_PAYMENT] Blocked by cardholder/contact cardholder",6,4.32941040645948E-5],["transaction error","Transaction not supported/blocked by issuer",6,4.32941040645948E-5],["other","[05] Do Not Honor",6,4.32941040645948E-5],["transaction error","Transaction declined Blocked by cardholder/contact cardholder",5,3.6078420053829E-5],["problem with violation","Restricted card (card invalid in region or country)",5,3.6078420053829E-5],["other","No payment with indicated details",5,3.6078420053829E-5],["Acquirer fraud monitoring","[0.1.0] Lost card, pick-up.",5,3.6078420053829E-5],["Acquirer fraud monitoring","Pick-up card",5,3.6078420053829E-5],["other","ERROR",5,3.6078420053829E-5],["other","[0.1.0] Call issuer.",5,3.6078420053829E-5],["incorrect data","invalid CVV/brand combination",5,3.6078420053829E-5],["Not sufficient funds","[51] Insufficient Funds",5,3.6078420053829E-5],["transaction error","[ERROR_CREATE_PAYMENT] Transaction not supported/blocked by issuer",5,3.6078420053829E-5],["merchant error","Transaction declined Invalid merchant",5,3.6078420053829E-5],["transaction error","Transaction is declined by issuer",5,3.6078420053829E-5],["Acquirer fraud monitoring","[ERROR_PROCESSING_CARD - [43]] Stolen Card, pick up",5,3.6078420053829E-5],["Acquirer fraud monitoring","[ERROR_PROCESSING_CARD - [63]] Security Violation",5,3.6078420053829E-5],["other","Lost card",5,3.6078420053829E-5],["transaction error","The transaction has been declined with the code 9938:90948; please contact support.",4,2.88627360430632E-5],["incorrect data","[0.1.0] Invalid account specified.",4,2.88627360430632E-5],["other","[1038.0.0] Communication error. ",4,2.88627360430632E-5],["transaction error","transaction declined (suspecting manipulation)",4,2.88627360430632E-5],["other","[0.1100.1110] Unrecognized credit card company.",4,2.88627360430632E-5],["Acquirer fraud monitoring","[ERROR_PROCESSING_CARD - [63]] [Security Violation] The request attempted a card operation, but there was a problem with the card’s security features. The request was rejected. Corrective action: Verify the CVV, or advise the cardholder to use a different",4,2.88627360430632E-5],["system error","General error",4,2.88627360430632E-5],["other","[ERROR_PROCESSING_CARD - [N3]] Cash Service Not Available",4,2.88627360430632E-5],["other","SCA required",4,2.88627360430632E-5],["other","Lookup number of attempts exceeded",4,2.88627360430632E-5],["card limit","61: Exceeds withdrawal amount limit",4,2.88627360430632E-5],["card permission","Transaction not Permitted to Terminal",4,2.88627360430632E-5],["other","Closed account",4,2.88627360430632E-5],["Acquirer fraud monitoring","[0.1.0] Pick up card, special condition (fraud account).",4,2.88627360430632E-5],["Acquirer fraud monitoring","Lost card, pick-up",4,2.88627360430632E-5],["other","82, MAC 02: Policy - Retry later",4,2.88627360430632E-5],["other","[20072] Account Not Yet Activated",4,2.88627360430632E-5],["PIN","Decline for CVV2 Failure",4,2.88627360430632E-5],["Acquirer fraud monitoring","Security violation",4,2.88627360430632E-5],["other","[9077.0.0] Card registration failed. ",4,2.88627360430632E-5],["other","Capture card",4,2.88627360430632E-5],["other","Missing required parameters",4,2.88627360430632E-5],["error with 3D","[0.1100.1293] Temporary Technical Malfunction in 3DS 2.0, Please Retry.",4,2.88627360430632E-5],["transaction error","The transaction has been declined with the code 9944:90954; please contact support.",3,2.16470520322974E-5],["system error","Contact Card Issuer",3,2.16470520322974E-5],["Acquirer fraud monitoring","[ERROR_PROCESSING_CARD - [04]] Pick Up Card, no fraud",3,2.16470520322974E-5],["Acquirer fraud monitoring","Pick Up Card, Special Conditions",3,2.16470520322974E-5],["other","Blocked by BIN Country: GE",3,2.16470520322974E-5],["other","Communication Error to Scheme Directory Server",3,2.16470520322974E-5],["error with 3D","Transaction flow error: 3DS redirect expected",3,2.16470520322974E-5],["other","Upstream terimal configuration not found",3,2.16470520322974E-5],["Acquirer fraud monitoring","[0.1.0] Stolen card, pick-up.",3,2.16470520322974E-5],["incorrect data","[INVALID_CARD_EXPIRATION_DATE] The request attempted an operation that requires a card payment method, but the card expiration date was not valid. The request was rejected. Corrective action: In the 'fields' object, set 'expiration_month' to a 2-digit num",3,2.16470520322974E-5],["system error","System malfunction",3,2.16470520322974E-5],["PIN","[ERROR_PROCESSING_CARD - [75]] Allowable Number of PIN Tries Exceeded",3,2.16470520322974E-5],["error with 3D","[189367] [E1003] Card number not Enrolled in 3DS v2",3,2.16470520322974E-5],["PIN","PIN tries exceeded",3,2.16470520322974E-5],["system error","Authorization Platform or issuer system inoperative",3,2.16470520322974E-5],["incorrect data","Invalid Card Number",3,2.16470520322974E-5],["card permission","Transaction not permitted to acquirer/terminal",3,2.16470520322974E-5],["transaction error","transaction declined (invalid card)",3,2.16470520322974E-5],["transaction error","Fail to authenticate transaction. Unenrolled Account Number",3,2.16470520322974E-5],["system error","System malfunction, System malfunction or certain field error condition",3,2.16470520322974E-5],["transaction error","Transaction declined Transaction not supported/blocked by issuer",3,2.16470520322974E-5],["system error","Refer to card issuer, special condition",3,2.16470520322974E-5],["Acquirer fraud monitoring","Stolen Card - Pick Up",3,2.16470520322974E-5],["other","Closed User Account",2,1.44313680215316E-5],["Acquirer fraud monitoring","transaction declined (pick up card)",2,1.44313680215316E-5],["Acquirer fraud monitoring","Transaction cannot be completed; violation of law",2,1.44313680215316E-5],["PIN","[N7] CVV2 Failure",2,1.44313680215316E-5],["transaction error","Transaction ID Not Recognised threeDSServerTransID or sdkTransID or dsTransID",2,1.44313680215316E-5],["other","ip blacklisted",2,1.44313680215316E-5],["Acquirer fraud monitoring","[ERROR_PROCESSING_CARD - [07]] Pick Up Card, fraud suspected",2,1.44313680215316E-5],["other","Blocked by BIN Country: SE",2,1.44313680215316E-5],["other","Verification data failed",2,1.44313680215316E-5],["incorrect data","Card not enrolled Card not enrolled",2,1.44313680215316E-5],["merchant error","Merchant should retain card (card reported lost)",2,1.44313680215316E-5],["error with 3D","Invalid Auth3d transaction, verify 3DS 2.0 parameters",2,1.44313680215316E-5],["system error","Refer to card issuer",2,1.44313680215316E-5],["transaction error","Invalid Transaction",2,1.44313680215316E-5],["Acquirer fraud monitoring","Lost Card - Pick Up",2,1.44313680215316E-5],["incorrect data","Invalid card number Invalid account number, no such number",2,1.44313680215316E-5],["other","System Error",2,1.44313680215316E-5],["other","DS responded with an error, please verify request and try again",2,1.44313680215316E-5],["incorrect data","[ERROR_CREATE_PAYMENT] Invalid card verification data",2,1.44313680215316E-5],["Acquirer fraud monitoring","[ERROR_PROCESSING_CARD - [41]] Lost Card, pick up",2,1.44313680215316E-5],["incorrect data","invalid cc number/brand combination",2,1.44313680215316E-5],["system error","[ERROR_PROCESSING_CARD - [91]] Authorization Platform or Issuer System Inoperative",2,1.44313680215316E-5],["system error","Timeout/Retry",2,1.44313680215316E-5],["error with 3D","Requested Auth3D 2.0 but card number is not supported with 3DS 2.0",2,1.44313680215316E-5],["other","Transient System Failure Error communicating with Issuer",2,1.44313680215316E-5],["other","Blocked by BIN Country: CO",2,1.44313680215316E-5],["problem with violation","[62] Restricted Card",2,1.44313680215316E-5],["Acquirer fraud monitoring","Stolen card, pick-up",2,1.44313680215316E-5],["other","Cancelled by customer",2,1.44313680215316E-5],["other","[0.1.-1] Generic Decline.",2,1.44313680215316E-5],["system error","Verification Failed (Cardholder Identification does not match issuer records)",2,1.44313680215316E-5],["error with 3D","Fail to authenticate 3ds challenge. 08",2,1.44313680215316E-5],["other","Revocation of Authorization Order",2,1.44313680215316E-5],["error with 3D","Fail to authenticate 3ds challenge. 09",2,1.44313680215316E-5],["system error","[ERROR_PROCESSING_CARD - [83]] [Security Issue or Suspected Fraud] The request attempted a card operation, but there was a security issue or the card issuer suspects fraud. The request was rejected. Corrective action: None. Advise the cardholder to contac",2,1.44313680215316E-5],["system error","[ERROR_PROCESSING_CARD - [96]] System Malfunction",2,1.44313680215316E-5],["other","Blocked by BIN Country: BA",1,7.2156840107658E-6],["other","TRANSID=1120000003979920895 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","No credit account",1,7.2156840107658E-6],["other","TRANSID=1120000003979216060 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005809379354 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005831287452 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["transaction error","Transaction declined Issuer unavailable",1,7.2156840107658E-6],["other","TRANSID=2130000005812234136 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=1120000003978903303 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","Try again later",1,7.2156840107658E-6],["other","TRANSID=1120000003957874793 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1007009523 ",1,7.2156840107658E-6],["other","TRANSID=2130000005831307306 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005831222399 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005811733252 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=1120000003957865270 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1007009523 ",1,7.2156840107658E-6],["other","parsing_error",1,7.2156840107658E-6],["other","The card is already involved in another payment",1,7.2156840107658E-6],["other","TRANSID=1120000003977965784 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["error with 3D","[0.1100.1274] Requested Auth3D 2.0 but card number is not supported with 3DS 2.0.",1,7.2156840107658E-6],["card permission","[57] Transaction not Permitted to Cardholder",1,7.2156840107658E-6],["other","TRANSID=2130000005830331318 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003979710757 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","No Such Issuer",1,7.2156840107658E-6],["other","TRANSID=2130000005815656070 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000143 ",1,7.2156840107658E-6],["problem with violation","Restricted card 62 RESTRICTED CARD",1,7.2156840107658E-6],["other","TRANSID=2130000005830788537 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003979966204 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005826852905 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005823836335 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000143 ",1,7.2156840107658E-6],["other","TRANSID=2130000005812399751 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["incorrect data","Invalid account number",1,7.2156840107658E-6],["other","SCA required 65 CARDHOLDER AUTHENTICATION REQUIRED",1,7.2156840107658E-6],["other","TRANSID=1120000003942793331 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005815761069 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000143 ",1,7.2156840107658E-6],["other","TRANSID=2130000005809543095 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005809573337 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005814603043 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003978005133 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005834380178 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1007009523 ",1,7.2156840107658E-6],["transaction error","[ERROR_PROCESSING_CARD - [79]] Lifecycle related. (MC) ,Transaction reversed. (Visa)",1,7.2156840107658E-6],["other","TRANSID=1120000003980732869 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005809298014 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["system error","Bank's malfunction",1,7.2156840107658E-6],["other","TRANSID=1120000003956465870 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003964722264 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["incorrect data","[1084.0.0] UserDetails: The date of birth is invalid. ",1,7.2156840107658E-6],["other","TRANSID=1120000003978989541 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["incorrect data","Payer email is of incorrect format or invalid",1,7.2156840107658E-6],["system error","Cardholder Account Number is not in a range belonging to Issuer acctNumber",1,7.2156840107658E-6],["other","TRANSID=1120000003978895837 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005816661507 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005812504979 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","[19] Re-enter",1,7.2156840107658E-6],["other","[54] Expired Card",1,7.2156840107658E-6],["system error","[ERROR_PROCESSING_CARD - [04]] [Pick Up Card, no fraud] The request attempted a card operation, but the card issuer wants the card returned. The request was rejected. Corrective action: Advise the cardholder to contact the card issuer to resolve the probl",1,7.2156840107658E-6],["other","TRANSID=2130000005811675661 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005809511565 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["merchant error","[03] Invalid Merchant",1,7.2156840107658E-6],["other","TRANSID=1120000003977993771 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005811930503 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005811967123 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005831686052 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005809430633 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005826895639 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003978962978 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005833142645 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["system error","[ERROR_PROCESSING_CARD - [70]] PIN Required or Contact Issuer",1,7.2156840107658E-6],["system error","Endpoint: https://valitorpay.com/Payment/CardPayment; cUrl Error #28 - Connection timed out after 30000 milliseconds Request to PSP Timeout; Details: Request to PSP Timeout",1,7.2156840107658E-6],["other","TRANSID=1120000003956010002 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005809659313 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["Acquirer fraud monitoring","Lost card Pick-up card, lost card (fraud account)",1,7.2156840107658E-6],["other","TRANSID=1120000003932674835 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001102 ",1,7.2156840107658E-6],["other","TRANSID=2130000005809652012 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005834158338 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","[180099] [E0300] Error mpi V2 - failed internal",1,7.2156840107658E-6],["other","Additional customer authentication required",1,7.2156840107658E-6],["error with 3D","[ERROR_PROCESSING_CARD - [65]] [Authentication Required or Activity Limit Exceeded] The request attempted a card operation, but 3DS was not completed or the transaction would exceed the card’s activity limit. The request was rejected. Corrective action: R",1,7.2156840107658E-6],["other","TRANSID=1120000003978769904 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003957850453 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1007009523 ",1,7.2156840107658E-6],["other","TRANSID=1120000003962172296 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["incorrect data","Invalid expiration date",1,7.2156840107658E-6],["other","TRANSID=2130000005831235133 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003957951963 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1007009523 ",1,7.2156840107658E-6],["other","TRANSID=1120000003928321151 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005827435959 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000143 ",1,7.2156840107658E-6],["Acquirer fraud monitoring","Transaction declined Pick-up card (no fraud)",1,7.2156840107658E-6],["other","TRANSID=1120000003965041727 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000143 ",1,7.2156840107658E-6],["other","TRANSID=2130000005809444677 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005830781521 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003953071317 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=1120000003979388003 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005825698901 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005809631362 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=1120000003963289978 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["card permission","[58] Transaction not Permitted to Acquirer or Terminal",1,7.2156840107658E-6],["other","TRANSID=1120000003978862398 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005815965268 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000143 ",1,7.2156840107658E-6],["Acquirer fraud monitoring","Transaction declined Security violation",1,7.2156840107658E-6],["other","TRANSID=2130000005828500698 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005809404043 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=1120000003978795877 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["transaction error","Invalid transaction",1,7.2156840107658E-6],["other","TRANSID=2130000005809272425 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=1120000003977980195 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005830320953 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005816223375 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000143 ",1,7.2156840107658E-6],["other","No security model",1,7.2156840107658E-6],["other","TRANSID=1120000003963917506 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=1120000003964981512 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000145 ",1,7.2156840107658E-6],["merchant error","Merchant should retain card (card reported stolen)",1,7.2156840107658E-6],["other","TRANSID=2130000005833216797 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003981575947 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","The server encountered an unexpected condition.",1,7.2156840107658E-6],["other","TRANSID=1120000003963277304 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","[82] Negative CAM, dCVV, iCVV, or CVV results",1,7.2156840107658E-6],["other","TRANSID=2130000005831672744 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003962594811 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["error with 3D","Fail to authenticate 3ds challenge. 12",1,7.2156840107658E-6],["other","TRANSID=2130000005827746258 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","[65] Authentication Required or Activity Limit Exceeded",1,7.2156840107658E-6],["other","TRANSID=1120000003955475464 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005812277237 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005812322073 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005823593608 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000143 ",1,7.2156840107658E-6],["other","TRANSID=1120000003965105636 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000143 ",1,7.2156840107658E-6],["other","[0.1.0] Verification data failed.",1,7.2156840107658E-6],["other","TRANSID=1120000003971967547 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005809341383 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=1120000003977185113 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005827347359 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["transaction error","Transaction declined Re-enter transaction",1,7.2156840107658E-6],["system error","[ERROR_PROCESSING_CARD - [96]] [System Malfunction] The request attempted a card operation, but the issuing bank was temporarily unavailable. The request was rejected. Corrective action: Try again. If the error persists, advise the customer to use a diffe",1,7.2156840107658E-6],["other","Issuer or switch inoperative",1,7.2156840107658E-6],["other","TRANSID=1120000003944064668 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["system error","[ERROR_PROCESSING_CARD - [41]] [Lost Card, pick up] The request attempted a card operation, but the card issuer wants the card returned because the cardholder reported it lost. The request was rejected. Corrective action: Advise the cardholder to contact ",1,7.2156840107658E-6],["other","TRANSID=1120000003978998893 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005812094077 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005813402264 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=1120000003981028342 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005831248517 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005831487508 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003944417366 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003978738613 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","[ERROR_GET_USER] The request attempted an operation that requires a wallet, but the wallet was not found. The request was rejected. Corrective action: Use the ID of a valid wallet that has not been deleted. The ID is a string starting with 'ewallet_'.",1,7.2156840107658E-6],["incorrect data","[0.1.0] Invalid 'To' account specified.",1,7.2156840107658E-6],["error with 3D","Fail to authenticate 3ds challenge. 84",1,7.2156840107658E-6],["other","TRANSID=2130000005831208382 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003944463839 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","[0.1.0] Stop Payment Order.",1,7.2156840107658E-6],["error with 3D","3D-Secure Challenge failed Invalid transaction",1,7.2156840107658E-6],["other","[78] Blocked, first used",1,7.2156840107658E-6],["problem with violation","[ERROR_PROCESSING_CARD - [62]] [Restricted Card] The request attempted a card operation, but the card is not authorized for use in the country of the merchant. The request was rejected. Corrective action: Advise the cardholder to use a different payment m",1,7.2156840107658E-6],["other","TRANSID=1120000003944050748 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["problem with violation","The issuer's country is not on the trust list.",1,7.2156840107658E-6],["other","TRANSID=1120000003978842172 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005816275077 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000143 ",1,7.2156840107658E-6],["other","TRANSID=1120000003974991462 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=2000000288 ",1,7.2156840107658E-6],["other","TRANSID=2130000005823628823 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["merchant error","[ERROR_GET_PAYMENT_METHOD_TYPE] The request attempted an operation that requires a payment method, but the payment method type specified is not available for this merchant or does not exist at all. Corrective action: Use a payment method type that this me",1,7.2156840107658E-6],["system error","[ERROR_PROCESSING_CARD - [91]] [Authorization Platform or Issuer System Inoperative] The request attempted a card operation, but the issuing bank was not available. The request was rejected. Corrective action: Try again. If the error persists, advise the ",1,7.2156840107658E-6],["other","TRANSID=1120000003977973022 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003956435990 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005831665481 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003978848946 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","Endpoint: ISONAC (DPP1); Reason: No more data to read Endpoint: ISONAC (DPP1); Reason: No more data to read",1,7.2156840107658E-6],["other","TRANSID=1120000003978923617 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003953113522 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=1120000003955996123 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005815745060 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000143 ",1,7.2156840107658E-6],["other","TRANSID=2130000005828536951 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005833145756 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003977245015 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["other","TRANSID=2130000005824384195 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001102 ",1,7.2156840107658E-6],["other","Issuer or Switch is Inoperative",1,7.2156840107658E-6],["other","Max payment amount is 10000 EUR",1,7.2156840107658E-6],["other","TRANSID=1120000003979883900 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005831514084 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003978982846 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005830346557 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=2130000005830769042 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["other","TRANSID=1120000003957892116 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1007009523 ",1,7.2156840107658E-6],["other","TRANSID=1120000003954906869 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1000000176 ",1,7.2156840107658E-6],["transaction error","Re-enter Transaction or Transaction has been expired",1,7.2156840107658E-6],["other","User blacklisted",1,7.2156840107658E-6],["other","TRANSID=1120000003979152955 TRANSREC=D TRANSSCORE=0TRANSREASONAMOUNT=1 TRANSREASON1=1507001822 ",1,7.2156840107658E-6],["incorrect data","invalid creditcard, bank account number or bank name",1,7.2156840107658E-6],["Acquirer fraud monitoring","[180090] [E0209] Transaction rejected, sender name contains fraudulent phrase.",1,7.2156840107658E-6],["Acquirer fraud monitoring","Transaction declined Transaction cannot be completed; violation of law.",1,7.2156840107658E-6]],"cols":[{"display_name":"GROUP_ERROR","source":"native","field_ref":["field","GROUP_ERROR",{"base-type":"type/Text"}],"name":"GROUP_ERROR","base_type":"type/Text","database_type":"VARCHAR","effective_type":"type/Text"},{"display_name":"ERROR_NAME","source":"native","field_ref":["field","ERROR_NAME",{"base-type":"type/Text"}],"name":"ERROR_NAME","base_type":"type/Text","database_type":"VARCHAR","effective_type":"type/Text"},{"display_name":"error_count","source":"native","field_ref":["field","error_count",{"base-type":"type/BigInteger"}],"name":"error_count","base_type":"type/BigInteger","database_type":"BIGINT","effective_type":"type/BigInteger"},{"display_name":"error_share","source":"native","field_ref":["field","error_share",{"base-type":"type/Float"}],"name":"error_share","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"}],"native_form":{"params":["2025-06-09T00:00:00Z","2025-06-24T00:00:00Z"],"query":"with filtered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        STATUS_NAME = 'error' and\n        `MART__FATPAY`.`CREATED_AT` >= ? AND `MART__FATPAY`.`CREATED_AT` < ?\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and day(CREATED_AT) <= 31\n),\n\ncount_errors as (\n    select \n        GROUP_ERROR,\n        ERROR_NAME,\n        count(distinct ORDER_ID) as n_error\n    from filtered_fatpay\n    group by 1, 2\n),\n\ncount_groups as (\n    select \n        GROUP_ERROR,\n        count(distinct ORDER_ID) as n_group\n    from filtered_fatpay\n    group by 1\n),\n\ncount_total as (\n    select \n        count(distinct ORDER_ID) as n_total\n    from filtered_fatpay\n)\n\n\nselect \n    'Total Errors' as GROUP_ERROR,\n    null as ERROR_NAME,\n    count_total.n_total as error_count,\n    1 as error_share\nfrom count_total\n\nunion all\n\nselect \n    count_errors.GROUP_ERROR,\n    count_errors.ERROR_NAME,\n    count_errors.n_error as error_count,\n    count_errors.n_error / count_total.n_total as error_share\nfrom count_errors\nleft join count_groups\n    on count_groups.GROUP_ERROR = count_errors.GROUP_ERROR\nleft join count_total\n    on 1 = 1\norder by 4 DESC"},"results_timezone":"Etc/UTC","format-rows?":true,"results_metadata":{"columns":[{"display_name":"GROUP_ERROR","field_ref":["field","GROUP_ERROR",{"base-type":"type/Text"}],"base_type":"type/Text","effective_type":"type/Text","name":"GROUP_ERROR","semantic_type":null,"fingerprint":{"global":{"distinct-count":15,"nil%":0.0},"type":{"type/Text":{"percent-json":0.0,"percent-url":0.0,"percent-email":0.0,"percent-state":0.0,"average-length":10.422033898305084}}}},{"display_name":"ERROR_NAME","field_ref":["field","ERROR_NAME",{"base-type":"type/Text"}],"base_type":"type/Text","effective_type":"type/Text","name":"ERROR_NAME","semantic_type":null,"fingerprint":{"global":{"distinct-count":590,"nil%":0.001694915254237288},"type":{"type/Text":{"percent-json":0.1576271186440678,"percent-url":0.0,"percent-email":0.0,"percent-state":0.0,"average-length":60.827118644067795}}}},{"display_name":"error_count","field_ref":["field","error_count",{"base-type":"type/BigInteger"}],"base_type":"type/BigInteger","effective_type":"type/BigInteger","name":"error_count","semantic_type":"type/Quantity","fingerprint":{"global":{"distinct-count":190,"nil%":0.0},"type":{"type/Number":{"min":1.0,"q1":5.193230535777782,"q3":59.84914402258886,"max":138587.0,"sd":5764.951664064383,"avg":469.7864406779661}}}},{"display_name":"error_share","field_ref":["field","error_share",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"error_share","semantic_type":"type/Share","fingerprint":{"global":{"distinct-count":190,"nil%":0.0},"type":{"type/Number":{"min":7.2156840107658E-6,"q1":3.787123890567661E-5,"q3":4.32213026104418E-4,"max":1.0,"sd":0.04159806874240354,"avg":0.003389830508474576}}}}]},"insights":null},"cached":null,"database_id":16,"started_at":"2025-06-23T08:45:39.080651003Z","json_query":{"type":"native","database":16,"native":{"query":"with filtered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        STATUS_NAME = 'error' and\n        {{CREATED_AT}}\n        and {{CARD_GEOSCHEME}}\n        and {{CARD_COUNTRY}}\n        and {{STATUS}}\n        and {{BUSINESS_NAME}}\n        and {{USER_NAME}}\n        and {{FIAT_CURRENCY}}\n        and {{ACQUIRER}}\n        and {{CARD_BRAND}}\n        and {{PAYMENT_TERMINAL}}\n        and {{ERROR_GROUP}}\n        and {{ERROR_NAME}}\n        and {{HAS_ID_PROVIDER}}\n        and {{SHOP}}\n        and {{is_aft}}\n        and day(CREATED_AT) <= {{day_number}}\n),\n\ncount_errors as (\n    select \n        GROUP_ERROR,\n        ERROR_NAME,\n        count(distinct ORDER_ID) as n_error\n    from filtered_fatpay\n    group by 1, 2\n),\n\ncount_groups as (\n    select \n        GROUP_ERROR,\n        count(distinct ORDER_ID) as n_group\n    from filtered_fatpay\n    group by 1\n),\n\ncount_total as (\n    select \n        count(distinct ORDER_ID) as n_total\n    from filtered_fatpay\n)\n\n\nselect \n    'Total Errors' as GROUP_ERROR,\n    null as ERROR_NAME,\n    count_total.n_total as error_count,\n    1 as error_share\nfrom count_total\n\nunion all\n\nselect \n    count_errors.GROUP_ERROR,\n    count_errors.ERROR_NAME,\n    count_errors.n_error as error_count,\n    count_errors.n_error / count_total.n_total as error_share\nfrom count_errors\nleft join count_groups\n    on count_groups.GROUP_ERROR = count_errors.GROUP_ERROR\nleft join count_total\n    on 1 = 1\norder by 4 DESC","template-tags":{"HAS_ID_PROVIDER":{"id":"3e8dfde4-48f1-225a-999c-0d3ce8f5fb7e","name":"HAS_ID_PROVIDER","display-name":"Has id provider","type":"dimension","dimension":["field",756250,null],"widget-type":"string/=","default":null},"CARD_COUNTRY":{"id":"716a10f7-f987-2208-4429-4b0598b2432e","name":"CARD_COUNTRY","display-name":"Card country","type":"dimension","dimension":["field",756254,null],"widget-type":"string/=","required":false},"ERROR_GROUP":{"id":"2287bcf2-879d-a509-ecef-f2f375ebe882","name":"ERROR_GROUP","display-name":"Error group","type":"dimension","dimension":["field",756269,null],"widget-type":"string/=","default":null},"FIAT_CURRENCY":{"id":"e734ceda-ef86-ce9c-358a-69566a4c0214","name":"FIAT_CURRENCY","display-name":"Fiat currency","type":"dimension","dimension":["field",756268,null],"widget-type":"string/=","default":null},"is_aft":{"type":"dimension","name":"is_aft","id":"e79408f3-c85c-4205-bdce-de6df6ac8b96","display-name":"Is Aft","default":null,"dimension":["field",760549,null],"widget-type":"string/=","options":null},"ERROR_NAME":{"id":"0f8f7ec3-37a6-f67c-8319-7d255e39e841","name":"ERROR_NAME","display-name":"Error name","type":"dimension","dimension":["field",756230,null],"widget-type":"string/contains","default":null},"PAYMENT_TERMINAL":{"id":"698f65a5-572d-3286-034e-151b59125736","name":"PAYMENT_TERMINAL","display-name":"Payment terminal","type":"dimension","dimension":["field",756239,null],"widget-type":"string/=","default":null},"SHOP":{"id":"2c4a3dbc-ff34-121f-b57d-c3973dd1015b","name":"SHOP","display-name":"Shop","type":"dimension","dimension":["field",756245,null],"widget-type":"string/="},"BUSINESS_NAME":{"id":"bd69ce89-a3be-5f0d-90ef-0ad9b70f116e","name":"BUSINESS_NAME","display-name":"Business name","type":"dimension","dimension":["field",756258,null],"widget-type":"string/=","default":null},"day_number":{"type":"number","name":"day_number","id":"ae602bde-7ecf-4c0f-8a4a-76220c13deea","display-name":"Month-to-Date Day Number","default":"31","required":true},"ACQUIRER":{"id":"bf51e367-ae6b-c409-020c-711538e8ce91","name":"ACQUIRER","display-name":"Acquirer","type":"dimension","dimension":["field",756224,null],"widget-type":"string/=","default":null},"CREATED_AT":{"id":"cf278b54-4f5f-9fbe-23f8-d1a9fdd227db","name":"CREATED_AT","display-name":"Created at","type":"dimension","dimension":["field",756256,null],"widget-type":"date/all-options","default":"past14days~","required":true},"CARD_GEOSCHEME":{"id":"cba17b07-3a17-4612-ce72-00eeddc3d21e","name":"CARD_GEOSCHEME","display-name":"Card geoscheme","type":"dimension","dimension":["field",756227,null],"widget-type":"string/=","required":false},"USER_NAME":{"id":"3e87e7a8-2e29-86a6-c39d-c0f3b183d924","name":"USER_NAME","display-name":"User name","type":"dimension","dimension":["field",756263,null],"widget-type":"string/contains","default":null},"STATUS":{"id":"ce1486eb-801e-0a23-1514-067b67d5aa73","name":"STATUS","display-name":"Status","type":"dimension","dimension":["field",756257,null],"widget-type":"string/=","default":null},"CARD_BRAND":{"id":"54185955-91b6-f816-51dc-f71b45b3fc83","name":"CARD_BRAND","display-name":"Card brand","type":"dimension","dimension":["field",756238,null],"widget-type":"string/=","default":null}}},"middleware":{"js-int-to-string?":true,"userland-query?":true,"add-default-userland-constraints?":true}},"average_execution_time":null,"status":"completed","context":"ad-hoc","row_count":590,"running_time":181}

📝 Validating Question 4/11
--------------------------------------------------
  🔍 Validating Question 4168: 2 Acceptance Rate split
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_granularity as (
    select distinct granularity
    from MD__FATPAY_DASHBOARD_HELP_TA...
    ❌ SQL Error detected in response
    📄 Response: {"data":{"rows":[["2025-06-23T00:00:00Z","BY",0.751937984496124],["2025-06-09T00:00:00Z","BY",0.7576813082056171],["2025-06-23T00:00:00Z","others",0.5910493827160493],["2025-06-16T00:00:00Z","Europe/ROW  Domus Payment Solutions LTD",0.6372040220564386],["2025-06-23T00:00:00Z","Bro Fintech LTD",0.6666666666666666],["2025-06-09T00:00:00Z","KURTLEY QURESHI CONSULTANTS LIMITED",0.6125459658230586],["2025-06-16T00:00:00Z","Whitebit",0.5116653258246179],["2025-06-16T00:00:00Z","Ecom Center LTD",0.6721510218219605],["2025-06-16T00:00:00Z","Pionex",0.5651144435674822],["2025-06-09T00:00:00Z","Bingx",0.49666014050443397],["2025-06-09T00:00:00Z","ADV Project Ltd",0.5642011379363371],["2025-06-23T00:00:00Z","Pionex",0.45977011494252873],["2025-06-16T00:00:00Z","Midway International N.V.",0.8150088604669081],["2025-06-16T00:00:00Z","Aifory LLC",0.39226365808925695],["2025-06-23T00:00:00Z","Golden Way Payments LTD",0.5562913907284768],["2025-06-09T00:00:00Z","Bro Fintech LTD",0.6055187297672268],["2025-06-09T00:00:00Z","Payinter LTD",0.5968526466380544],["2025-06-16T00:00:00Z","Bingx",0.5181511976047904],["2025-06-16T00:00:00Z","Finaster Transfer LTD",0.8287854007058622],["2025-06-09T00:00:00Z","others",0.5899694723070213],["2025-06-09T00:00:00Z","Europe/ROW  Domus Payment Solutions LTD",0.6027566707898923],["2025-06-16T00:00:00Z","Golden Way Payments LTD",0.5263335015985192],["2025-06-16T00:00:00Z","Bro Fintech LTD",0.5136796193497224],["2025-06-23T00:00:00Z","Exidna Enterprises LTD",0.7123552123552124],["2025-06-23T00:00:00Z","Finaster Transfer LTD",0.9153846153846154],["2025-06-23T00:00:00Z","Phemex",0.38461538461538464],["2025-06-09T00:00:00Z","Finaster Transfer LTD",0.7663378545006165],["2025-06-16T00:00:00Z","KURTLEY QURESHI CONSULTANTS LIMITED",0.587154861944778],["2025-06-16T00:00:00Z","Venson Ltd",0.5556714860634968],["2025-06-23T00:00:00Z","Payinter LTD",0.38181818181818183],["2025-06-23T00:00:00Z","Aifory LLC",0.5849056603773585],["2025-06-09T00:00:00Z","Aifory LLC",0.6039619283448115],["2025-06-16T00:00:00Z","Exidna Enterprises LTD",0.6466647662485747],["2025-06-09T00:00:00Z","Golden Way Payments LTD",0.5119420516836335],["2025-06-16T00:00:00Z","Payinter LTD",0.512086827824371],["2025-06-23T00:00:00Z","Midway International N.V.",0.8338368580060423],["2025-06-23T00:00:00Z","Bingx",0.5134649910233393],["2025-06-16T00:00:00Z","Darius Tech inc.",0.6018775618140949],["2025-06-16T00:00:00Z","Phemex",0.5067466266866567],["2025-06-09T00:00:00Z","Whitebit",0.4982468443197756],["2025-06-16T00:00:00Z","others",0.5788071629421341],["2025-06-09T00:00:00Z","Exidna Enterprises LTD",0.6987771865957249],["2025-06-09T00:00:00Z","Phemex",0.4933008526187576],["2025-06-09T00:00:00Z","Pionex",0.5105240549828178],["2025-06-09T00:00:00Z","Midway International N.V.",0.8151746286631875],["2025-06-23T00:00:00Z","Venson Ltd",0.6751592356687898],["2025-06-23T00:00:00Z","Europe/ROW  Domus Payment Solutions LTD",0.7193460490463215],["2025-06-23T00:00:00Z","Darius Tech inc.",0.5174825174825175],["2025-06-23T00:00:00Z","ADV Project Ltd",0.5683060109289617],["2025-06-09T00:00:00Z","Darius Tech inc.",0.5296447291788002],["2025-06-16T00:00:00Z","BY",0.77220838136318],["2025-06-09T00:00:00Z","Ecom Center LTD",0.6682885906040269],["2025-06-16T00:00:00Z","Mobilum tech",0.8408266679914551],["2025-06-23T00:00:00Z","Mobilum tech",0.9],["2025-06-23T00:00:00Z","KURTLEY QURESHI CONSULTANTS LIMITED",0.5589041095890411],["2025-06-23T00:00:00Z","Whitebit",0.6666666666666666],["2025-06-16T00:00:00Z","ADV Project Ltd",0.5574638844301766],["2025-06-23T00:00:00Z","Ecom Center LTD",0.628099173553719],["2025-06-09T00:00:00Z","Venson Ltd",0.712701544322743],["2025-06-09T00:00:00Z","Mobilum tech",0.8439352828861421]],"cols":[{"display_name":"CREATED_AT","source":"native","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"name":"CREATED_AT","base_type":"type/DateTime","database_type":"DATETIME","effective_type":"type/DateTime"},{"display_name":"grouping_top_n","source":"native","field_ref":["field","grouping_top_n",{"base-type":"type/Text"}],"name":"grouping_top_n","base_type":"type/Text","database_type":"TEXT","effective_type":"type/Text"},{"display_name":"RATE","source":"native","field_ref":["field","RATE",{"base-type":"type/Float"}],"name":"RATE","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"}],"native_form":{"params":["week","Merchant","2025-06-09T00:00:00Z","2025-06-24T00:00:00Z","week"],"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where ?\n          AND granularity is not null\n),\n\nfiltered_groupby as (\n    select distinct fatpay_columns_groupby\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where (`MD__FATPAY_DASHBOARD_HELP_TABLE`.`FATPAY_COLUMNS_GROUPBY` = ?)\n          AND fatpay_columns_groupby is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        `MART__FATPAY`.`CREATED_AT` >= ? AND `MART__FATPAY`.`CREATED_AT` < ?\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and day(CREATED_AT) <= 31\n), \n\npre_top_n as (\n    select \n        CASE \n            WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n                THEN MART__FATPAY.CURRENCY\n            WHEN groupby.fatpay_columns_groupby = 'Status'\n                THEN MART__FATPAY.STATUS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'User Name'\n                THEN MART__FATPAY.USER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Merchant'\n                THEN MART__FATPAY.BUSINESS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Shop'\n                THEN MART__FATPAY.SHOP_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n                THEN MART__FATPAY.DRIVER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n                THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n                THEN MART__FATPAY.CARD_BANK\n            WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n                THEN MART__FATPAY.CARD_BRAND\n            WHEN groupby.fatpay_columns_groupby = 'Card Type'\n                THEN MART__FATPAY.CARD_TYPE\n            WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n                THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n            WHEN groupby.fatpay_columns_groupby = 'Card Country'\n                THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n            WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n                THEN MART__FATPAY.ANTIFRAUD_STATUS\n            WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n                THEN MART__FATPAY.IS_AFT\n            ELSE null \n        END as grouped,\n        row_number() over (order by sum(MART__FATPAY.AMOUNT_EUR) desc) as rn\n    from filtered_fatpay as MART__FATPAY\n    left join filtered_groupby as groupby\n        on 1 = 1\n    group by 1 \n),\n\ntop_n as (\n    select \n        grouped,\n        CASE \n            WHEN rn < 20 \n                THEN grouped\n        ELSE 'others' END AS grouping_top_n\n    from pre_top_n\n)\n\nselect \n    date_trunc(?, MART__FATPAY.CREATED_AT) as CREATED_AT,\n    top_n.grouping_top_n,\n    count(distinct case when STATUS_NAME = 'complete' then ORDER_ID end) /\n        count(distinct ORDER_ID)\n        as RATE\nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\nleft join filtered_groupby as groupby\n    on 1 = 1\nleft join top_n\n    on top_n.grouped = CASE \n        WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n            THEN MART__FATPAY.CURRENCY\n        WHEN groupby.fatpay_columns_groupby = 'Status'\n            THEN MART__FATPAY.STATUS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'User Name'\n            THEN MART__FATPAY.USER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Merchant'\n            THEN MART__FATPAY.BUSINESS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Shop'\n            THEN MART__FATPAY.SHOP_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n            THEN MART__FATPAY.DRIVER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n            THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n            THEN MART__FATPAY.CARD_BANK\n        WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n            THEN MART__FATPAY.CARD_BRAND\n        WHEN groupby.fatpay_columns_groupby = 'Card Type'\n            THEN MART__FATPAY.CARD_TYPE\n        WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n            THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n        WHEN groupby.fatpay_columns_groupby = 'Card Country'\n            THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n        WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n            THEN MART__FATPAY.ANTIFRAUD_STATUS\n        WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n            THEN MART__FATPAY.IS_AFT\n        ELSE null \n    END\ngroup by 1, 2"},"results_timezone":"Etc/UTC","format-rows?":true,"results_metadata":{"columns":[{"display_name":"CREATED_AT","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"base_type":"type/DateTime","effective_type":"type/DateTime","name":"CREATED_AT","semantic_type":"type/CreationTimestamp","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/DateTime":{"earliest":"2025-06-09T00:00:00Z","latest":"2025-06-23T00:00:00Z"}}}},{"display_name":"grouping_top_n","field_ref":["field","grouping_top_n",{"base-type":"type/Text"}],"base_type":"type/Text","effective_type":"type/Text","name":"grouping_top_n","semantic_type":null,"fingerprint":{"global":{"distinct-count":20,"nil%":0.0},"type":{"type/Text":{"percent-json":0.0,"percent-url":0.0,"percent-email":0.0,"percent-state":0.0,"average-length":15.15}}}},{"display_name":"RATE","field_ref":["field","RATE",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"RATE","semantic_type":"type/Share","fingerprint":{"global":{"distinct-count":59,"nil%":0.0},"type":{"type/Number":{"min":0.38181818181818183,"q1":0.5178168575436539,"q3":0.7055661994754686,"max":0.9153846153846154,"sd":0.126614703414656,"avg":0.6200824517522192}}}}]},"insights":[{"previous-value":null,"unit":null,"offset":-7.123012359462432,"last-change":null,"col":"RATE","slope":3.8228066211871894E-4,"last-value":0.8439352828861421,"best-fit":["*",698.2268828828495,["exp",["*",-3.4789900650385966E-4,"x"]]]}]},"cached":null,"database_id":16,"started_at":"2025-06-23T08:45:40.459400248Z","json_query":{"type":"native","database":16,"native":{"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{granularity}}\n          AND granularity is not null\n),\n\nfiltered_groupby as (\n    select distinct fatpay_columns_groupby\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{groupby}}\n          AND fatpay_columns_groupby is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        {{CREATED_AT}}\n        and {{CARD_GEOSCHEME}}\n        and {{CARD_COUNTRY}}\n        and {{STATUS}}\n        and {{BUSINESS_NAME}}\n        and {{USER_NAME}}\n        and {{FIAT_CURRENCY}}\n        and {{ACQUIRER}}\n        and {{CARD_BRAND}}\n        and {{PAYMENT_TERMINAL}}\n        and {{ERROR_GROUP}}\n        and {{ERROR_NAME}}\n        and {{HAS_ID_PROVIDER}}\n        and {{SHOP}}\n        and {{is_aft}}\n        and day(CREATED_AT) <= {{day_number}}\n), \n\npre_top_n as (\n    select \n        CASE \n            WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n                THEN MART__FATPAY.CURRENCY\n            WHEN groupby.fatpay_columns_groupby = 'Status'\n                THEN MART__FATPAY.STATUS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'User Name'\n                THEN MART__FATPAY.USER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Merchant'\n                THEN MART__FATPAY.BUSINESS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Shop'\n                THEN MART__FATPAY.SHOP_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n                THEN MART__FATPAY.DRIVER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n                THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n                THEN MART__FATPAY.CARD_BANK\n            WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n                THEN MART__FATPAY.CARD_BRAND\n            WHEN groupby.fatpay_columns_groupby = 'Card Type'\n                THEN MART__FATPAY.CARD_TYPE\n            WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n                THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n            WHEN groupby.fatpay_columns_groupby = 'Card Country'\n                THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n            WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n                THEN MART__FATPAY.ANTIFRAUD_STATUS\n            WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n                THEN MART__FATPAY.IS_AFT\n            ELSE null \n        END as grouped,\n        row_number() over (order by sum(MART__FATPAY.AMOUNT_EUR) desc) as rn\n    from filtered_fatpay as MART__FATPAY\n    left join filtered_groupby as groupby\n        on 1 = 1\n    group by 1 \n),\n\ntop_n as (\n    select \n        grouped,\n        CASE \n            WHEN rn < {{top_n}} \n                THEN grouped\n        ELSE 'others' END AS grouping_top_n\n    from pre_top_n\n)\n\nselect \n    date_trunc({{granularity}}, MART__FATPAY.CREATED_AT) as CREATED_AT,\n    top_n.grouping_top_n,\n    count(distinct case when STATUS_NAME = 'complete' then ORDER_ID end) /\n        count(distinct ORDER_ID)\n        as RATE\nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\nleft join filtered_groupby as groupby\n    on 1 = 1\nleft join top_n\n    on top_n.grouped = CASE \n        WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n            THEN MART__FATPAY.CURRENCY\n        WHEN groupby.fatpay_columns_groupby = 'Status'\n            THEN MART__FATPAY.STATUS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'User Name'\n            THEN MART__FATPAY.USER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Merchant'\n            THEN MART__FATPAY.BUSINESS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Shop'\n            THEN MART__FATPAY.SHOP_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n            THEN MART__FATPAY.DRIVER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n            THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n            THEN MART__FATPAY.CARD_BANK\n        WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n            THEN MART__FATPAY.CARD_BRAND\n        WHEN groupby.fatpay_columns_groupby = 'Card Type'\n            THEN MART__FATPAY.CARD_TYPE\n        WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n            THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n        WHEN groupby.fatpay_columns_groupby = 'Card Country'\n            THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n        WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n            THEN MART__FATPAY.ANTIFRAUD_STATUS\n        WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n            THEN MART__FATPAY.IS_AFT\n        ELSE null \n    END\ngroup by 1, 2\n","template-tags":{"HAS_ID_PROVIDER":{"id":"7f56e3e2-f77f-ef87-7e1b-bd81ce557a4b","name":"HAS_ID_PROVIDER","display-name":"Has id provider","type":"dimension","dimension":["field",756250,null],"widget-type":"string/=","default":null},"top_n":{"type":"number","name":"top_n","id":"9431e41b-b3bb-40e0-a46a-d4a37d4d4172","display-name":"Top N","default":"20","required":true},"CARD_COUNTRY":{"id":"29492df1-225c-ccb0-9a4e-272c5f987ac5","name":"CARD_COUNTRY","display-name":"Card country","type":"dimension","dimension":["field",756254,null],"widget-type":"string/=","default":null},"ERROR_GROUP":{"id":"bb7f9117-7da8-bc24-8190-7626f33e6af0","name":"ERROR_GROUP","display-name":"Error group","type":"dimension","dimension":["field",756269,null],"widget-type":"string/=","default":null},"FIAT_CURRENCY":{"id":"5cab7ad0-e021-f0c5-4e22-a66c43242330","name":"FIAT_CURRENCY","display-name":"Fiat currency","type":"dimension","dimension":["field",756268,null],"widget-type":"string/=","default":null},"is_aft":{"type":"dimension","name":"is_aft","id":"996b1fa1-8778-4c95-ad7a-f2fbcb62d9ef","display-name":"Is Aft","default":null,"dimension":["field",760549,null],"widget-type":"string/=","options":null},"ERROR_NAME":{"id":"4ed8b652-3c97-6a86-8a35-7a397b6f42ea","name":"ERROR_NAME","display-name":"Error name","type":"dimension","dimension":["field",756230,null],"widget-type":"string/contains","default":null},"PAYMENT_TERMINAL":{"id":"cd9daa34-226e-58e4-673d-7fd1179e7dee","name":"PAYMENT_TERMINAL","display-name":"Payment terminal","type":"dimension","dimension":["field",756239,null],"widget-type":"string/=","default":null},"SHOP":{"id":"d5a0dd1a-95c4-a436-6427-79f2ec99d397","name":"SHOP","display-name":"Shop","type":"dimension","dimension":["field",756245,null],"widget-type":"string/="},"BUSINESS_NAME":{"id":"1a7ca3c6-ac96-dcc3-dbdc-20e1d3c55320","name":"BUSINESS_NAME","display-name":"Business name","type":"dimension","dimension":["field",756258,null],"widget-type":"string/=","default":null},"day_number":{"type":"number","name":"day_number","id":"c09ae91d-f046-4f60-8543-1e49140d2ee3","display-name":"Month-to-Date Day Number","default":"31","required":true},"granularity":{"id":"37799d21-54a5-2233-9de5-517db3c5bab0","name":"granularity","display-name":"Granularity","type":"text","required":true,"default":"week","values-source-type":"static-list","values-source-config":{"values":[["hour"],["day"],["week"],["month"],["quarter"],["year"]]}},"ACQUIRER":{"id":"0add554f-79fc-6685-f405-66c92af72b79","name":"ACQUIRER","display-name":"Acquirer","type":"dimension","dimension":["field",756224,null],"widget-type":"string/=","default":null},"groupby":{"id":"e17dc612-04b6-9c56-db9b-df98419a776c","name":"groupby","display-name":"Groupby","type":"dimension","default":["Merchant"],"dimension":["field",756658,null],"widget-type":"string/=","required":true},"CREATED_AT":{"id":"7e66dcc1-f9af-d388-5804-ea74427d78fb","name":"CREATED_AT","display-name":"Created at","type":"dimension","dimension":["field",756256,null],"widget-type":"date/all-options","default":"past14days~","required":true},"CARD_GEOSCHEME":{"id":"0d642257-5a4e-bc22-1afa-998bdf910c28","name":"CARD_GEOSCHEME","display-name":"Card geoscheme","type":"dimension","dimension":["field",756227,null],"widget-type":"string/=","default":null},"USER_NAME":{"id":"0ed73475-19ec-3399-0857-ad2c1e797d73","name":"USER_NAME","display-name":"User name","type":"dimension","dimension":["field",756263,null],"widget-type":"string/contains","default":null},"STATUS":{"id":"f05b9ffc-bfb1-f94b-4509-3fa683d56e44","name":"STATUS","display-name":"Status","type":"dimension","dimension":["field",756257,null],"widget-type":"string/=","default":null},"CARD_BRAND":{"id":"45d19436-bb36-cae1-7b66-470806737fb6","name":"CARD_BRAND","display-name":"Card brand","type":"dimension","dimension":["field",756238,null],"widget-type":"string/=","default":null}}},"middleware":{"js-int-to-string?":true,"userland-query?":true,"add-default-userland-constraints?":true}},"average_execution_time":null,"status":"completed","context":"ad-hoc","row_count":60,"running_time":1031}

📝 Validating Question 5/11
--------------------------------------------------
  🔍 Validating Question 4169: 2 Failure Rate split
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_granularity as (
    select distinct granularity
    from MD__FATPAY_DASHBOARD_HELP_TA...
    ❌ SQL Error: Cannot run the query: missing required parameters: #{"top_n"}

📝 Validating Question 6/11
--------------------------------------------------
  🔍 Validating Question 4170: 2 Failure Rate
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_granularity as (
    select granularity
    from MD__FATPAY_DASHBOARD_HELP_TABLE
    w...
    ❌ SQL Error detected in response
    📄 Response: {"data":{"rows":[["2025-06-16T00:00:00Z",0.3170886354629915],["2025-06-23T00:00:00Z",0.26766417290108063],["2025-06-09T00:00:00Z",0.30847946968293993]],"cols":[{"display_name":"CREATED_AT","source":"native","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"name":"CREATED_AT","base_type":"type/DateTime","database_type":"DATETIME","effective_type":"type/DateTime"},{"display_name":"RATE_ERROR","source":"native","field_ref":["field","RATE_ERROR",{"base-type":"type/Float"}],"name":"RATE_ERROR","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"}],"native_form":{"params":["week","2025-06-09T00:00:00Z","2025-06-24T00:00:00Z","week"],"query":"with filtered_granularity as (\n    select granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where ?\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select \n        CREATED_AT,\n        STATUS_NAME,\n        AUTH_STATUS_NAME,\n        ORDER_ID\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        `MART__FATPAY`.`CREATED_AT` >= ? AND `MART__FATPAY`.`CREATED_AT` < ?\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and day(CREATED_AT) <= 31\n)\n\nselect \n    date_trunc(?, ff.CREATED_AT) as CREATED_AT,\n    count(distinct case when STATUS_NAME = 'error' then ORDER_ID end) /\n        count(distinct ORDER_ID)\n        as RATE_ERROR\nfrom filtered_fatpay as ff\nleft join filtered_granularity as fg\n    on 1 = 1\ngroup by 1"},"results_timezone":"Etc/UTC","format-rows?":true,"results_metadata":{"columns":[{"display_name":"CREATED_AT","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"base_type":"type/DateTime","effective_type":"type/DateTime","name":"CREATED_AT","semantic_type":"type/CreationTimestamp","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/DateTime":{"earliest":"2025-06-09T00:00:00Z","latest":"2025-06-23T00:00:00Z"}}}},{"display_name":"RATE_ERROR","field_ref":["field","RATE_ERROR",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"RATE_ERROR","semantic_type":null,"fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/Number":{"min":0.26766417290108063,"q1":0.27786799709654547,"q3":0.3149363440179786,"max":0.3170886354629915,"sd":0.026403231135454463,"avg":0.29774409268233737}}}}]},"insights":[{"previous-value":null,"unit":null,"offset":59.3487324010081,"last-change":null,"col":"RATE_ERROR","slope":-0.0029153783415613805,"last-value":0.30847946968293993,"best-fit":["+",59.3487324010081,["*",-0.0029153783415613805,"x"]]}]},"cached":null,"database_id":16,"started_at":"2025-06-23T08:45:43.943934693Z","json_query":{"type":"native","database":16,"native":{"query":"with filtered_granularity as (\n    select granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{granularity}}\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select \n        CREATED_AT,\n        STATUS_NAME,\n        AUTH_STATUS_NAME,\n        ORDER_ID\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        {{CREATED_AT}}\n        and {{CARD_GEOSCHEME}}\n        and {{CARD_COUNTRY}}\n        and {{STATUS}}\n        and {{BUSINESS_NAME}}\n        and {{USER_NAME}}\n        and {{FIAT_CURRENCY}}\n        and {{ACQUIRER}}\n        and {{CARD_BRAND}}\n        and {{PAYMENT_TERMINAL}}\n        and {{ERROR_GROUP}}\n        and {{ERROR_NAME}}\n        and {{HAS_ID_PROVIDER}}\n        and {{SHOP}}\n        and {{is_aft}}\n        and day(CREATED_AT) <= {{day_number}}\n)\n\nselect \n    date_trunc({{granularity}}, ff.CREATED_AT) as CREATED_AT,\n    count(distinct case when STATUS_NAME = 'error' then ORDER_ID end) /\n        count(distinct ORDER_ID)\n        as RATE_ERROR\nfrom filtered_fatpay as ff\nleft join filtered_granularity as fg\n    on 1 = 1\ngroup by 1 ","template-tags":{"HAS_ID_PROVIDER":{"id":"9643d8b0-d5d6-43f9-bf40-5942bb667f87","name":"HAS_ID_PROVIDER","display-name":"Has id provider","type":"dimension","dimension":["field",756250,null],"widget-type":"string/=","default":null},"CARD_COUNTRY":{"id":"716a10f7-f987-2208-4429-4b0598b2432e","name":"CARD_COUNTRY","display-name":"Card country","type":"dimension","dimension":["field",756254,null],"widget-type":"string/=","required":false},"ERROR_GROUP":{"id":"2287bcf2-879d-a509-ecef-f2f375ebe882","name":"ERROR_GROUP","display-name":"Error group","type":"dimension","dimension":["field",756269,null],"widget-type":"string/=","default":null},"FIAT_CURRENCY":{"id":"e734ceda-ef86-ce9c-358a-69566a4c0214","name":"FIAT_CURRENCY","display-name":"Fiat currency","type":"dimension","dimension":["field",756268,null],"widget-type":"string/=","default":null},"is_aft":{"type":"dimension","name":"is_aft","id":"61bceaf4-47e4-4663-ace7-34c95b28b093","display-name":"Is Aft","default":null,"dimension":["field",760549,null],"widget-type":"string/=","options":null},"ERROR_NAME":{"id":"0f8f7ec3-37a6-f67c-8319-7d255e39e841","name":"ERROR_NAME","display-name":"Error name","type":"dimension","dimension":["field",756230,null],"widget-type":"string/contains","default":null},"PAYMENT_TERMINAL":{"id":"698f65a5-572d-3286-034e-151b59125736","name":"PAYMENT_TERMINAL","display-name":"Payment terminal","type":"dimension","dimension":["field",756239,null],"widget-type":"string/=","default":null},"SHOP":{"id":"eb8dec32-8adf-b04b-a70c-16d1d00739af","name":"SHOP","display-name":"Shop","type":"dimension","dimension":["field",756245,null],"widget-type":"string/="},"BUSINESS_NAME":{"id":"bd69ce89-a3be-5f0d-90ef-0ad9b70f116e","name":"BUSINESS_NAME","display-name":"Business name","type":"dimension","dimension":["field",756258,null],"widget-type":"string/=","default":null},"day_number":{"type":"number","name":"day_number","id":"14c10eef-0e53-4aab-ab49-ad8671c65e2b","display-name":"Month-to-Date Day Number","default":"31","required":true},"granularity":{"id":"4b095973-b5cb-4c93-c12a-607019dd0fcd","name":"granularity","display-name":"Granularity","type":"text","required":true,"default":"week","values-source-type":"static-list","values-source-config":{"values":[["hour"],["day"],["week"],["month"],["quarter"],["year"]]}},"ACQUIRER":{"id":"bf51e367-ae6b-c409-020c-711538e8ce91","name":"ACQUIRER","display-name":"Acquirer","type":"dimension","dimension":["field",756224,null],"widget-type":"string/=","default":null},"CREATED_AT":{"id":"cf278b54-4f5f-9fbe-23f8-d1a9fdd227db","name":"CREATED_AT","display-name":"Created at","type":"dimension","dimension":["field",756256,null],"widget-type":"date/all-options","default":"past14days~","required":true},"CARD_GEOSCHEME":{"id":"cba17b07-3a17-4612-ce72-00eeddc3d21e","name":"CARD_GEOSCHEME","display-name":"Card geoscheme","type":"dimension","dimension":["field",756227,null],"widget-type":"string/=","required":false},"USER_NAME":{"id":"3e87e7a8-2e29-86a6-c39d-c0f3b183d924","name":"USER_NAME","display-name":"User name","type":"dimension","dimension":["field",756263,null],"widget-type":"string/contains","default":null},"STATUS":{"id":"ce1486eb-801e-0a23-1514-067b67d5aa73","name":"STATUS","display-name":"Status","type":"dimension","dimension":["field",756257,null],"widget-type":"string/=","default":null},"CARD_BRAND":{"id":"54185955-91b6-f816-51dc-f71b45b3fc83","name":"CARD_BRAND","display-name":"Card brand","type":"dimension","dimension":["field",756238,null],"widget-type":"string/=","default":null}}},"middleware":{"js-int-to-string?":true,"userland-query?":true,"add-default-userland-constraints?":true}},"average_execution_time":null,"status":"completed","context":"ad-hoc","row_count":3,"running_time":82}

📝 Validating Question 7/11
--------------------------------------------------
  🔍 Validating Question 4162: 2 Number of Failed Transactions split by Error Names
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_granularity as (
    select distinct granularity
    from MD__FATPAY_DASHBOARD_HELP_TA...
    ❌ SQL Error detected in response
    📄 Response: {"data":{"rows":[["2025-06-16T00:00:00Z","Client verification unsuccessful",1920],["2025-06-09T00:00:00Z","[0.1.0] Do not honor.",841],["2025-06-09T00:00:00Z","[N] Authentication failed",544],["2025-06-16T00:00:00Z","Declined by Risk Check",64],["2025-06-23T00:00:00Z","[0.1.0] Failed 3DSecure Authentication.",45],["2025-06-09T00:00:00Z","Transaction timed out",4188],["2025-06-09T00:00:00Z","[0.9075.0] 3D Secure authentication failed, payment not allowed.",481],["2025-06-23T00:00:00Z","Routing cannot be performed with the provided parameters",4],["2025-06-09T00:00:00Z","Unsupported card. Try another one",1507],["2025-06-09T00:00:00Z","Timeout",2706],["2025-06-23T00:00:00Z","[N] Authentication failed",22],["2025-06-16T00:00:00Z","other errors combined",13155],["2025-06-09T00:00:00Z","Insufficient Funds",1535],["2025-06-16T00:00:00Z","[ERROR_3DS_FAILURE] 3DS Verification timeout",498],["2025-06-09T00:00:00Z","other errors combined",10317],["2025-06-09T00:00:00Z","[0.1.0] Failed 3DSecure Authentication.",1037],["2025-06-16T00:00:00Z","Insufficient funds/over credit limit",790],["2025-06-16T00:00:00Z","processing.errors.fraud_error",1795],["2025-06-23T00:00:00Z","processing.errors.fraud_error",70],["2025-06-23T00:00:00Z","[ERROR_3DS_FAILURE] 3DS Verification timeout",30],["2025-06-16T00:00:00Z","[0.1.0] Suspected fraud.",2102],["2025-06-09T00:00:00Z","Declined by Risk Check",1084],["2025-06-09T00:00:00Z","Routing cannot be performed with the provided parameters",353],["2025-06-09T00:00:00Z","Transaction declined",199],["2025-06-09T00:00:00Z","Declined by issuing bank",517],["2025-06-23T00:00:00Z","[0.1.0] Exceeds withdrawal limit.",19],["2025-06-23T00:00:00Z","Suspected fraud",1],["2025-06-09T00:00:00Z","challenge/authentication failed.",2977],["2025-06-16T00:00:00Z","Challenge failed",436],["2025-06-09T00:00:00Z","[0.1.0] Transaction not permitted to cardholder.",509],["2025-06-09T00:00:00Z","[R] Authentication failed",277],["2025-06-09T00:00:00Z","[180001] No transaction registered on processor's side",341],["2025-06-09T00:00:00Z","Security",310],["2025-06-09T00:00:00Z","Client verification unsuccessful",1181],["2025-06-23T00:00:00Z","Restricted or invalid card status, call to issuer",7],["2025-06-09T00:00:00Z","Failed 3DSecure Authentication",371],["2025-06-09T00:00:00Z","Restricted or invalid card status, call to issuer",254],["2025-06-09T00:00:00Z","The authentication is cancelled or abandoned",481],["2025-06-16T00:00:00Z","[180000] 3Dv2 failed, status 'N': not authenticated/account not verified; transaction denied",603],["2025-06-23T00:00:00Z","Not sufficient funds",24],["2025-06-16T00:00:00Z","Processing error",1135],["2025-06-16T00:00:00Z","[0.1.0] Do not honor.",738],["2025-06-16T00:00:00Z","Transaction declined",305],["2025-06-23T00:00:00Z","[180000] 3Dv2 failed, status 'N': not authenticated/account not verified; transaction denied",21],["2025-06-23T00:00:00Z","null error",23],["2025-06-23T00:00:00Z","other errors combined",338],["2025-06-16T00:00:00Z","Insufficient funds",4562],["2025-06-16T00:00:00Z","External decline, call to issuer",4317],["2025-06-09T00:00:00Z","Processing error",1746],["2025-06-23T00:00:00Z","Ineligible transaction or Invalid transaction code",54],["2025-06-16T00:00:00Z","Suspected fraud",502],["2025-06-23T00:00:00Z","[ERROR_PROCESSING_CARD - [51]] Insufficient Funds",43],["2025-06-23T00:00:00Z","[R] Authentication failed",13],["2025-06-16T00:00:00Z","Unsupported card. Try another one",1322],["2025-06-16T00:00:00Z","Transaction declined by the issuing bank",511],["2025-06-16T00:00:00Z","Transaction timed out",1395],["2025-06-16T00:00:00Z","Fail to authenticate 3ds challenge. 14",302],["2025-06-23T00:00:00Z","[ERROR_PROCESSING_CARD - [59]] Suspected Fraud",42],["2025-06-09T00:00:00Z","[0.1.0] Exceeds withdrawal limit.",726],["2025-06-16T00:00:00Z","Restricted or invalid card status, call to issuer",249],["2025-06-23T00:00:00Z","Transaction declined by the issuing bank",6],["2025-06-09T00:00:00Z","Insufficient funds",4605],["2025-06-16T00:00:00Z","[0.1100.1116] Declined by acquirer's antifraud",571],["2025-06-16T00:00:00Z","Failed 3DSecure Authentication",144],["2025-06-23T00:00:00Z","Insufficient funds/over credit limit",26],["2025-06-23T00:00:00Z","Declined by issuing bank",20],["2025-06-23T00:00:00Z","Transaction declined",5],["2025-06-09T00:00:00Z","Challenge failed",1310],["2025-06-16T00:00:00Z","[0.9075.0] 3D Secure authentication failed, payment not allowed.",547],["2025-06-23T00:00:00Z","[0.1.0] Do not honor.",34],["2025-06-09T00:00:00Z","External decline, call to issuer",324],["2025-06-23T00:00:00Z","[0.1.0] Policy.",26],["2025-06-23T00:00:00Z","[0.1100.1116] Declined by acquirer's antifraud",19],["2025-06-09T00:00:00Z","[0.1100.1116] Declined by acquirer's antifraud",718],["2025-06-09T00:00:00Z","Blocked due to risk score",4917],["2025-06-16T00:00:00Z","[0.1.0] Insufficient funds.",2716],["2025-06-16T00:00:00Z","[ERROR_3DS_FAILURE] ERROR_3DS_FAILURE",1245],["2025-06-09T00:00:00Z","No 3DS payment prohibited or 3DS not passed",910],["2025-06-09T00:00:00Z","Fail to authenticate 3ds challenge. 14",309],["2025-06-16T00:00:00Z","Insufficient Funds",1159],["2025-06-09T00:00:00Z","null error",616],["2025-06-23T00:00:00Z","Processing error",28],["2025-06-09T00:00:00Z","[180000] 3Dv2 failed, status 'N': not authenticated/account not verified; transaction denied",427],["2025-06-23T00:00:00Z","Secure 3d timeout",120],["2025-06-16T00:00:00Z","Security",359],["2025-06-16T00:00:00Z","Authentication 3DS failed",2323],["2025-06-23T00:00:00Z","[0.1.0] Insufficient funds.",69],["2025-06-09T00:00:00Z","[0.1.0] Insufficient funds.",2530],["2025-06-09T00:00:00Z","processing.errors.fraud_error",1989],["2025-06-16T00:00:00Z","No 3DS payment prohibited or 3DS not passed",1551],["2025-06-16T00:00:00Z","[0.1.0] Transaction not permitted to cardholder.",458],["2025-06-23T00:00:00Z","[ERROR_3DS_FAILURE] ERROR_3DS_FAILURE",60],["2025-06-23T00:00:00Z","No 3DS payment prohibited or 3DS not passed",30],["2025-06-23T00:00:00Z","Insufficient funds",49],["2025-06-09T00:00:00Z","Secure 3d timeout",2710],["2025-06-16T00:00:00Z","Declined by issuing bank",1161],["2025-06-23T00:00:00Z","[0.1.0] Suspected fraud.",48],["2025-06-09T00:00:00Z","Suspected fraud",677],["2025-06-09T00:00:00Z","Not sufficient funds",464],["2025-06-23T00:00:00Z","Security",7],["2025-06-16T00:00:00Z","Timeout",4117],["2025-06-16T00:00:00Z","Secure 3d timeout",4389],["2025-06-09T00:00:00Z","Ineligible transaction or Invalid transaction code",1160],["2025-06-16T00:00:00Z","The authentication is cancelled or abandoned",329],["2025-06-23T00:00:00Z","Client verification unsuccessful",19],["2025-06-16T00:00:00Z","Ineligible transaction or Invalid transaction code",1795],["2025-06-09T00:00:00Z","Transaction expired",636],["2025-06-16T00:00:00Z","Not sufficient funds",479],["2025-06-23T00:00:00Z","[0.1.0] Transaction not permitted to cardholder.",15],["2025-06-23T00:00:00Z","challenge/authentication failed.",88],["2025-06-16T00:00:00Z","[ERROR_PROCESSING_CARD - [59]] Suspected Fraud",1259],["2025-06-09T00:00:00Z","Insufficient funds Insufficient funds",563],["2025-06-16T00:00:00Z","Routing cannot be performed with the provided parameters",356],["2025-06-16T00:00:00Z","[0.1.0] Exceeds withdrawal limit.",690],["2025-06-16T00:00:00Z","[0.1.0] Policy.",749],["2025-06-09T00:00:00Z","[0.1.0] Policy.",912],["2025-06-16T00:00:00Z","[R] Authentication failed",334],["2025-06-16T00:00:00Z","[180001] No transaction registered on processor's side",351],["2025-06-09T00:00:00Z","Insufficient funds/over credit limit",525],["2025-06-23T00:00:00Z","Fail to authenticate 3ds challenge. 14",8],["2025-06-16T00:00:00Z","Transaction expired",32],["2025-06-23T00:00:00Z","[0.9075.0] 3D Secure authentication failed, payment not allowed.",5],["2025-06-16T00:00:00Z","Blocked due to risk score",2433],["2025-06-09T00:00:00Z","Transaction declined by the issuing bank",658],["2025-06-09T00:00:00Z","[0.1.0] Suspected fraud.",2318],["2025-06-16T00:00:00Z","[0.1.0] Failed 3DSecure Authentication.",852],["2025-06-23T00:00:00Z","Timeout",54],["2025-06-16T00:00:00Z","challenge/authentication failed.",3028],["2025-06-16T00:00:00Z","null error",580],["2025-06-16T00:00:00Z","[ERROR_PROCESSING_CARD - [51]] Insufficient Funds",800],["2025-06-09T00:00:00Z","Authentication 3DS failed",1203],["2025-06-16T00:00:00Z","[N] Authentication failed",506],["2025-06-23T00:00:00Z","External decline, call to issuer",8],["2025-06-23T00:00:00Z","Authentication 3DS failed",89],["2025-06-23T00:00:00Z","Insufficient Funds",21]],"cols":[{"display_name":"CREATED_AT","source":"native","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"name":"CREATED_AT","base_type":"type/DateTime","database_type":"DATETIME","effective_type":"type/DateTime"},{"display_name":"ERROR_NAME","source":"native","field_ref":["field","ERROR_NAME",{"base-type":"type/Text"}],"name":"ERROR_NAME","base_type":"type/Text","database_type":"VARCHAR","effective_type":"type/Text"},{"display_name":"COUNT_NAME","source":"native","field_ref":["field","COUNT_NAME",{"base-type":"type/BigInteger"}],"name":"COUNT_NAME","base_type":"type/BigInteger","database_type":"BIGINT","effective_type":"type/BigInteger"}],"native_form":{"params":["week","2025-06-09T00:00:00Z","2025-06-24T00:00:00Z","week"],"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where ?\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        STATUS_NAME = 'error' and\n        `MART__FATPAY`.`CREATED_AT` >= ? AND `MART__FATPAY`.`CREATED_AT` < ?\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and day(CREATED_AT) <= 31\n),\n\nerrors_ranked as (\n    select \n        ERROR_NAME,\n        RANK() OVER (ORDER BY count(distinct ORDER_ID) DESC) as error_rank\n    from filtered_fatpay\n    group by 1\n)\n\nselect \n    date_trunc(?, MART__FATPAY.CREATED_AT) as CREATED_AT,\n    case \n        when ranks.error_rank < 50 then MART__FATPAY.ERROR_NAME\n        else 'other errors combined'\n    end as ERROR_NAME,\n    count(distinct MART__FATPAY.ORDER_ID) as COUNT_NAME\nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\nleft join errors_ranked as ranks\n    on MART__FATPAY.ERROR_NAME = ranks.ERROR_NAME\ngroup by 1, 2"},"results_timezone":"Etc/UTC","format-rows?":true,"results_metadata":{"columns":[{"display_name":"CREATED_AT","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"base_type":"type/DateTime","effective_type":"type/DateTime","name":"CREATED_AT","semantic_type":"type/CreationTimestamp","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/DateTime":{"earliest":"2025-06-09T00:00:00Z","latest":"2025-06-23T00:00:00Z"}}}},{"display_name":"ERROR_NAME","field_ref":["field","ERROR_NAME",{"base-type":"type/Text"}],"base_type":"type/Text","effective_type":"type/Text","name":"ERROR_NAME","semantic_type":null,"fingerprint":{"global":{"distinct-count":50,"nil%":0.0},"type":{"type/Text":{"percent-json":0.237037037037037,"percent-url":0.0,"percent-email":0.0,"percent-state":0.0,"average-length":31.57037037037037}}}},{"display_name":"COUNT_NAME","field_ref":["field","COUNT_NAME",{"base-type":"type/BigInteger"}],"base_type":"type/BigInteger","effective_type":"type/BigInteger","name":"COUNT_NAME","semantic_type":null,"fingerprint":{"global":{"distinct-count":124,"nil%":0.0},"type":{"type/Number":{"min":1.0,"q1":57.791535145673976,"q3":1176.6507575950825,"max":13155.0,"sd":1732.7696711973226,"avg":1026.5703703703705}}}}]},"insights":[{"previous-value":null,"unit":null,"offset":1931327.8217555662,"last-change":null,"col":"COUNT_NAME","slope":-95.30145152928523,"last-value":21,"best-fit":["+",1931327.8217555662,["*",-95.30145152928523,"x"]]}]},"cached":null,"database_id":16,"started_at":"2025-06-23T08:45:45.295633198Z","json_query":{"type":"native","database":16,"native":{"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{granularity}}\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        STATUS_NAME = 'error' and\n        {{CREATED_AT}}\n        and {{CARD_GEOSCHEME}}\n        and {{CARD_COUNTRY}}\n        and {{STATUS}}\n        and {{BUSINESS_NAME}}\n        and {{USER_NAME}}\n        and {{FIAT_CURRENCY}}\n        and {{ACQUIRER}}\n        and {{CARD_BRAND}}\n        and {{PAYMENT_TERMINAL}}\n        and {{ERROR_GROUP}}\n        and {{ERROR_NAME}}\n        and {{HAS_ID_PROVIDER}}\n        and {{SHOP}}\n        and {{is_aft}}\n        and day(CREATED_AT) <= {{day_number}}\n),\n\nerrors_ranked as (\n    select \n        ERROR_NAME,\n        RANK() OVER (ORDER BY count(distinct ORDER_ID) DESC) as error_rank\n    from filtered_fatpay\n    group by 1\n)\n\nselect \n    date_trunc({{granularity}}, MART__FATPAY.CREATED_AT) as CREATED_AT,\n    case \n        when ranks.error_rank < 50 then MART__FATPAY.ERROR_NAME\n        else 'other errors combined'\n    end as ERROR_NAME,\n    count(distinct MART__FATPAY.ORDER_ID) as COUNT_NAME\nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\nleft join errors_ranked as ranks\n    on MART__FATPAY.ERROR_NAME = ranks.ERROR_NAME\ngroup by 1, 2","template-tags":{"HAS_ID_PROVIDER":{"id":"ccfae457-edf3-74d1-1e41-6e4d86a7073f","name":"HAS_ID_PROVIDER","display-name":"Has id provider","type":"dimension","dimension":["field",756250,null],"widget-type":"string/=","default":null},"CARD_COUNTRY":{"id":"29492df1-225c-ccb0-9a4e-272c5f987ac5","name":"CARD_COUNTRY","display-name":"Card country","type":"dimension","dimension":["field",756254,null],"widget-type":"string/=","default":null},"ERROR_GROUP":{"id":"bb7f9117-7da8-bc24-8190-7626f33e6af0","name":"ERROR_GROUP","display-name":"Error group","type":"dimension","dimension":["field",756269,null],"widget-type":"string/=","default":null},"FIAT_CURRENCY":{"id":"5cab7ad0-e021-f0c5-4e22-a66c43242330","name":"FIAT_CURRENCY","display-name":"Fiat currency","type":"dimension","dimension":["field",756268,null],"widget-type":"string/=","default":null},"is_aft":{"type":"dimension","name":"is_aft","id":"2dd903ca-c123-4db3-8aa0-dfde9e3aa943","display-name":"Is Aft","default":null,"dimension":["field",760549,null],"widget-type":"string/=","options":null},"ERROR_NAME":{"id":"4ed8b652-3c97-6a86-8a35-7a397b6f42ea","name":"ERROR_NAME","display-name":"Error name","type":"dimension","dimension":["field",756230,null],"widget-type":"string/contains","default":null},"PAYMENT_TERMINAL":{"id":"cd9daa34-226e-58e4-673d-7fd1179e7dee","name":"PAYMENT_TERMINAL","display-name":"Payment terminal","type":"dimension","dimension":["field",756239,null],"widget-type":"string/=","default":null},"SHOP":{"id":"0ab57007-f839-97ad-a6e7-99a699f479b3","name":"SHOP","display-name":"Shop","type":"dimension","dimension":["field",756245,null],"widget-type":"string/="},"BUSINESS_NAME":{"id":"1a7ca3c6-ac96-dcc3-dbdc-20e1d3c55320","name":"BUSINESS_NAME","display-name":"Business name","type":"dimension","dimension":["field",756258,null],"widget-type":"string/=","default":null},"day_number":{"type":"number","name":"day_number","id":"91d2692a-b118-48c7-8cad-1d973535fb92","display-name":"Month-to-Date Day Number","default":"31","required":true},"granularity":{"id":"37799d21-54a5-2233-9de5-517db3c5bab0","name":"granularity","display-name":"Granularity","type":"text","required":true,"default":"week","values-source-type":"static-list","values-source-config":{"values":[["hour"],["day"],["week"],["month"],["quarter"],["year"]]}},"ACQUIRER":{"id":"0add554f-79fc-6685-f405-66c92af72b79","name":"ACQUIRER","display-name":"Acquirer","type":"dimension","dimension":["field",756224,null],"widget-type":"string/=","default":null},"CREATED_AT":{"id":"7e66dcc1-f9af-d388-5804-ea74427d78fb","name":"CREATED_AT","display-name":"Created at","type":"dimension","dimension":["field",756256,null],"widget-type":"date/all-options","default":"past14days~","required":true},"CARD_GEOSCHEME":{"id":"0d642257-5a4e-bc22-1afa-998bdf910c28","name":"CARD_GEOSCHEME","display-name":"Card geoscheme","type":"dimension","dimension":["field",756227,null],"widget-type":"string/=","default":null},"USER_NAME":{"id":"0ed73475-19ec-3399-0857-ad2c1e797d73","name":"USER_NAME","display-name":"User name","type":"dimension","dimension":["field",756263,null],"widget-type":"string/contains","default":null},"STATUS":{"id":"f05b9ffc-bfb1-f94b-4509-3fa683d56e44","name":"STATUS","display-name":"Status","type":"dimension","dimension":["field",756257,null],"widget-type":"string/=","default":null},"CARD_BRAND":{"id":"45d19436-bb36-cae1-7b66-470806737fb6","name":"CARD_BRAND","display-name":"Card brand","type":"dimension","dimension":["field",756238,null],"widget-type":"string/=","default":null}}},"middleware":{"js-int-to-string?":true,"userland-query?":true,"add-default-userland-constraints?":true}},"average_execution_time":null,"status":"completed","context":"ad-hoc","row_count":135,"running_time":165}

📝 Validating Question 8/11
--------------------------------------------------
  🔍 Validating Question 4165: 2 Number of Transactions split by Status
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_granularity as (
    select distinct granularity
    from MD__FATPAY_DASHBOARD_HELP_TA...
    ❌ SQL Error detected in response
    📄 Response: {"data":{"rows":[["2025-06-09T00:00:00Z","complete",139214],["2025-06-16T00:00:00Z","complete",143979],["2025-06-23T00:00:00Z","error",1610],["2025-06-23T00:00:00Z","other",302],["2025-06-23T00:00:00Z","complete",4103],["2025-06-09T00:00:00Z","error",64963],["2025-06-16T00:00:00Z","error",72014],["2025-06-16T00:00:00Z","other",11117],["2025-06-09T00:00:00Z","other",6414]],"cols":[{"display_name":"CREATED_AT","source":"native","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"name":"CREATED_AT","base_type":"type/DateTime","database_type":"DATETIME","effective_type":"type/DateTime"},{"display_name":"STATUS","source":"native","field_ref":["field","STATUS",{"base-type":"type/Text"}],"name":"STATUS","base_type":"type/Text","database_type":"VARCHAR","effective_type":"type/Text"},{"display_name":"COUNT_STATUS","source":"native","field_ref":["field","COUNT_STATUS",{"base-type":"type/BigInteger"}],"name":"COUNT_STATUS","base_type":"type/BigInteger","database_type":"BIGINT","effective_type":"type/BigInteger"}],"native_form":{"params":["week","2025-06-09T00:00:00Z","2025-06-24T00:00:00Z","week"],"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where ?\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        `MART__FATPAY`.`CREATED_AT` >= ? AND `MART__FATPAY`.`CREATED_AT` < ?\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and day(CREATED_AT) <= 31\n)\n\nselect \n    date_trunc(?, MART__FATPAY.CREATED_AT) as CREATED_AT,\n    case \n        when MART__FATPAY.STATUS_NAME in ('complete', 'error') then MART__FATPAY.STATUS_NAME\n        else 'other'\n    end as STATUS,\n    count(distinct MART__FATPAY.ORDER_ID) as COUNT_STATUS\nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\ngroup by 1, 2"},"results_timezone":"Etc/UTC","format-rows?":true,"results_metadata":{"columns":[{"display_name":"CREATED_AT","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"base_type":"type/DateTime","effective_type":"type/DateTime","name":"CREATED_AT","semantic_type":"type/CreationTimestamp","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/DateTime":{"earliest":"2025-06-09T00:00:00Z","latest":"2025-06-23T00:00:00Z"}}}},{"display_name":"STATUS","field_ref":["field","STATUS",{"base-type":"type/Text"}],"base_type":"type/Text","effective_type":"type/Text","name":"STATUS","semantic_type":"type/Category","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/Text":{"percent-json":0.0,"percent-url":0.0,"percent-email":0.0,"percent-state":0.0,"average-length":6.0}}}},{"display_name":"COUNT_STATUS","field_ref":["field","COUNT_STATUS",{"base-type":"type/BigInteger"}],"base_type":"type/BigInteger","effective_type":"type/BigInteger","name":"COUNT_STATUS","semantic_type":null,"fingerprint":{"global":{"distinct-count":9,"nil%":0.0},"type":{"type/Number":{"min":302.0,"q1":3479.75,"q3":88814.0,"max":143979.0,"sd":58975.583053026654,"avg":49301.77777777778}}}}]},"insights":[{"previous-value":11117,"unit":"week","offset":9.870851320640403E7,"last-change":-0.4230457857335612,"col":"COUNT_STATUS","slope":-4870.857142859851,"last-value":6414,"best-fit":["+",9.870851320640403E7,["*",-4870.857142859851,"x"]]}]},"cached":null,"database_id":16,"started_at":"2025-06-23T08:45:46.648502324Z","json_query":{"type":"native","database":16,"native":{"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{granularity}}\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        {{CREATED_AT}}\n        and {{CARD_GEOSCHEME}}\n        and {{CARD_COUNTRY}}\n        and {{STATUS}}\n        and {{BUSINESS_NAME}}\n        and {{USER_NAME}}\n        and {{FIAT_CURRENCY}}\n        and {{ACQUIRER}}\n        and {{CARD_BRAND}}\n        and {{PAYMENT_TERMINAL}}\n        and {{ERROR_GROUP}}\n        and {{ERROR_NAME}}\n        and {{HAS_ID_PROVIDER}}\n        and {{SHOP}}\n        and {{is_aft}}\n        and day(CREATED_AT) <= {{day_number}}\n)\n\nselect \n    date_trunc({{granularity}}, MART__FATPAY.CREATED_AT) as CREATED_AT,\n    case \n        when MART__FATPAY.STATUS_NAME in ('complete', 'error') then MART__FATPAY.STATUS_NAME\n        else 'other'\n    end as STATUS,\n    count(distinct MART__FATPAY.ORDER_ID) as COUNT_STATUS\nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\ngroup by 1, 2","template-tags":{"HAS_ID_PROVIDER":{"id":"10b010d1-7078-11a5-5f95-6d01f91e95ba","name":"HAS_ID_PROVIDER","display-name":"Has id provider","type":"dimension","dimension":["field",756250,null],"widget-type":"string/=","default":null},"CARD_COUNTRY":{"id":"29492df1-225c-ccb0-9a4e-272c5f987ac5","name":"CARD_COUNTRY","display-name":"Card country","type":"dimension","dimension":["field",756254,null],"widget-type":"string/=","default":null},"ERROR_GROUP":{"id":"bb7f9117-7da8-bc24-8190-7626f33e6af0","name":"ERROR_GROUP","display-name":"Error group","type":"dimension","dimension":["field",756269,null],"widget-type":"string/=","default":null},"FIAT_CURRENCY":{"id":"5cab7ad0-e021-f0c5-4e22-a66c43242330","name":"FIAT_CURRENCY","display-name":"Fiat currency","type":"dimension","dimension":["field",756268,null],"widget-type":"string/=","default":null},"is_aft":{"type":"dimension","name":"is_aft","id":"1196883c-27f8-44f0-83e1-3e25f6ca4f0d","display-name":"Is Aft","default":null,"dimension":["field",760549,null],"widget-type":"string/=","options":null},"ERROR_NAME":{"id":"4ed8b652-3c97-6a86-8a35-7a397b6f42ea","name":"ERROR_NAME","display-name":"Error name","type":"dimension","dimension":["field",756230,null],"widget-type":"string/contains","default":null},"PAYMENT_TERMINAL":{"id":"cd9daa34-226e-58e4-673d-7fd1179e7dee","name":"PAYMENT_TERMINAL","display-name":"Payment terminal","type":"dimension","dimension":["field",756239,null],"widget-type":"string/=","default":null},"SHOP":{"id":"5839b0d9-61ab-6893-b4f8-0da1584b541e","name":"SHOP","display-name":"Shop","type":"dimension","dimension":["field",756245,null],"widget-type":"string/="},"BUSINESS_NAME":{"id":"1a7ca3c6-ac96-dcc3-dbdc-20e1d3c55320","name":"BUSINESS_NAME","display-name":"Business name","type":"dimension","dimension":["field",756258,null],"widget-type":"string/=","default":null},"day_number":{"type":"number","name":"day_number","id":"b982b7e2-3e36-4b1d-ae29-1b7fc3cebeb5","display-name":"Month-to-Date Day Number","default":"31","required":true},"granularity":{"id":"37799d21-54a5-2233-9de5-517db3c5bab0","name":"granularity","display-name":"Granularity","type":"text","required":true,"default":"week","values-source-type":"static-list","values-source-config":{"values":[["hour"],["day"],["week"],["month"],["quarter"],["year"]]}},"ACQUIRER":{"id":"0add554f-79fc-6685-f405-66c92af72b79","name":"ACQUIRER","display-name":"Acquirer","type":"dimension","dimension":["field",756224,null],"widget-type":"string/=","default":null},"CREATED_AT":{"id":"7e66dcc1-f9af-d388-5804-ea74427d78fb","name":"CREATED_AT","display-name":"Created at","type":"dimension","dimension":["field",756256,null],"widget-type":"date/all-options","default":"past14days~","required":true},"CARD_GEOSCHEME":{"id":"0d642257-5a4e-bc22-1afa-998bdf910c28","name":"CARD_GEOSCHEME","display-name":"Card geoscheme","type":"dimension","dimension":["field",756227,null],"widget-type":"string/=","default":null},"USER_NAME":{"id":"0ed73475-19ec-3399-0857-ad2c1e797d73","name":"USER_NAME","display-name":"User name","type":"dimension","dimension":["field",756263,null],"widget-type":"string/contains","default":null},"STATUS":{"id":"f05b9ffc-bfb1-f94b-4509-3fa683d56e44","name":"STATUS","display-name":"Status","type":"dimension","dimension":["field",756257,null],"widget-type":"string/=","default":null},"CARD_BRAND":{"id":"45d19436-bb36-cae1-7b66-470806737fb6","name":"CARD_BRAND","display-name":"Card brand","type":"dimension","dimension":["field",756238,null],"widget-type":"string/=","default":null}}},"middleware":{"js-int-to-string?":true,"userland-query?":true,"add-default-userland-constraints?":true}},"average_execution_time":null,"status":"completed","context":"ad-hoc","row_count":9,"running_time":68}

📝 Validating Question 9/11
--------------------------------------------------
  🔍 Validating Question 4171: 2 Number of Transactions split by Antifraud
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_granularity as (
    select distinct granularity
    from MD__FATPAY_DASHBOARD_HELP_TA...
    ❌ SQL Error detected in response
    📄 Response: {"data":{"rows":[["2025-06-23T00:00:00Z","Whyhappen confirm",5941],["2025-06-09T00:00:00Z","Whyhappen confirm",207755],["2025-06-16T00:00:00Z","Fatpay rejected",1970],["2025-06-09T00:00:00Z","Fatpay rejected",2836],["2025-06-23T00:00:00Z","Fatpay rejected",74],["2025-06-16T00:00:00Z","Whyhappen confirm",225140]],"cols":[{"display_name":"CREATED_AT","source":"native","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"name":"CREATED_AT","base_type":"type/DateTime","database_type":"DATETIME","effective_type":"type/DateTime"},{"display_name":"ANTIFRAUD_STATUS","source":"native","field_ref":["field","ANTIFRAUD_STATUS",{"base-type":"type/Text"}],"name":"ANTIFRAUD_STATUS","base_type":"type/Text","database_type":"VARCHAR","effective_type":"type/Text"},{"display_name":"COUNT_ANTIFRAUD","source":"native","field_ref":["field","COUNT_ANTIFRAUD",{"base-type":"type/BigInteger"}],"name":"COUNT_ANTIFRAUD","base_type":"type/BigInteger","database_type":"BIGINT","effective_type":"type/BigInteger"}],"native_form":{"params":["week","2025-06-09T00:00:00Z","2025-06-24T00:00:00Z","week"],"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where ?\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        `MART__FATPAY`.`CREATED_AT` >= ? AND `MART__FATPAY`.`CREATED_AT` < ?\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and day(CREATED_AT) <= 31\n)\n\nselect \n    date_trunc(?, MART__FATPAY.CREATED_AT) as CREATED_AT,\n    case \n        when MART__FATPAY.HAS_ID_PROVIDER=False then 'Fatpay rejected'\n        else concat('Whyhappen ', coalesce(MART__FATPAY.ANTIFRAUD_STATUS, 'no status'))\n    end as ANTIFRAUD_STATUS,\n    count(distinct MART__FATPAY.ORDER_ID) as COUNT_ANTIFRAUD\nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\ngroup by 1, 2"},"results_timezone":"Etc/UTC","format-rows?":true,"results_metadata":{"columns":[{"display_name":"CREATED_AT","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"base_type":"type/DateTime","effective_type":"type/DateTime","name":"CREATED_AT","semantic_type":"type/CreationTimestamp","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/DateTime":{"earliest":"2025-06-09T00:00:00Z","latest":"2025-06-23T00:00:00Z"}}}},{"display_name":"ANTIFRAUD_STATUS","field_ref":["field","ANTIFRAUD_STATUS",{"base-type":"type/Text"}],"base_type":"type/Text","effective_type":"type/Text","name":"ANTIFRAUD_STATUS","semantic_type":null,"fingerprint":{"global":{"distinct-count":2,"nil%":0.0},"type":{"type/Text":{"percent-json":0.0,"percent-url":0.0,"percent-email":0.0,"percent-state":0.0,"average-length":16.0}}}},{"display_name":"COUNT_ANTIFRAUD","field_ref":["field","COUNT_ANTIFRAUD",{"base-type":"type/BigInteger"}],"base_type":"type/BigInteger","effective_type":"type/BigInteger","name":"COUNT_ANTIFRAUD","semantic_type":null,"fingerprint":{"global":{"distinct-count":6,"nil%":0.0},"type":{"type/Number":{"min":74.0,"q1":1970.0,"q3":207755.0,"max":225140.0,"sd":110529.09384893494,"avg":73952.66666666667}}}}]},"insights":[{"previous-value":74,"unit":"week","offset":1.4806276980952382E8,"last-change":3041.4324324324325,"col":"COUNT_ANTIFRAUD","slope":-7306.285714285715,"last-value":225140,"best-fit":["+",1.4806276980952382E8,["*",-7306.285714285715,"x"]]}]},"cached":null,"database_id":16,"started_at":"2025-06-23T08:45:47.896744607Z","json_query":{"type":"native","database":16,"native":{"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{granularity}}\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        {{CREATED_AT}}\n        and {{CARD_GEOSCHEME}}\n        and {{CARD_COUNTRY}}\n        and {{STATUS}}\n        and {{BUSINESS_NAME}}\n        and {{USER_NAME}}\n        and {{FIAT_CURRENCY}}\n        and {{ACQUIRER}}\n        and {{CARD_BRAND}}\n        and {{PAYMENT_TERMINAL}}\n        and {{ERROR_GROUP}}\n        and {{ERROR_NAME}}\n        and {{HAS_ID_PROVIDER}}\n        and {{SHOP}}\n        and {{is_aft}}\n        and day(CREATED_AT) <= {{day_number}}\n)\n\nselect \n    date_trunc({{granularity}}, MART__FATPAY.CREATED_AT) as CREATED_AT,\n    case \n        when MART__FATPAY.HAS_ID_PROVIDER=False then 'Fatpay rejected'\n        else concat('Whyhappen ', coalesce(MART__FATPAY.ANTIFRAUD_STATUS, 'no status'))\n    end as ANTIFRAUD_STATUS,\n    count(distinct MART__FATPAY.ORDER_ID) as COUNT_ANTIFRAUD\nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\ngroup by 1, 2","template-tags":{"HAS_ID_PROVIDER":{"id":"5f6b1682-5cf1-5192-f7c6-f9a99e1f72f9","name":"HAS_ID_PROVIDER","display-name":"Has id provider","type":"dimension","dimension":["field",756250,null],"widget-type":"string/=","default":null},"CARD_COUNTRY":{"id":"29492df1-225c-ccb0-9a4e-272c5f987ac5","name":"CARD_COUNTRY","display-name":"Card country","type":"dimension","dimension":["field",756254,null],"widget-type":"string/=","default":null},"ERROR_GROUP":{"id":"bb7f9117-7da8-bc24-8190-7626f33e6af0","name":"ERROR_GROUP","display-name":"Error group","type":"dimension","dimension":["field",756269,null],"widget-type":"string/=","default":null},"FIAT_CURRENCY":{"id":"5cab7ad0-e021-f0c5-4e22-a66c43242330","name":"FIAT_CURRENCY","display-name":"Fiat currency","type":"dimension","dimension":["field",756268,null],"widget-type":"string/=","default":null},"is_aft":{"type":"dimension","name":"is_aft","id":"7b83ac11-44bd-4c4c-b5fb-9f4ee3e328d9","display-name":"Is Aft","default":null,"dimension":["field",760549,null],"widget-type":"string/=","options":null},"ERROR_NAME":{"id":"4ed8b652-3c97-6a86-8a35-7a397b6f42ea","name":"ERROR_NAME","display-name":"Error name","type":"dimension","dimension":["field",756230,null],"widget-type":"string/contains","default":null},"PAYMENT_TERMINAL":{"id":"cd9daa34-226e-58e4-673d-7fd1179e7dee","name":"PAYMENT_TERMINAL","display-name":"Payment terminal","type":"dimension","dimension":["field",756239,null],"widget-type":"string/=","default":null},"SHOP":{"id":"aacdc955-baa1-31dc-9152-9d3cbb81bf8d","name":"SHOP","display-name":"Shop","type":"dimension","dimension":["field",756245,null],"widget-type":"string/="},"BUSINESS_NAME":{"id":"1a7ca3c6-ac96-dcc3-dbdc-20e1d3c55320","name":"BUSINESS_NAME","display-name":"Business name","type":"dimension","dimension":["field",756258,null],"widget-type":"string/=","default":null},"day_number":{"type":"number","name":"day_number","id":"20041e13-e8d2-4ef0-b791-14537b168f80","display-name":"Month-to-Date Day Number","default":"31","required":true},"granularity":{"id":"37799d21-54a5-2233-9de5-517db3c5bab0","name":"granularity","display-name":"Granularity","type":"text","required":true,"default":"week","values-source-type":"static-list","values-source-config":{"values":[["hour"],["day"],["week"],["month"],["quarter"],["year"]]}},"ACQUIRER":{"id":"0add554f-79fc-6685-f405-66c92af72b79","name":"ACQUIRER","display-name":"Acquirer","type":"dimension","dimension":["field",756224,null],"widget-type":"string/=","default":null},"CREATED_AT":{"id":"7e66dcc1-f9af-d388-5804-ea74427d78fb","name":"CREATED_AT","display-name":"Created at","type":"dimension","dimension":["field",756256,null],"widget-type":"date/all-options","default":"past14days~","required":true},"CARD_GEOSCHEME":{"id":"0d642257-5a4e-bc22-1afa-998bdf910c28","name":"CARD_GEOSCHEME","display-name":"Card geoscheme","type":"dimension","dimension":["field",756227,null],"widget-type":"string/=","default":null},"USER_NAME":{"id":"0ed73475-19ec-3399-0857-ad2c1e797d73","name":"USER_NAME","display-name":"User name","type":"dimension","dimension":["field",756263,null],"widget-type":"string/contains","default":null},"STATUS":{"id":"f05b9ffc-bfb1-f94b-4509-3fa683d56e44","name":"STATUS","display-name":"Status","type":"dimension","dimension":["field",756257,null],"widget-type":"string/=","default":null},"CARD_BRAND":{"id":"45d19436-bb36-cae1-7b66-470806737fb6","name":"CARD_BRAND","display-name":"Card brand","type":"dimension","dimension":["field",756238,null],"widget-type":"string/=","default":null}}},"middleware":{"js-int-to-string?":true,"userland-query?":true,"add-default-userland-constraints?":true}},"average_execution_time":null,"status":"completed","context":"ad-hoc","row_count":6,"running_time":85}

📝 Validating Question 10/11
--------------------------------------------------
  🔍 Validating Question 4163: 2 Rates
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_granularity as (
    select granularity
    from MD__FATPAY_DASHBOARD_HELP_TABLE
    w...
    ❌ SQL Error detected in response
    📄 Response: {"data":{"rows":[["2025-06-23T00:00:00Z",0.6821280133000831,0.6987531172069825,0.015627597672485453],["2025-06-16T00:00:00Z",0.6339615164457751,0.6478490599269077,0.013640966932323544],["2025-06-09T00:00:00Z",0.6610633882739528,0.6770137375291442,0.015931355091148246]],"cols":[{"display_name":"CREATED_AT","source":"native","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"name":"CREATED_AT","base_type":"type/DateTime","database_type":"DATETIME","effective_type":"type/DateTime"},{"display_name":"acceptance_rate","source":"native","field_ref":["field","acceptance_rate",{"base-type":"type/Float"}],"name":"acceptance_rate","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"},{"display_name":"authorization_rate","source":"native","field_ref":["field","authorization_rate",{"base-type":"type/Float"}],"name":"authorization_rate","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"},{"display_name":"merchant_void_rate","source":"native","field_ref":["field","merchant_void_rate",{"base-type":"type/Float"}],"name":"merchant_void_rate","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"}],"native_form":{"params":["week","2025-06-09T00:00:00Z","2025-06-24T00:00:00Z","week"],"query":"with filtered_granularity as (\n    select granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where ?\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select \n        CREATED_AT,\n        STATUS_NAME,\n        AUTH_STATUS_NAME,\n        ORDER_ID\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        `MART__FATPAY`.`CREATED_AT` >= ? AND `MART__FATPAY`.`CREATED_AT` < ?\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and day(CREATED_AT) <= 31\n)\n\nselect \n    date_trunc(?, ff.CREATED_AT) as CREATED_AT,\n    count(distinct case when STATUS_NAME = 'complete' then ORDER_ID end) /\n        count(distinct ORDER_ID)\n        as acceptance_rate,\n    count(distinct case when AUTH_STATUS_NAME = 'complete' OR STATUS_NAME = 'complete' then ORDER_ID end) /\n        count(distinct ORDER_ID)\n        as authorization_rate,\n    count(distinct case when STATUS_NAME = 'void' then ORDER_ID end) /\n        count(distinct ORDER_ID)\n        as merchant_void_rate\nfrom filtered_fatpay as ff\nleft join filtered_granularity as fg\n    on 1 = 1\ngroup by 1"},"results_timezone":"Etc/UTC","format-rows?":true,"results_metadata":{"columns":[{"display_name":"CREATED_AT","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"base_type":"type/DateTime","effective_type":"type/DateTime","name":"CREATED_AT","semantic_type":"type/CreationTimestamp","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/DateTime":{"earliest":"2025-06-09T00:00:00Z","latest":"2025-06-23T00:00:00Z"}}}},{"display_name":"acceptance_rate","field_ref":["field","acceptance_rate",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"acceptance_rate","semantic_type":"type/Share","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/Number":{"min":0.6339615164457751,"q1":0.6407369844028196,"q3":0.6768618570435505,"max":0.6821280133000831,"sd":0.0241462257343962,"avg":0.6590509726732704}}}},{"display_name":"authorization_rate","field_ref":["field","authorization_rate",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"authorization_rate","semantic_type":"type/Share","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/Number":{"min":0.6478490599269077,"q1":0.6551402293274668,"q3":0.693318272287523,"max":0.6987531172069825,"sd":0.025542128911508626,"avg":0.6745386382210116}}}},{"display_name":"merchant_void_rate","field_ref":["field","merchant_void_rate",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"merchant_void_rate","semantic_type":"type/Share","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/Number":{"min":0.013640966932323544,"q1":0.01413762461736402,"q3":0.015855415736482546,"max":0.015931355091148246,"sd":0.0012439753605031295,"avg":0.015066639898652414}}}}]},"insights":[{"previous-value":0.6339615164457751,"unit":"week","offset":-29.81694759191726,"last-change":0.04275002681569837,"col":"acceptance_rate","slope":0.001504616073295015,"last-value":0.6610633882739528,"best-fit":["+",-29.81694759191726,["*",0.001504616073295015,"x"]]},{"previous-value":0.6478490599269077,"unit":"week","offset":-30.7776853171086,"last-change":0.0450177045954608,"col":"authorization_rate","slope":0.0015528128341313063,"last-value":0.6770137375291442,"best-fit":["+",-30.7776853171086,["*",0.0015528128341313063,"x"]]},{"previous-value":0.013640966932323544,"unit":"week","offset":0.45453853382828585,"last-change":0.16790511773746875,"col":"merchant_void_rate","slope":-2.169695847591377E-5,"last-value":0.015931355091148246,"best-fit":["+",4.376472982394702,["*",-0.4398282902860999,["log","x"]]]}]},"cached":null,"database_id":16,"started_at":"2025-06-23T08:45:49.165068875Z","json_query":{"type":"native","database":16,"native":{"query":"with filtered_granularity as (\n    select granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{granularity}}\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select \n        CREATED_AT,\n        STATUS_NAME,\n        AUTH_STATUS_NAME,\n        ORDER_ID\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        {{CREATED_AT}}\n        and {{CARD_GEOSCHEME}}\n        and {{CARD_COUNTRY}}\n        and {{STATUS}}\n        and {{BUSINESS_NAME}}\n        and {{USER_NAME}}\n        and {{FIAT_CURRENCY}}\n        and {{ACQUIRER}}\n        and {{CARD_BRAND}}\n        and {{PAYMENT_TERMINAL}}\n        and {{ERROR_GROUP}}\n        and {{ERROR_NAME}}\n        and {{HAS_ID_PROVIDER}}\n        and {{SHOP}}\n        and {{is_aft}}\n        and day(CREATED_AT) <= {{day_number}}\n)\n\nselect \n    date_trunc({{granularity}}, ff.CREATED_AT) as CREATED_AT,\n    count(distinct case when STATUS_NAME = 'complete' then ORDER_ID end) /\n        count(distinct ORDER_ID)\n        as acceptance_rate,\n    count(distinct case when AUTH_STATUS_NAME = 'complete' OR STATUS_NAME = 'complete' then ORDER_ID end) /\n        count(distinct ORDER_ID)\n        as authorization_rate,\n    count(distinct case when STATUS_NAME = 'void' then ORDER_ID end) /\n        count(distinct ORDER_ID)\n        as merchant_void_rate\nfrom filtered_fatpay as ff\nleft join filtered_granularity as fg\n    on 1 = 1\ngroup by 1 ","template-tags":{"HAS_ID_PROVIDER":{"id":"5c544c3b-7ad7-50ef-b7c3-c2d3b1599e91","name":"HAS_ID_PROVIDER","display-name":"Has id provider","type":"dimension","dimension":["field",756250,null],"widget-type":"string/=","default":null},"CARD_COUNTRY":{"id":"716a10f7-f987-2208-4429-4b0598b2432e","name":"CARD_COUNTRY","display-name":"Card country","type":"dimension","dimension":["field",756254,null],"widget-type":"string/=","required":false},"ERROR_GROUP":{"id":"2287bcf2-879d-a509-ecef-f2f375ebe882","name":"ERROR_GROUP","display-name":"Error group","type":"dimension","dimension":["field",756269,null],"widget-type":"string/=","default":null},"FIAT_CURRENCY":{"id":"e734ceda-ef86-ce9c-358a-69566a4c0214","name":"FIAT_CURRENCY","display-name":"Fiat currency","type":"dimension","dimension":["field",756268,null],"widget-type":"string/=","default":null},"is_aft":{"type":"dimension","name":"is_aft","id":"1db60c58-4727-4ad5-b0fe-2f8c94f463f5","display-name":"Is Aft","default":null,"dimension":["field",760549,null],"widget-type":"string/=","options":null},"ERROR_NAME":{"id":"0f8f7ec3-37a6-f67c-8319-7d255e39e841","name":"ERROR_NAME","display-name":"Error name","type":"dimension","dimension":["field",756230,null],"widget-type":"string/contains","default":null},"PAYMENT_TERMINAL":{"id":"698f65a5-572d-3286-034e-151b59125736","name":"PAYMENT_TERMINAL","display-name":"Payment terminal","type":"dimension","dimension":["field",756239,null],"widget-type":"string/=","default":null},"SHOP":{"id":"4c8f0b15-1345-a925-235b-2bcbc3eeeef4","name":"SHOP","display-name":"Shop","type":"dimension","dimension":["field",756245,null],"widget-type":"string/="},"BUSINESS_NAME":{"id":"bd69ce89-a3be-5f0d-90ef-0ad9b70f116e","name":"BUSINESS_NAME","display-name":"Business name","type":"dimension","dimension":["field",756258,null],"widget-type":"string/=","default":null},"day_number":{"type":"number","name":"day_number","id":"a4a5762c-23bd-4300-b428-bbf4c5c5d069","display-name":"Month-to-Date Day Number","default":"31","required":true},"granularity":{"id":"4b095973-b5cb-4c93-c12a-607019dd0fcd","name":"granularity","display-name":"Granularity","type":"text","required":true,"default":"week","values-source-type":"static-list","values-source-config":{"values":[["hour"],["day"],["week"],["month"],["quarter"],["year"]]}},"ACQUIRER":{"id":"bf51e367-ae6b-c409-020c-711538e8ce91","name":"ACQUIRER","display-name":"Acquirer","type":"dimension","dimension":["field",756224,null],"widget-type":"string/=","default":null},"CREATED_AT":{"id":"cf278b54-4f5f-9fbe-23f8-d1a9fdd227db","name":"CREATED_AT","display-name":"Created at","type":"dimension","dimension":["field",756256,null],"widget-type":"date/all-options","default":"past14days~","required":true},"CARD_GEOSCHEME":{"id":"cba17b07-3a17-4612-ce72-00eeddc3d21e","name":"CARD_GEOSCHEME","display-name":"Card geoscheme","type":"dimension","dimension":["field",756227,null],"widget-type":"string/=","required":false},"USER_NAME":{"id":"3e87e7a8-2e29-86a6-c39d-c0f3b183d924","name":"USER_NAME","display-name":"User name","type":"dimension","dimension":["field",756263,null],"widget-type":"string/contains","default":null},"STATUS":{"id":"ce1486eb-801e-0a23-1514-067b67d5aa73","name":"STATUS","display-name":"Status","type":"dimension","dimension":["field",756257,null],"widget-type":"string/=","default":null},"CARD_BRAND":{"id":"54185955-91b6-f816-51dc-f71b45b3fc83","name":"CARD_BRAND","display-name":"Card brand","type":"dimension","dimension":["field",756238,null],"widget-type":"string/=","default":null}}},"middleware":{"js-int-to-string?":true,"userland-query?":true,"add-default-userland-constraints?":true}},"average_execution_time":null,"status":"completed","context":"ad-hoc","row_count":3,"running_time":62}

📝 Validating Question 11/11
--------------------------------------------------
  🔍 Validating Question 4167: 2 Number of Antifraud rejected Transactions split by
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_granularity as (
    select distinct granularity
    from MD__FATPAY_DASHBOARD_HELP_TA...
    ❌ SQL Error detected in response
    📄 Response: {"data":{"rows":[["2025-06-09T00:00:00Z","PrimeFin Solutions inc.",70],["2025-06-16T00:00:00Z","Bitmart",43],["2025-06-23T00:00:00Z","BY",2],["2025-06-09T00:00:00Z","Ecom Center LTD",42],["2025-06-23T00:00:00Z","Whitebit",1],["2025-06-16T00:00:00Z","Mobilum tech",1],["2025-06-16T00:00:00Z","BY",54],["2025-06-16T00:00:00Z","Midway International N.V.",4],["2025-06-09T00:00:00Z","Credits",2],["2025-06-16T00:00:00Z","Exidna Enterprises LTD",3],["2025-06-16T00:00:00Z","ADV Project Ltd",214],["2025-06-09T00:00:00Z","Mobilum tech",88],["2025-06-09T00:00:00Z","others",63],["2025-06-09T00:00:00Z","Fastex",11],["2025-06-09T00:00:00Z","Innovate Wave Solutions Ltd",75],["2025-06-16T00:00:00Z","Fastex",9],["2025-06-09T00:00:00Z","Bingx",1340],["2025-06-09T00:00:00Z","ADV Project Ltd",237],["2025-06-16T00:00:00Z","Pionex",182],["2025-06-16T00:00:00Z","Whitebit",204],["2025-06-23T00:00:00Z","Pionex",9],["2025-06-09T00:00:00Z","BY",93],["2025-06-23T00:00:00Z","others",1],["2025-06-16T00:00:00Z","Finchpay",23],["2025-06-16T00:00:00Z","Bingx",1008],["2025-06-09T00:00:00Z","Finchpay",76],["2025-06-09T00:00:00Z","Phemex",177],["2025-06-09T00:00:00Z","Bitmart",58],["2025-06-16T00:00:00Z","others",19],["2025-06-09T00:00:00Z","Exidna Enterprises LTD",25],["2025-06-09T00:00:00Z","Midway International N.V.",89],["2025-06-09T00:00:00Z","Pionex",196],["2025-06-23T00:00:00Z","ADV Project Ltd",6],["2025-06-09T00:00:00Z","Darius Tech inc.",11],["2025-06-16T00:00:00Z","Innovate Wave Solutions Ltd",8],["2025-06-09T00:00:00Z","Whitebit",167],["2025-06-16T00:00:00Z","Phemex",179],["2025-06-16T00:00:00Z","Darius Tech inc.",12],["2025-06-09T00:00:00Z","Finaster Transfer LTD",15],["2025-06-09T00:00:00Z","Aifory LLC",1],["2025-06-23T00:00:00Z","Bitmart",2],["2025-06-23T00:00:00Z","Phemex",23],["2025-06-16T00:00:00Z","Credits",7],["2025-06-23T00:00:00Z","Exidna Enterprises LTD",1],["2025-06-23T00:00:00Z","Bingx",28],["2025-06-23T00:00:00Z","Midway International N.V.",1]],"cols":[{"display_name":"CREATED_AT","source":"native","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"name":"CREATED_AT","base_type":"type/DateTime","database_type":"DATETIME","effective_type":"type/DateTime"},{"display_name":"grouping_top_n","source":"native","field_ref":["field","grouping_top_n",{"base-type":"type/Text"}],"name":"grouping_top_n","base_type":"type/Text","database_type":"TEXT","effective_type":"type/Text"},{"display_name":"COUNT_TRANSACTIONS","source":"native","field_ref":["field","COUNT_TRANSACTIONS",{"base-type":"type/BigInteger"}],"name":"COUNT_TRANSACTIONS","base_type":"type/BigInteger","database_type":"BIGINT","effective_type":"type/BigInteger"}],"native_form":{"params":["week","Merchant","2025-06-09T00:00:00Z","2025-06-24T00:00:00Z","week"],"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where ?\n          AND granularity is not null\n),\n\nfiltered_groupby as (\n    select distinct fatpay_columns_groupby\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where (`MD__FATPAY_DASHBOARD_HELP_TABLE`.`FATPAY_COLUMNS_GROUPBY` = ?)\n          AND fatpay_columns_groupby is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        `MART__FATPAY`.`CREATED_AT` >= ? AND `MART__FATPAY`.`CREATED_AT` < ?\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and (ANTIFRAUD_STATUS = 'reject' \n            or ID_PROVIDER is null\n            )\n        and day(CREATED_AT) <= 31\n), \n\npre_top_n as (\n    select \n        CASE \n            WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n                THEN MART__FATPAY.CURRENCY\n            WHEN groupby.fatpay_columns_groupby = 'Status'\n                THEN MART__FATPAY.STATUS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'User Name'\n                THEN MART__FATPAY.USER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Merchant'\n                THEN MART__FATPAY.BUSINESS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Shop'\n                THEN MART__FATPAY.SHOP_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n                THEN MART__FATPAY.DRIVER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n                THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n                THEN MART__FATPAY.CARD_BANK\n            WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n                THEN MART__FATPAY.CARD_BRAND\n            WHEN groupby.fatpay_columns_groupby = 'Card Type'\n                THEN MART__FATPAY.CARD_TYPE\n            WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n                THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n            WHEN groupby.fatpay_columns_groupby = 'Card Country'\n                THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n            WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n                THEN MART__FATPAY.ANTIFRAUD_STATUS\n            WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n                THEN MART__FATPAY.IS_AFT\n            ELSE null \n        END as grouped,\n        row_number() over (order by sum(MART__FATPAY.AMOUNT_EUR) desc) as rn\n    from filtered_fatpay as MART__FATPAY\n    left join filtered_groupby as groupby\n        on 1 = 1\n    group by 1 \n),\n\ntop_n as (\n    select \n        grouped,\n        CASE \n            WHEN rn < 20 \n                THEN grouped\n        ELSE 'others' END AS grouping_top_n\n    from pre_top_n\n)\n\nselect \n    date_trunc(?, MART__FATPAY.CREATED_AT) as CREATED_AT,\n    top_n.grouping_top_n,\n    count(distinct ORDER_ID) as COUNT_TRANSACTIONS\nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\nleft join filtered_groupby as groupby\n    on 1 = 1\nleft join top_n\n    on top_n.grouped = CASE \n        WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n            THEN MART__FATPAY.CURRENCY\n        WHEN groupby.fatpay_columns_groupby = 'Status'\n            THEN MART__FATPAY.STATUS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'User Name'\n            THEN MART__FATPAY.USER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Merchant'\n            THEN MART__FATPAY.BUSINESS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Shop'\n            THEN MART__FATPAY.SHOP_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n            THEN MART__FATPAY.DRIVER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n            THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n            THEN MART__FATPAY.CARD_BANK\n        WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n            THEN MART__FATPAY.CARD_BRAND\n        WHEN groupby.fatpay_columns_groupby = 'Card Type'\n            THEN MART__FATPAY.CARD_TYPE\n        WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n            THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n        WHEN groupby.fatpay_columns_groupby = 'Card Country'\n            THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n        WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n            THEN MART__FATPAY.ANTIFRAUD_STATUS\n        WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n            THEN MART__FATPAY.IS_AFT\n        ELSE null \n    END\ngroup by 1, 2"},"results_timezone":"Etc/UTC","format-rows?":true,"results_metadata":{"columns":[{"display_name":"CREATED_AT","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"base_type":"type/DateTime","effective_type":"type/DateTime","name":"CREATED_AT","semantic_type":"type/CreationTimestamp","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/DateTime":{"earliest":"2025-06-09T00:00:00Z","latest":"2025-06-23T00:00:00Z"}}}},{"display_name":"grouping_top_n","field_ref":["field","grouping_top_n",{"base-type":"type/Text"}],"base_type":"type/Text","effective_type":"type/Text","name":"grouping_top_n","semantic_type":null,"fingerprint":{"global":{"distinct-count":20,"nil%":0.0},"type":{"type/Text":{"percent-json":0.0,"percent-url":0.0,"percent-email":0.0,"percent-state":0.0,"average-length":11.456521739130435}}}},{"display_name":"COUNT_TRANSACTIONS","field_ref":["field","COUNT_TRANSACTIONS",{"base-type":"type/BigInteger"}],"base_type":"type/BigInteger","effective_type":"type/BigInteger","name":"COUNT_TRANSACTIONS","semantic_type":null,"fingerprint":{"global":{"distinct-count":36,"nil%":0.0},"type":{"type/Number":{"min":1.0,"q1":6.0,"q3":89.0,"max":1340.0,"sd":243.06421886561918,"avg":106.08695652173913}}}}]},"insights":[{"previous-value":null,"unit":null,"offset":176989.4776786534,"last-change":null,"col":"COUNT_TRANSACTIONS","slope":-8.733482142861194,"last-value":1,"best-fit":["+",176989.4776786534,["*",-8.733482142861194,"x"]]}]},"cached":null,"database_id":16,"started_at":"2025-06-23T08:45:50.412662516Z","json_query":{"type":"native","database":16,"native":{"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{granularity}}\n          AND granularity is not null\n),\n\nfiltered_groupby as (\n    select distinct fatpay_columns_groupby\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{groupby}}\n          AND fatpay_columns_groupby is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        {{CREATED_AT}}\n        and {{CARD_GEOSCHEME}}\n        and {{CARD_COUNTRY}}\n        and {{STATUS}}\n        and {{BUSINESS_NAME}}\n        and {{USER_NAME}}\n        and {{FIAT_CURRENCY}}\n        and {{ACQUIRER}}\n        and {{CARD_BRAND}}\n        and {{PAYMENT_TERMINAL}}\n        and {{ERROR_GROUP}}\n        and {{ERROR_NAME}}\n        and {{HAS_ID_PROVIDER}}\n        and {{SHOP}}\n        and {{is_aft}}\n        and (ANTIFRAUD_STATUS = 'reject' \n            or ID_PROVIDER is null\n            )\n        and day(CREATED_AT) <= {{day_number}}\n), \n\npre_top_n as (\n    select \n        CASE \n            WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n                THEN MART__FATPAY.CURRENCY\n            WHEN groupby.fatpay_columns_groupby = 'Status'\n                THEN MART__FATPAY.STATUS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'User Name'\n                THEN MART__FATPAY.USER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Merchant'\n                THEN MART__FATPAY.BUSINESS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Shop'\n                THEN MART__FATPAY.SHOP_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n                THEN MART__FATPAY.DRIVER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n                THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n                THEN MART__FATPAY.CARD_BANK\n            WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n                THEN MART__FATPAY.CARD_BRAND\n            WHEN groupby.fatpay_columns_groupby = 'Card Type'\n                THEN MART__FATPAY.CARD_TYPE\n            WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n                THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n            WHEN groupby.fatpay_columns_groupby = 'Card Country'\n                THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n            WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n                THEN MART__FATPAY.ANTIFRAUD_STATUS\n            WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n                THEN MART__FATPAY.IS_AFT\n            ELSE null \n        END as grouped,\n        row_number() over (order by sum(MART__FATPAY.AMOUNT_EUR) desc) as rn\n    from filtered_fatpay as MART__FATPAY\n    left join filtered_groupby as groupby\n        on 1 = 1\n    group by 1 \n),\n\ntop_n as (\n    select \n        grouped,\n        CASE \n            WHEN rn < {{top_n}} \n                THEN grouped\n        ELSE 'others' END AS grouping_top_n\n    from pre_top_n\n)\n\nselect \n    date_trunc({{granularity}}, MART__FATPAY.CREATED_AT) as CREATED_AT,\n    top_n.grouping_top_n,\n    count(distinct ORDER_ID) as COUNT_TRANSACTIONS\nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\nleft join filtered_groupby as groupby\n    on 1 = 1\nleft join top_n\n    on top_n.grouped = CASE \n        WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n            THEN MART__FATPAY.CURRENCY\n        WHEN groupby.fatpay_columns_groupby = 'Status'\n            THEN MART__FATPAY.STATUS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'User Name'\n            THEN MART__FATPAY.USER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Merchant'\n            THEN MART__FATPAY.BUSINESS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Shop'\n            THEN MART__FATPAY.SHOP_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n            THEN MART__FATPAY.DRIVER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n            THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n            THEN MART__FATPAY.CARD_BANK\n        WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n            THEN MART__FATPAY.CARD_BRAND\n        WHEN groupby.fatpay_columns_groupby = 'Card Type'\n            THEN MART__FATPAY.CARD_TYPE\n        WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n            THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n        WHEN groupby.fatpay_columns_groupby = 'Card Country'\n            THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n        WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n            THEN MART__FATPAY.ANTIFRAUD_STATUS\n        WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n            THEN MART__FATPAY.IS_AFT\n        ELSE null \n    END\ngroup by 1, 2\n","template-tags":{"HAS_ID_PROVIDER":{"id":"6c842e6b-d712-3a5d-de59-a094ec3461e2","name":"HAS_ID_PROVIDER","display-name":"Has id provider","type":"dimension","dimension":["field",756250,null],"widget-type":"string/=","default":null},"top_n":{"type":"number","name":"top_n","id":"e346f91f-6d4a-4de6-babe-4ba03f92da5d","display-name":"Top N","default":"20","required":true},"CARD_COUNTRY":{"id":"29492df1-225c-ccb0-9a4e-272c5f987ac5","name":"CARD_COUNTRY","display-name":"Card country","type":"dimension","dimension":["field",756254,null],"widget-type":"string/=","default":null},"ERROR_GROUP":{"id":"bb7f9117-7da8-bc24-8190-7626f33e6af0","name":"ERROR_GROUP","display-name":"Error group","type":"dimension","dimension":["field",756269,null],"widget-type":"string/=","default":null},"FIAT_CURRENCY":{"id":"5cab7ad0-e021-f0c5-4e22-a66c43242330","name":"FIAT_CURRENCY","display-name":"Fiat currency","type":"dimension","dimension":["field",756268,null],"widget-type":"string/=","default":null},"is_aft":{"type":"dimension","name":"is_aft","id":"fca11a49-3520-4c9b-bb98-096dcfb7e543","display-name":"Is Aft","default":null,"dimension":["field",760549,null],"widget-type":"string/=","options":null},"ERROR_NAME":{"id":"4ed8b652-3c97-6a86-8a35-7a397b6f42ea","name":"ERROR_NAME","display-name":"Error name","type":"dimension","dimension":["field",756230,null],"widget-type":"string/contains","default":null},"PAYMENT_TERMINAL":{"id":"cd9daa34-226e-58e4-673d-7fd1179e7dee","name":"PAYMENT_TERMINAL","display-name":"Payment terminal","type":"dimension","dimension":["field",756239,null],"widget-type":"string/=","default":null},"SHOP":{"id":"07a15b6a-eb56-1180-333f-0cc8573576ea","name":"SHOP","display-name":"Shop","type":"dimension","dimension":["field",756245,null],"widget-type":"string/="},"BUSINESS_NAME":{"id":"1a7ca3c6-ac96-dcc3-dbdc-20e1d3c55320","name":"BUSINESS_NAME","display-name":"Business name","type":"dimension","dimension":["field",756258,null],"widget-type":"string/=","default":null},"day_number":{"type":"number","name":"day_number","id":"2c8c1e76-8b0f-44da-b22b-4fd273d199db","display-name":"Month-to-Date Day Number","default":"31","required":true},"granularity":{"id":"37799d21-54a5-2233-9de5-517db3c5bab0","name":"granularity","display-name":"Granularity","type":"text","required":true,"default":"week","values-source-type":"static-list","values-source-config":{"values":[["hour"],["day"],["week"],["month"],["quarter"],["year"]]}},"ACQUIRER":{"id":"0add554f-79fc-6685-f405-66c92af72b79","name":"ACQUIRER","display-name":"Acquirer","type":"dimension","dimension":["field",756224,null],"widget-type":"string/=","default":null},"groupby":{"id":"e17dc612-04b6-9c56-db9b-df98419a776c","name":"groupby","display-name":"Groupby","type":"dimension","default":["Merchant"],"dimension":["field",756658,null],"widget-type":"string/=","required":true},"CREATED_AT":{"id":"7e66dcc1-f9af-d388-5804-ea74427d78fb","name":"CREATED_AT","display-name":"Created at","type":"dimension","dimension":["field",756256,null],"widget-type":"date/all-options","default":"past14days~","required":true},"CARD_GEOSCHEME":{"id":"0d642257-5a4e-bc22-1afa-998bdf910c28","name":"CARD_GEOSCHEME","display-name":"Card geoscheme","type":"dimension","dimension":["field",756227,null],"widget-type":"string/=","default":null},"USER_NAME":{"id":"0ed73475-19ec-3399-0857-ad2c1e797d73","name":"USER_NAME","display-name":"User name","type":"dimension","dimension":["field",756263,null],"widget-type":"string/contains","default":null},"STATUS":{"id":"f05b9ffc-bfb1-f94b-4509-3fa683d56e44","name":"STATUS","display-name":"Status","type":"dimension","dimension":["field",756257,null],"widget-type":"string/=","default":null},"CARD_BRAND":{"id":"45d19436-bb36-cae1-7b66-470806737fb6","name":"CARD_BRAND","display-name":"Card brand","type":"dimension","dimension":["field",756238,null],"widget-type":"string/=","default":null}}},"middleware":{"js-int-to-string?":true,"userland-query?":true,"add-default-userland-constraints?":true}},"average_execution_time":null,"status":"completed","context":"ad-hoc","row_count":46,"running_time":139}

🎉 Validation Summary:
✅ Successfully validated: 0/11 questions
⚠️  Some questions have issues. Migration may need fixes.
