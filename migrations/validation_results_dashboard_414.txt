
🔍 Validating migration results...
============================================================
📊 Validating 7 questions

📝 Validating Question 1/7
--------------------------------------------------
  🔍 Validating Question 4157: 1 Revenue, Acquiring Commission, GMV EUR
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_granularity as (
    select granularity
    from MD__FATPAY_DASHBOARD_HELP_TABLE
    w...
    ❌ SQL Error detected in response
    📄 Response: {"data":{"rows":[["2025-06-16T00:00:00Z",374327.521608697,114498.48443740497,259829.0371712944,571003.5428605193,196676.02125182052],["2025-06-23T00:00:00Z",15798.758911754521,0.0,15798.758911754521,20879.552095247538,5080.793183493017],["2025-06-09T00:00:00Z",443295.4845483355,225096.79302190404,218198.69152643404,642904.4009143285,199608.9163659912]],"cols":[{"display_name":"CREATED_AT","source":"native","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"name":"CREATED_AT","base_type":"type/DateTime","database_type":"DATETIME","effective_type":"type/DateTime"},{"display_name":"Acquiring Commission Total","source":"native","field_ref":["field","Acquiring Commission Total",{"base-type":"type/Float"}],"name":"Acquiring Commission Total","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"},{"display_name":"Acquiring Commission: Fact","source":"native","field_ref":["field","Acquiring Commission: Fact",{"base-type":"type/Float"}],"name":"Acquiring Commission: Fact","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"},{"display_name":"Acquiring Commission: Forecast","source":"native","field_ref":["field","Acquiring Commission: Forecast",{"base-type":"type/Float"}],"name":"Acquiring Commission: Forecast","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"},{"display_name":"Revenue","source":"native","field_ref":["field","Revenue",{"base-type":"type/Float"}],"name":"Revenue","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"},{"display_name":"GMV","source":"native","field_ref":["field","GMV",{"base-type":"type/Float"}],"name":"GMV","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"}],"native_form":{"params":["week","2025-06-09T00:00:00Z","2025-06-24T00:00:00Z","week"],"query":"with filtered_granularity as (\n    select granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where ?\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select \n        CREATED_AT,\n        fee_acquirer_eur,\n        fee_acquirer_is_exact,\n        calc_fee_mercuryo_eur,\n        calc_gmv_eur,\n        amount_eur\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        `MART__FATPAY`.`CREATED_AT` >= ? AND `MART__FATPAY`.`CREATED_AT` < ?\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and day(CREATED_AT) <= 31\n)\n\nselect \n    date_trunc(?, ff.CREATED_AT) as CREATED_AT,\n    sum(ff.fee_acquirer_eur) as 'Acquiring Commission Total',\n    sum(case when ff.fee_acquirer_is_exact = 'exact' then ff.fee_acquirer_eur end) as 'Acquiring Commission: Fact',\n    sum(case when ff.fee_acquirer_is_exact <> 'exact' then ff.fee_acquirer_eur end) as 'Acquiring Commission: Forecast',\n    sum(ff.calc_fee_mercuryo_eur) as 'Revenue',\n    sum(ff.calc_gmv_eur) as GMV\nfrom filtered_fatpay as ff\nleft join filtered_granularity as fg\n    on 1 = 1\ngroup by 1"},"results_timezone":"Etc/UTC","format-rows?":true,"results_metadata":{"columns":[{"display_name":"CREATED_AT","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"base_type":"type/DateTime","effective_type":"type/DateTime","name":"CREATED_AT","semantic_type":"type/CreationTimestamp","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/DateTime":{"earliest":"2025-06-09T00:00:00Z","latest":"2025-06-23T00:00:00Z"}}}},{"display_name":"Acquiring Commission Total","field_ref":["field","Acquiring Commission Total",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"Acquiring Commission Total","semantic_type":null,"fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/Number":{"min":15798.758911754521,"q1":105430.94958599014,"q3":426053.4938134259,"max":443295.4845483355,"sd":229511.40277520055,"avg":277807.255022929}}}},{"display_name":"Acquiring Commission: Fact","field_ref":["field","Acquiring Commission: Fact",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"Acquiring Commission: Fact","semantic_type":null,"fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/Number":{"min":0.0,"q1":28624.621109351243,"q3":197447.21587577928,"max":225096.79302190404,"sd":112554.027788851,"avg":113198.42581976968}}}},{"display_name":"Acquiring Commission: Forecast","field_ref":["field","Acquiring Commission: Forecast",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"Acquiring Commission: Forecast","semantic_type":null,"fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/Number":{"min":15798.758911754521,"q1":66398.74206542439,"q3":249421.45076007931,"max":259829.0371712944,"sd":130543.47622431247,"avg":164608.82920316097}}}},{"display_name":"Revenue","field_ref":["field","Revenue",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"Revenue","semantic_type":null,"fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/Number":{"min":20879.552095247538,"q1":158410.54978656548,"q3":624929.1864008761,"max":642904.4009143285,"sd":340274.65650382667,"avg":411595.8319566984}}}},{"display_name":"GMV","field_ref":["field","GMV",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"GMV","semantic_type":null,"fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/Number":{"min":5080.793183493017,"q1":52979.60020057489,"q3":198875.69258744852,"max":199608.9163659912,"sd":111473.85642772206,"avg":133788.57693376826}}}}]},"insights":[{"previous-value":null,"unit":null,"offset":6.187739628099476E8,"last-change":null,"col":"Acquiring Commission Total","slope":-30535.480402612924,"last-value":443295.4845483355,"best-fit":["+",6.187739628099476E8,["*",-30535.480402612924,"x"]]},{"previous-value":null,"unit":null,"offset":3.257800229014388E8,"last-change":null,"col":"Acquiring Commission: Fact","slope":-16078.342358707432,"last-value":225096.79302190404,"best-fit":["+",3.257800229014388E8,["*",-16078.342358707432,"x"]]},{"previous-value":null,"unit":null,"offset":2.929939399085127E8,"last-change":null,"col":"Acquiring Commission: Forecast","slope":-14457.13804390568,"last-value":218198.69152643404,"best-fit":["+",2.929939399085127E8,["*",-14457.13804390568,"x"]]},{"previous-value":null,"unit":null,"offset":9.003482610341344E8,"last-change":null,"col":"Revenue","slope":-44430.346344220074,"last-value":642904.4009143285,"best-fit":["+",9.003482610341344E8,["*",-44430.346344220074,"x"]]},{"previous-value":null,"unit":null,"offset":2.815742982241838E8,"last-change":null,"col":"GMV","slope":-13894.865941607013,"last-value":199608.9163659912,"best-fit":["+",2.815742982241838E8,["*",-13894.865941607013,"x"]]}]},"cached":null,"database_id":16,"started_at":"2025-06-23T08:41:53.788464685Z","json_query":{"type":"native","database":16,"native":{"query":"with filtered_granularity as (\n    select granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{granularity}}\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select \n        CREATED_AT,\n        fee_acquirer_eur,\n        fee_acquirer_is_exact,\n        calc_fee_mercuryo_eur,\n        calc_gmv_eur,\n        amount_eur\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        {{CREATED_AT}}\n        and {{CARD_GEOSCHEME}}\n        and {{CARD_COUNTRY}}\n        and {{STATUS}}\n        and {{BUSINESS_NAME}}\n        and {{USER_NAME}}\n        and {{FIAT_CURRENCY}}\n        and {{ACQUIRER}}\n        and {{CARD_BRAND}}\n        and {{PAYMENT_TERMINAL}}\n        and {{ERROR_GROUP}}\n        and {{ERROR_NAME}}\n        and {{HAS_ID_PROVIDER}}\n        and {{SHOP}}\n        and {{is_aft}}\n        and day(CREATED_AT) <= {{day_number}}\n)\n\nselect \n    date_trunc({{granularity}}, ff.CREATED_AT) as CREATED_AT,\n    sum(ff.fee_acquirer_eur) as 'Acquiring Commission Total',\n    sum(case when ff.fee_acquirer_is_exact = 'exact' then ff.fee_acquirer_eur end) as 'Acquiring Commission: Fact',\n    sum(case when ff.fee_acquirer_is_exact <> 'exact' then ff.fee_acquirer_eur end) as 'Acquiring Commission: Forecast',\n    sum(ff.calc_fee_mercuryo_eur) as 'Revenue',\n    sum(ff.calc_gmv_eur) as GMV\nfrom filtered_fatpay as ff\nleft join filtered_granularity as fg\n    on 1 = 1\ngroup by 1 ","template-tags":{"HAS_ID_PROVIDER":{"id":"595b93e0-5e69-b486-5d36-874e60934ac8","name":"HAS_ID_PROVIDER","display-name":"Has id provider","type":"dimension","dimension":["field",756250,null],"widget-type":"string/=","default":null},"CARD_COUNTRY":{"id":"716a10f7-f987-2208-4429-4b0598b2432e","name":"CARD_COUNTRY","display-name":"Card country","type":"dimension","dimension":["field",756254,null],"widget-type":"string/=","required":false},"ERROR_GROUP":{"id":"2287bcf2-879d-a509-ecef-f2f375ebe882","name":"ERROR_GROUP","display-name":"Error group","type":"dimension","dimension":["field",756269,null],"widget-type":"string/=","default":null},"FIAT_CURRENCY":{"id":"e734ceda-ef86-ce9c-358a-69566a4c0214","name":"FIAT_CURRENCY","display-name":"Fiat currency","type":"dimension","dimension":["field",756268,null],"widget-type":"string/=","default":null},"is_aft":{"type":"dimension","name":"is_aft","id":"464a34b9-c0e5-495b-ad9e-763a1ee936ff","display-name":"Is Aft","default":null,"dimension":["field",760549,null],"widget-type":"string/=","options":null},"ERROR_NAME":{"id":"0f8f7ec3-37a6-f67c-8319-7d255e39e841","name":"ERROR_NAME","display-name":"Error name","type":"dimension","dimension":["field",756230,null],"widget-type":"string/contains","default":null},"PAYMENT_TERMINAL":{"id":"698f65a5-572d-3286-034e-151b59125736","name":"PAYMENT_TERMINAL","display-name":"Payment terminal","type":"dimension","dimension":["field",756239,null],"widget-type":"string/=","default":null},"SHOP":{"id":"5d2d1b0f-228a-3616-39a6-0f609e46ba0a","name":"SHOP","display-name":"Shop","type":"dimension","dimension":["field",756245,null],"widget-type":"string/="},"BUSINESS_NAME":{"id":"bd69ce89-a3be-5f0d-90ef-0ad9b70f116e","name":"BUSINESS_NAME","display-name":"Business name","type":"dimension","dimension":["field",756258,null],"widget-type":"string/=","default":null},"day_number":{"type":"number","name":"day_number","id":"90d56bda-2d8f-48a9-9483-3982351f343c","display-name":"Month-to-Date Day Number","default":"31","required":true},"granularity":{"id":"4b095973-b5cb-4c93-c12a-607019dd0fcd","name":"granularity","display-name":"Granularity","type":"text","required":true,"default":"week","values-source-type":"static-list","values-source-config":{"values":[["hour"],["day"],["week"],["month"],["quarter"],["year"]]}},"ACQUIRER":{"id":"bf51e367-ae6b-c409-020c-711538e8ce91","name":"ACQUIRER","display-name":"Acquirer","type":"dimension","dimension":["field",756224,null],"widget-type":"string/=","default":null},"CREATED_AT":{"id":"cf278b54-4f5f-9fbe-23f8-d1a9fdd227db","name":"CREATED_AT","display-name":"Created at","type":"dimension","dimension":["field",756256,null],"widget-type":"date/all-options","default":"past14days~"},"CARD_GEOSCHEME":{"id":"cba17b07-3a17-4612-ce72-00eeddc3d21e","name":"CARD_GEOSCHEME","display-name":"Card geoscheme","type":"dimension","dimension":["field",756227,null],"widget-type":"string/=","required":false},"USER_NAME":{"id":"3e87e7a8-2e29-86a6-c39d-c0f3b183d924","name":"USER_NAME","display-name":"User name","type":"dimension","dimension":["field",756263,null],"widget-type":"string/contains","default":null},"STATUS":{"id":"ce1486eb-801e-0a23-1514-067b67d5aa73","name":"STATUS","display-name":"Status","type":"dimension","dimension":["field",756257,null],"widget-type":"string/=","default":null},"CARD_BRAND":{"id":"54185955-91b6-f816-51dc-f71b45b3fc83","name":"CARD_BRAND","display-name":"Card brand","type":"dimension","dimension":["field",756238,null],"widget-type":"string/=","default":null}}},"middleware":{"js-int-to-string?":true,"userland-query?":true,"add-default-userland-constraints?":true}},"average_execution_time":null,"status":"completed","context":"ad-hoc","row_count":3,"running_time":76}

📝 Validating Question 2/7
--------------------------------------------------
  🔍 Validating Question 4155: 1 Number of Transactions
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_granularity as (
    select granularity
    from MD__FATPAY_DASHBOARD_HELP_TABLE
    w...
    ❌ SQL Error detected in response
    📄 Response: {"data":{"rows":[["2025-06-09T00:00:00Z","transactions",210591],["2025-06-16T00:00:00Z","transactions",227110],["2025-06-23T00:00:00Z","transactions",6015]],"cols":[{"display_name":"CREATED_AT","source":"native","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"name":"CREATED_AT","base_type":"type/DateTime","database_type":"DATETIME","effective_type":"type/DateTime"},{"display_name":"TT","source":"native","field_ref":["field","TT",{"base-type":"type/Text"}],"name":"TT","base_type":"type/Text","database_type":"VARCHAR","effective_type":"type/Text"},{"display_name":"COUNT_TRANSACTIONS","source":"native","field_ref":["field","COUNT_TRANSACTIONS",{"base-type":"type/BigInteger"}],"name":"COUNT_TRANSACTIONS","base_type":"type/BigInteger","database_type":"BIGINT","effective_type":"type/BigInteger"}],"native_form":{"params":["week","2025-06-09T00:00:00Z","2025-06-24T00:00:00Z","week"],"query":"with filtered_granularity as (\n    select granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where ?\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select \n        CREATED_AT,\n        AMOUNT_EUR,\n        ORDER_ID\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        `MART__FATPAY`.`CREATED_AT` >= ? AND `MART__FATPAY`.`CREATED_AT` < ?\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and day(CREATED_AT) <= 31\n)\n\nselect \n    date_trunc(?, ff.CREATED_AT) as CREATED_AT,\n    'transactions' as TT,\n    count(distinct ORDER_ID) as COUNT_TRANSACTIONS\nfrom filtered_fatpay as ff\nleft join filtered_granularity as fg\n    on 1 = 1\ngroup by 1, 2"},"results_timezone":"Etc/UTC","format-rows?":true,"results_metadata":{"columns":[{"display_name":"CREATED_AT","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"base_type":"type/DateTime","effective_type":"type/DateTime","name":"CREATED_AT","semantic_type":"type/CreationTimestamp","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/DateTime":{"earliest":"2025-06-09T00:00:00Z","latest":"2025-06-23T00:00:00Z"}}}},{"display_name":"TT","field_ref":["field","TT",{"base-type":"type/Text"}],"base_type":"type/Text","effective_type":"type/Text","name":"TT","semantic_type":null,"fingerprint":{"global":{"distinct-count":1,"nil%":0.0},"type":{"type/Text":{"percent-json":0.0,"percent-url":0.0,"percent-email":0.0,"percent-state":0.0,"average-length":12.0}}}},{"display_name":"COUNT_TRANSACTIONS","field_ref":["field","COUNT_TRANSACTIONS",{"base-type":"type/BigInteger"}],"base_type":"type/BigInteger","effective_type":"type/BigInteger","name":"COUNT_TRANSACTIONS","semantic_type":null,"fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/Number":{"min":6015.0,"q1":57159.0,"q3":222980.25,"max":227110.0,"sd":123157.90417319277,"avg":147905.33333333334}}}}]},"insights":[{"previous-value":227110,"unit":"week","offset":2.9612553961904764E8,"last-change":-0.9735150367663247,"col":"COUNT_TRANSACTIONS","slope":-14612.57142857143,"last-value":6015,"best-fit":["+",2.9612553961904764E8,["*",-14612.57142857143,"x"]]}]},"cached":null,"database_id":16,"started_at":"2025-06-23T08:41:55.055460902Z","json_query":{"type":"native","database":16,"native":{"query":"with filtered_granularity as (\n    select granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{granularity}}\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select \n        CREATED_AT,\n        AMOUNT_EUR,\n        ORDER_ID\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        {{CREATED_AT}}\n        and {{CARD_GEOSCHEME}}\n        and {{CARD_COUNTRY}}\n        and {{STATUS}}\n        and {{BUSINESS_NAME}}\n        and {{USER_NAME}}\n        and {{FIAT_CURRENCY}}\n        and {{ACQUIRER}}\n        and {{CARD_BRAND}}\n        and {{PAYMENT_TERMINAL}}\n        and {{ERROR_GROUP}}\n        and {{ERROR_NAME}}\n        and {{HAS_ID_PROVIDER}}\n        and {{SHOP}}\n        and {{is_aft}}\n        and day(CREATED_AT) <= {{day_number}}\n)\n\nselect \n    date_trunc({{granularity}}, ff.CREATED_AT) as CREATED_AT,\n    'transactions' as TT,\n    count(distinct ORDER_ID) as COUNT_TRANSACTIONS\nfrom filtered_fatpay as ff\nleft join filtered_granularity as fg\n    on 1 = 1\ngroup by 1, 2 ","template-tags":{"HAS_ID_PROVIDER":{"id":"3ee32b32-11c5-7dfd-a4b0-fd1cbeefad9e","name":"HAS_ID_PROVIDER","display-name":"Has id provider","type":"dimension","dimension":["field",756250,null],"widget-type":"string/=","default":null},"CARD_COUNTRY":{"id":"716a10f7-f987-2208-4429-4b0598b2432e","name":"CARD_COUNTRY","display-name":"Card country","type":"dimension","dimension":["field",756254,null],"widget-type":"string/=","required":false},"ERROR_GROUP":{"id":"2287bcf2-879d-a509-ecef-f2f375ebe882","name":"ERROR_GROUP","display-name":"Error group","type":"dimension","dimension":["field",756269,null],"widget-type":"string/=","default":null},"FIAT_CURRENCY":{"id":"e734ceda-ef86-ce9c-358a-69566a4c0214","name":"FIAT_CURRENCY","display-name":"Fiat currency","type":"dimension","dimension":["field",756268,null],"widget-type":"string/=","default":null},"is_aft":{"type":"dimension","name":"is_aft","id":"1eeb1a0d-52ee-46cb-804a-40fddbd08140","display-name":"Is Aft","default":null,"dimension":["field",760549,null],"widget-type":"string/=","options":null},"ERROR_NAME":{"id":"0f8f7ec3-37a6-f67c-8319-7d255e39e841","name":"ERROR_NAME","display-name":"Error name","type":"dimension","dimension":["field",756230,null],"widget-type":"string/contains","default":null},"PAYMENT_TERMINAL":{"id":"698f65a5-572d-3286-034e-151b59125736","name":"PAYMENT_TERMINAL","display-name":"Payment terminal","type":"dimension","dimension":["field",756239,null],"widget-type":"string/=","default":null},"SHOP":{"id":"934280b5-10eb-a429-15e6-bb62fef9356f","name":"SHOP","display-name":"Shop","type":"dimension","dimension":["field",756245,null],"widget-type":"string/="},"BUSINESS_NAME":{"id":"bd69ce89-a3be-5f0d-90ef-0ad9b70f116e","name":"BUSINESS_NAME","display-name":"Business name","type":"dimension","dimension":["field",756258,null],"widget-type":"string/=","default":null},"day_number":{"type":"number","name":"day_number","id":"8104a70f-a01c-4d3d-aa49-2f9194097d17","display-name":"Month-to-Date Day Number","default":"31","required":true},"granularity":{"id":"4b095973-b5cb-4c93-c12a-607019dd0fcd","name":"granularity","display-name":"Granularity","type":"text","required":true,"default":"week","values-source-type":"static-list","values-source-config":{"values":[["hour"],["day"],["week"],["month"],["quarter"],["year"]]}},"ACQUIRER":{"id":"bf51e367-ae6b-c409-020c-711538e8ce91","name":"ACQUIRER","display-name":"Acquirer","type":"dimension","dimension":["field",756224,null],"widget-type":"string/=","default":null},"CREATED_AT":{"id":"cf278b54-4f5f-9fbe-23f8-d1a9fdd227db","name":"CREATED_AT","display-name":"Created at","type":"dimension","dimension":["field",756256,null],"widget-type":"date/all-options","default":"past14days~"},"CARD_GEOSCHEME":{"id":"cba17b07-3a17-4612-ce72-00eeddc3d21e","name":"CARD_GEOSCHEME","display-name":"Card geoscheme","type":"dimension","dimension":["field",756227,null],"widget-type":"string/=","required":false},"USER_NAME":{"id":"3e87e7a8-2e29-86a6-c39d-c0f3b183d924","name":"USER_NAME","display-name":"User name","type":"dimension","dimension":["field",756263,null],"widget-type":"string/contains","default":null},"STATUS":{"id":"ce1486eb-801e-0a23-1514-067b67d5aa73","name":"STATUS","display-name":"Status","type":"dimension","dimension":["field",756257,null],"widget-type":"string/=","default":null},"CARD_BRAND":{"id":"54185955-91b6-f816-51dc-f71b45b3fc83","name":"CARD_BRAND","display-name":"Card brand","type":"dimension","dimension":["field",756238,null],"widget-type":"string/=","default":null}}},"middleware":{"js-int-to-string?":true,"userland-query?":true,"add-default-userland-constraints?":true}},"average_execution_time":null,"status":"completed","context":"ad-hoc","row_count":3,"running_time":60}

📝 Validating Question 3/7
--------------------------------------------------
  🔍 Validating Question 4156: 1 Number of Transactions split
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_granularity as (
    select distinct granularity
    from MD__FATPAY_DASHBOARD_HELP_TA...
    ❌ SQL Error detected in response
    📄 Response: {"data":{"rows":[["2025-06-23T00:00:00Z","Golden Way Payments LTD",151],["2025-06-09T00:00:00Z","Europe/ROW  Domus Payment Solutions LTD",5659],["2025-06-09T00:00:00Z","others",11465],["2025-06-09T00:00:00Z","Exidna Enterprises LTD",10713],["2025-06-16T00:00:00Z","others",27028],["2025-06-09T00:00:00Z","Phemex",1642],["2025-06-16T00:00:00Z","Ecom Center LTD",5774],["2025-06-16T00:00:00Z","Whitebit",2486],["2025-06-09T00:00:00Z","ADV Project Ltd",6503],["2025-06-16T00:00:00Z","Pionex",5068],["2025-06-09T00:00:00Z","Bingx",17366],["2025-06-09T00:00:00Z","KURTLEY QURESHI CONSULTANTS LIMITED",23115],["2025-06-23T00:00:00Z","Pionex",174],["2025-06-16T00:00:00Z","KURTLEY QURESHI CONSULTANTS LIMITED",16660],["2025-06-09T00:00:00Z","Finaster Transfer LTD",9732],["2025-06-09T00:00:00Z","Whitebit",2852],["2025-06-16T00:00:00Z","Darius Tech inc.",7563],["2025-06-16T00:00:00Z","Phemex",2001],["2025-06-09T00:00:00Z","Aifory LLC",12923],["2025-06-09T00:00:00Z","Venson Ltd",14699],["2025-06-09T00:00:00Z","Mobilum tech",19902],["2025-06-16T00:00:00Z","ADV Project Ltd",6230],["2025-06-23T00:00:00Z","Ecom Center LTD",121],["2025-06-16T00:00:00Z","Europe/ROW  Domus Payment Solutions LTD",6166],["2025-06-23T00:00:00Z","Bro Fintech LTD",9],["2025-06-09T00:00:00Z","Midway International N.V.",12455],["2025-06-09T00:00:00Z","Pionex",4656],["2025-06-23T00:00:00Z","Venson Ltd",157],["2025-06-16T00:00:00Z","Venson Ltd",13418],["2025-06-23T00:00:00Z","Payinter LTD",110],["2025-06-23T00:00:00Z","Aifory LLC",53],["2025-06-23T00:00:00Z","Europe/ROW  Domus Payment Solutions LTD",367],["2025-06-09T00:00:00Z","Darius Tech inc.",8585],["2025-06-23T00:00:00Z","Darius Tech inc.",143],["2025-06-23T00:00:00Z","ADV Project Ltd",183],["2025-06-16T00:00:00Z","Exidna Enterprises LTD",14032],["2025-06-09T00:00:00Z","Golden Way Payments LTD",5108],["2025-06-23T00:00:00Z","Finaster Transfer LTD",260],["2025-06-16T00:00:00Z","Golden Way Payments LTD",5943],["2025-06-16T00:00:00Z","Bro Fintech LTD",5044],["2025-06-23T00:00:00Z","Exidna Enterprises LTD",518],["2025-06-23T00:00:00Z","Phemex",65],["2025-06-23T00:00:00Z","Mobilum tech",650],["2025-06-16T00:00:00Z","Mobilum tech",20129],["2025-06-09T00:00:00Z","Ecom Center LTD",5960],["2025-06-23T00:00:00Z","KURTLEY QURESHI CONSULTANTS LIMITED",365],["2025-06-23T00:00:00Z","Whitebit",48],["2025-06-09T00:00:00Z","Bro Fintech LTD",6487],["2025-06-16T00:00:00Z","Finaster Transfer LTD",11617],["2025-06-16T00:00:00Z","Bingx",16032],["2025-06-09T00:00:00Z","Payinter LTD",3495],["2025-06-09T00:00:00Z","BY",27274],["2025-06-23T00:00:00Z","others",648],["2025-06-23T00:00:00Z","BY",774],["2025-06-16T00:00:00Z","BY",26893],["2025-06-16T00:00:00Z","Aifory LLC",17993],["2025-06-16T00:00:00Z","Midway International N.V.",12979],["2025-06-23T00:00:00Z","Bingx",557],["2025-06-16T00:00:00Z","Payinter LTD",4054],["2025-06-23T00:00:00Z","Midway International N.V.",662]],"cols":[{"display_name":"CREATED_AT","source":"native","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"name":"CREATED_AT","base_type":"type/DateTime","database_type":"DATETIME","effective_type":"type/DateTime"},{"display_name":"grouping_top_n","source":"native","field_ref":["field","grouping_top_n",{"base-type":"type/Text"}],"name":"grouping_top_n","base_type":"type/Text","database_type":"TEXT","effective_type":"type/Text"},{"display_name":"COUNT_TRANSACTIONS","source":"native","field_ref":["field","COUNT_TRANSACTIONS",{"base-type":"type/BigInteger"}],"name":"COUNT_TRANSACTIONS","base_type":"type/BigInteger","database_type":"BIGINT","effective_type":"type/BigInteger"}],"native_form":{"params":["week","Merchant","2025-06-09T00:00:00Z","2025-06-24T00:00:00Z","week"],"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where ?\n          AND granularity is not null\n),\n\nfiltered_groupby as (\n    select distinct fatpay_columns_groupby\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where (`MD__FATPAY_DASHBOARD_HELP_TABLE`.`FATPAY_COLUMNS_GROUPBY` = ?)\n          AND fatpay_columns_groupby is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        `MART__FATPAY`.`CREATED_AT` >= ? AND `MART__FATPAY`.`CREATED_AT` < ?\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and day(CREATED_AT) <= 31\n),\n\npre_top_n as (\n    select \n        CASE \n            WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n                THEN MART__FATPAY.CURRENCY\n            WHEN groupby.fatpay_columns_groupby = 'Status'\n                THEN MART__FATPAY.STATUS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'User Name'\n                THEN MART__FATPAY.USER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Merchant'\n                THEN MART__FATPAY.BUSINESS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Shop'\n                THEN MART__FATPAY.SHOP_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n                THEN MART__FATPAY.DRIVER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n                THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n                THEN MART__FATPAY.CARD_BANK\n            WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n                THEN MART__FATPAY.CARD_BRAND\n            WHEN groupby.fatpay_columns_groupby = 'Card Type'\n                THEN MART__FATPAY.CARD_TYPE\n            WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n                THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n            WHEN groupby.fatpay_columns_groupby = 'Card Country'\n                THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n            WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n                THEN MART__FATPAY.ANTIFRAUD_STATUS\n            WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n                THEN MART__FATPAY.IS_AFT\n            ELSE null \n        END as grouped,\n        row_number() over (order by sum(MART__FATPAY.AMOUNT_EUR) desc) as rn\n    from filtered_fatpay as MART__FATPAY\n    left join filtered_groupby as groupby\n        on 1 = 1\n    group by 1 \n),\n\ntop_n as (\n    select \n        grouped,\n        CASE \n            WHEN rn < 20 \n                THEN grouped\n        ELSE 'others' END AS grouping_top_n\n    from pre_top_n\n)\n\nselect \n    date_trunc(?, MART__FATPAY.CREATED_AT) as CREATED_AT,\n    top_n.grouping_top_n,\n    count(distinct ORDER_ID) as COUNT_TRANSACTIONS  \nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\nleft join filtered_groupby as groupby\n    on 1 = 1\nleft join top_n\n    on top_n.grouped = CASE \n        WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n            THEN MART__FATPAY.CURRENCY\n        WHEN groupby.fatpay_columns_groupby = 'Status'\n            THEN MART__FATPAY.STATUS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'User Name'\n            THEN MART__FATPAY.USER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Merchant'\n            THEN MART__FATPAY.BUSINESS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Shop'\n            THEN MART__FATPAY.SHOP_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n            THEN MART__FATPAY.DRIVER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n            THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n            THEN MART__FATPAY.CARD_BANK\n        WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n            THEN MART__FATPAY.CARD_BRAND\n        WHEN groupby.fatpay_columns_groupby = 'Card Type'\n            THEN MART__FATPAY.CARD_TYPE\n        WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n            THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n        WHEN groupby.fatpay_columns_groupby = 'Card Country'\n            THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n        WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n            THEN MART__FATPAY.ANTIFRAUD_STATUS\n        WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n            THEN MART__FATPAY.IS_AFT\n        ELSE null \n    END\ngroup by 1, 2"},"results_timezone":"Etc/UTC","format-rows?":true,"results_metadata":{"columns":[{"display_name":"CREATED_AT","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"base_type":"type/DateTime","effective_type":"type/DateTime","name":"CREATED_AT","semantic_type":"type/CreationTimestamp","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/DateTime":{"earliest":"2025-06-09T00:00:00Z","latest":"2025-06-23T00:00:00Z"}}}},{"display_name":"grouping_top_n","field_ref":["field","grouping_top_n",{"base-type":"type/Text"}],"base_type":"type/Text","effective_type":"type/Text","name":"grouping_top_n","semantic_type":null,"fingerprint":{"global":{"distinct-count":20,"nil%":0.0},"type":{"type/Text":{"percent-json":0.0,"percent-url":0.0,"percent-email":0.0,"percent-state":0.0,"average-length":15.15}}}},{"display_name":"COUNT_TRANSACTIONS","field_ref":["field","COUNT_TRANSACTIONS",{"base-type":"type/BigInteger"}],"base_type":"type/BigInteger","effective_type":"type/BigInteger","name":"COUNT_TRANSACTIONS","semantic_type":null,"fingerprint":{"global":{"distinct-count":60,"nil%":0.0},"type":{"type/Number":{"min":9.0,"q1":537.5,"q3":12689.0,"max":27274.0,"sd":7757.983913508709,"avg":7395.266666666666}}}}]},"insights":[{"previous-value":4054,"unit":"week","offset":1.4806276980954297E7,"last-change":-0.8367044893931919,"col":"COUNT_TRANSACTIONS","slope":-730.628571428666,"last-value":662,"best-fit":["+",1.4806276980954297E7,["*",-730.628571428666,"x"]]}]},"cached":null,"database_id":16,"started_at":"2025-06-23T08:41:56.306404949Z","json_query":{"type":"native","database":16,"native":{"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{granularity}}\n          AND granularity is not null\n),\n\nfiltered_groupby as (\n    select distinct fatpay_columns_groupby\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{groupby}}\n          AND fatpay_columns_groupby is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        {{CREATED_AT}}\n        and {{CARD_GEOSCHEME}}\n        and {{CARD_COUNTRY}}\n        and {{STATUS}}\n        and {{BUSINESS_NAME}}\n        and {{USER_NAME}}\n        and {{FIAT_CURRENCY}}\n        and {{ACQUIRER}}\n        and {{CARD_BRAND}}\n        and {{PAYMENT_TERMINAL}}\n        and {{ERROR_GROUP}}\n        and {{ERROR_NAME}}\n        and {{HAS_ID_PROVIDER}}\n        and {{SHOP}}\n        and {{is_aft}}\n        and day(CREATED_AT) <= {{day_number}}\n),\n\npre_top_n as (\n    select \n        CASE \n            WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n                THEN MART__FATPAY.CURRENCY\n            WHEN groupby.fatpay_columns_groupby = 'Status'\n                THEN MART__FATPAY.STATUS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'User Name'\n                THEN MART__FATPAY.USER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Merchant'\n                THEN MART__FATPAY.BUSINESS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Shop'\n                THEN MART__FATPAY.SHOP_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n                THEN MART__FATPAY.DRIVER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n                THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n                THEN MART__FATPAY.CARD_BANK\n            WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n                THEN MART__FATPAY.CARD_BRAND\n            WHEN groupby.fatpay_columns_groupby = 'Card Type'\n                THEN MART__FATPAY.CARD_TYPE\n            WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n                THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n            WHEN groupby.fatpay_columns_groupby = 'Card Country'\n                THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n            WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n                THEN MART__FATPAY.ANTIFRAUD_STATUS\n            WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n                THEN MART__FATPAY.IS_AFT\n            ELSE null \n        END as grouped,\n        row_number() over (order by sum(MART__FATPAY.AMOUNT_EUR) desc) as rn\n    from filtered_fatpay as MART__FATPAY\n    left join filtered_groupby as groupby\n        on 1 = 1\n    group by 1 \n),\n\ntop_n as (\n    select \n        grouped,\n        CASE \n            WHEN rn < {{top_n}} \n                THEN grouped\n        ELSE 'others' END AS grouping_top_n\n    from pre_top_n\n)\n\nselect \n    date_trunc({{granularity}}, MART__FATPAY.CREATED_AT) as CREATED_AT,\n    top_n.grouping_top_n,\n    count(distinct ORDER_ID) as COUNT_TRANSACTIONS  \nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\nleft join filtered_groupby as groupby\n    on 1 = 1\nleft join top_n\n    on top_n.grouped = CASE \n        WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n            THEN MART__FATPAY.CURRENCY\n        WHEN groupby.fatpay_columns_groupby = 'Status'\n            THEN MART__FATPAY.STATUS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'User Name'\n            THEN MART__FATPAY.USER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Merchant'\n            THEN MART__FATPAY.BUSINESS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Shop'\n            THEN MART__FATPAY.SHOP_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n            THEN MART__FATPAY.DRIVER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n            THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n            THEN MART__FATPAY.CARD_BANK\n        WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n            THEN MART__FATPAY.CARD_BRAND\n        WHEN groupby.fatpay_columns_groupby = 'Card Type'\n            THEN MART__FATPAY.CARD_TYPE\n        WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n            THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n        WHEN groupby.fatpay_columns_groupby = 'Card Country'\n            THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n        WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n            THEN MART__FATPAY.ANTIFRAUD_STATUS\n        WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n            THEN MART__FATPAY.IS_AFT\n        ELSE null \n    END\ngroup by 1, 2","template-tags":{"HAS_ID_PROVIDER":{"id":"87e173d0-6e6d-26d3-7962-7bade7540e83","name":"HAS_ID_PROVIDER","display-name":"Has id provider","type":"dimension","dimension":["field",756250,null],"widget-type":"string/=","default":null},"top_n":{"type":"number","name":"top_n","id":"d7c53e1a-687f-463d-9496-78ad6babd6c1","display-name":"Top N","default":"20","required":true},"CARD_COUNTRY":{"id":"29492df1-225c-ccb0-9a4e-272c5f987ac5","name":"CARD_COUNTRY","display-name":"Card country","type":"dimension","dimension":["field",756254,null],"widget-type":"string/=","default":null},"ERROR_GROUP":{"id":"bb7f9117-7da8-bc24-8190-7626f33e6af0","name":"ERROR_GROUP","display-name":"Error group","type":"dimension","dimension":["field",756269,null],"widget-type":"string/=","default":null},"FIAT_CURRENCY":{"id":"5cab7ad0-e021-f0c5-4e22-a66c43242330","name":"FIAT_CURRENCY","display-name":"Fiat currency","type":"dimension","dimension":["field",756268,null],"widget-type":"string/=","default":null},"is_aft":{"type":"dimension","name":"is_aft","id":"22b0b60c-d435-4b53-a107-24d820fc11e8","display-name":"Is Aft","default":null,"dimension":["field",760549,null],"widget-type":"string/=","options":null},"ERROR_NAME":{"id":"4ed8b652-3c97-6a86-8a35-7a397b6f42ea","name":"ERROR_NAME","display-name":"Error name","type":"dimension","dimension":["field",756230,null],"widget-type":"string/contains","default":null},"PAYMENT_TERMINAL":{"id":"cd9daa34-226e-58e4-673d-7fd1179e7dee","name":"PAYMENT_TERMINAL","display-name":"Payment terminal","type":"dimension","dimension":["field",756239,null],"widget-type":"string/=","default":null},"SHOP":{"id":"b4bc2f63-5445-4693-56e0-4b638cf49966","name":"SHOP","display-name":"Shop","type":"dimension","dimension":["field",756245,null],"widget-type":"string/="},"BUSINESS_NAME":{"id":"1a7ca3c6-ac96-dcc3-dbdc-20e1d3c55320","name":"BUSINESS_NAME","display-name":"Business name","type":"dimension","dimension":["field",756258,null],"widget-type":"string/=","default":null},"day_number":{"type":"number","name":"day_number","id":"9db4b7c5-8087-4d53-bb82-9a0e2d7e05f9","display-name":"Month-to-Date Day Number","default":"31","required":true},"granularity":{"id":"37799d21-54a5-2233-9de5-517db3c5bab0","name":"granularity","display-name":"Granularity","type":"text","required":true,"default":"week","values-source-type":"static-list","values-source-config":{"values":[["hour"],["day"],["week"],["month"],["quarter"],["year"]]}},"ACQUIRER":{"id":"0add554f-79fc-6685-f405-66c92af72b79","name":"ACQUIRER","display-name":"Acquirer","type":"dimension","dimension":["field",756224,null],"widget-type":"string/=","default":null},"groupby":{"id":"e17dc612-04b6-9c56-db9b-df98419a776c","name":"groupby","display-name":"Groupby","type":"dimension","default":["Merchant"],"dimension":["field",756658,null],"widget-type":"string/=","required":true},"CREATED_AT":{"id":"7e66dcc1-f9af-d388-5804-ea74427d78fb","name":"CREATED_AT","display-name":"Created at","type":"dimension","dimension":["field",756256,null],"widget-type":"date/all-options","default":"past14days~","required":true},"CARD_GEOSCHEME":{"id":"0d642257-5a4e-bc22-1afa-998bdf910c28","name":"CARD_GEOSCHEME","display-name":"Card geoscheme","type":"dimension","dimension":["field",756227,null],"widget-type":"string/=","default":null},"USER_NAME":{"id":"0ed73475-19ec-3399-0857-ad2c1e797d73","name":"USER_NAME","display-name":"User name","type":"dimension","dimension":["field",756263,null],"widget-type":"string/contains","default":null},"STATUS":{"id":"f05b9ffc-bfb1-f94b-4509-3fa683d56e44","name":"STATUS","display-name":"Status","type":"dimension","dimension":["field",756257,null],"widget-type":"string/=","default":null},"CARD_BRAND":{"id":"45d19436-bb36-cae1-7b66-470806737fb6","name":"CARD_BRAND","display-name":"Card brand","type":"dimension","dimension":["field",756238,null],"widget-type":"string/=","default":null}}},"middleware":{"js-int-to-string?":true,"userland-query?":true,"add-default-userland-constraints?":true}},"average_execution_time":null,"status":"completed","context":"ad-hoc","row_count":60,"running_time":217}

📝 Validating Question 4/7
--------------------------------------------------
  🔍 Validating Question 4154: 1 Sum of Transactions EUR split
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_granularity as (
    select distinct granularity
    from MD__FATPAY_DASHBOARD_HELP_TA...
    ❌ SQL Error detected in response
    📄 Response: {"data":{"rows":[["2025-06-09T00:00:00Z","Darius Tech inc.",662852.3300000001],["2025-06-23T00:00:00Z","Europe/ROW  Domus Payment Solutions LTD",12267.02],["2025-06-23T00:00:00Z","Darius Tech inc.",8056.49],["2025-06-23T00:00:00Z","ADV Project Ltd",37318.14],["2025-06-16T00:00:00Z","Aifory LLC",493630.2500000005],["2025-06-16T00:00:00Z","Midway International N.V.",2365618.62],["2025-06-16T00:00:00Z","Venson Ltd",439301.06000000064],["2025-06-23T00:00:00Z","Aifory LLC",3249.92],["2025-06-23T00:00:00Z","Payinter LTD",18023.68],["2025-06-23T00:00:00Z","BY",205217.03000000003],["2025-06-16T00:00:00Z","Bingx",3219736.109999998],["2025-06-16T00:00:00Z","Finaster Transfer LTD",523626.76000000007],["2025-06-09T00:00:00Z","Payinter LTD",287054.54],["2025-06-09T00:00:00Z","Bro Fintech LTD",444148.66000000003],["2025-06-09T00:00:00Z","others",966030.2099999998],["2025-06-09T00:00:00Z","Europe/ROW  Domus Payment Solutions LTD",255046.53999999998],["2025-06-16T00:00:00Z","ADV Project Ltd",1215968.0800000003],["2025-06-09T00:00:00Z","Mobilum tech",4372600.340000003],["2025-06-09T00:00:00Z","Venson Ltd",466761.88000000076],["2025-06-23T00:00:00Z","Ecom Center LTD",7114.94],["2025-06-23T00:00:00Z","Golden Way Payments LTD",6735.349999999999],["2025-06-09T00:00:00Z","Midway International N.V.",2568872.1599999997],["2025-06-09T00:00:00Z","Pionex",1045321.5300000004],["2025-06-23T00:00:00Z","Venson Ltd",4882.450000000001],["2025-06-16T00:00:00Z","BY",7269900.369999995],["2025-06-16T00:00:00Z","Payinter LTD",295714.6900000001],["2025-06-23T00:00:00Z","Midway International N.V.",116262.38999999996],["2025-06-23T00:00:00Z","Bingx",137261.11000000002],["2025-06-09T00:00:00Z","Whitebit",638551.9099999999],["2025-06-16T00:00:00Z","Phemex",978972.1400000002],["2025-06-16T00:00:00Z","Darius Tech inc.",551966.6799999999],["2025-06-16T00:00:00Z","Europe/ROW  Domus Payment Solutions LTD",292249.33],["2025-06-23T00:00:00Z","Bro Fintech LTD",256.09],["2025-06-09T00:00:00Z","Golden Way Payments LTD",265995.30999999994],["2025-06-16T00:00:00Z","Exidna Enterprises LTD",772000.83],["2025-06-09T00:00:00Z","Bingx",3487412.7599999984],["2025-06-09T00:00:00Z","KURTLEY QURESHI CONSULTANTS LIMITED",1357533.3000000007],["2025-06-09T00:00:00Z","ADV Project Ltd",1004181.0300000001],["2025-06-16T00:00:00Z","Ecom Center LTD",343783.26999999996],["2025-06-16T00:00:00Z","Pionex",1242532.5199999998],["2025-06-16T00:00:00Z","Whitebit",759713.14],["2025-06-23T00:00:00Z","Pionex",59947.270000000004],["2025-06-16T00:00:00Z","others",1103003.1700000004],["2025-06-09T00:00:00Z","Phemex",636883.13],["2025-06-09T00:00:00Z","Exidna Enterprises LTD",710425.8799999997],["2025-06-09T00:00:00Z","Aifory LLC",356953.96000000054],["2025-06-09T00:00:00Z","BY",7650434.009999998],["2025-06-23T00:00:00Z","others",33272.43000000001],["2025-06-16T00:00:00Z","KURTLEY QURESHI CONSULTANTS LIMITED",946728.5900000002],["2025-06-09T00:00:00Z","Finaster Transfer LTD",403540.2900000001],["2025-06-16T00:00:00Z","Mobilum tech",4374986.8699999945],["2025-06-09T00:00:00Z","Ecom Center LTD",368098.82],["2025-06-23T00:00:00Z","Mobilum tech",104849.67999999998],["2025-06-23T00:00:00Z","KURTLEY QURESHI CONSULTANTS LIMITED",23791.120000000003],["2025-06-23T00:00:00Z","Whitebit",8127.519999999999],["2025-06-16T00:00:00Z","Golden Way Payments LTD",292995.8900000001],["2025-06-16T00:00:00Z","Bro Fintech LTD",319901.45000000007],["2025-06-23T00:00:00Z","Exidna Enterprises LTD",25287.680000000004],["2025-06-23T00:00:00Z","Phemex",78281.70999999999],["2025-06-23T00:00:00Z","Finaster Transfer LTD",9760.480000000001]],"cols":[{"display_name":"CREATED_AT","source":"native","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"name":"CREATED_AT","base_type":"type/DateTime","database_type":"DATETIME","effective_type":"type/DateTime"},{"display_name":"grouping_top_n","source":"native","field_ref":["field","grouping_top_n",{"base-type":"type/Text"}],"name":"grouping_top_n","base_type":"type/Text","database_type":"TEXT","effective_type":"type/Text"},{"display_name":"sum_of_transactions","source":"native","field_ref":["field","sum_of_transactions",{"base-type":"type/Float"}],"name":"sum_of_transactions","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"}],"native_form":{"params":["week","Merchant","2025-06-09T00:00:00Z","2025-06-24T00:00:00Z","week"],"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where ?\n          AND granularity is not null\n),\n\nfiltered_groupby as (\n    select distinct fatpay_columns_groupby\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where (`MD__FATPAY_DASHBOARD_HELP_TABLE`.`FATPAY_COLUMNS_GROUPBY` = ?)\n          AND fatpay_columns_groupby is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        `MART__FATPAY`.`CREATED_AT` >= ? AND `MART__FATPAY`.`CREATED_AT` < ?\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and day(CREATED_AT) <= 31\n),\n\npre_top_n as (\n    select \n        CASE \n            WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n                THEN MART__FATPAY.CURRENCY\n            WHEN groupby.fatpay_columns_groupby = 'Status'\n                THEN MART__FATPAY.STATUS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'User Name'\n                THEN MART__FATPAY.USER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Merchant'\n                THEN MART__FATPAY.BUSINESS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Shop'\n                THEN MART__FATPAY.SHOP_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n                THEN MART__FATPAY.DRIVER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n                THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n                THEN MART__FATPAY.CARD_BANK\n            WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n                THEN MART__FATPAY.CARD_BRAND\n            WHEN groupby.fatpay_columns_groupby = 'Card Type'\n                THEN MART__FATPAY.CARD_TYPE\n            WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n                THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n            WHEN groupby.fatpay_columns_groupby = 'Card Country'\n                THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n            WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n                THEN MART__FATPAY.ANTIFRAUD_STATUS\n            WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n                THEN MART__FATPAY.IS_AFT\n            ELSE null \n        END as grouped,\n        row_number() over (order by sum(MART__FATPAY.AMOUNT_EUR) desc) as rn\n    from filtered_fatpay as MART__FATPAY\n    left join filtered_groupby as groupby\n        on 1 = 1\n    group by 1 \n),\n\ntop_n as (\n    select \n        grouped,\n        CASE \n            WHEN rn < 20 \n                THEN grouped\n        ELSE 'others' END AS grouping_top_n\n    from pre_top_n\n)\n\nselect \n    date_trunc(?, MART__FATPAY.CREATED_AT) as CREATED_AT,\n    top_n.grouping_top_n,\n    sum(MART__FATPAY.AMOUNT_EUR) as sum_of_transactions    \nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\nleft join filtered_groupby as groupby\n    on 1 = 1\nleft join top_n\n    on top_n.grouped = CASE \n        WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n            THEN MART__FATPAY.CURRENCY\n        WHEN groupby.fatpay_columns_groupby = 'Status'\n            THEN MART__FATPAY.STATUS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'User Name'\n            THEN MART__FATPAY.USER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Merchant'\n            THEN MART__FATPAY.BUSINESS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Shop'\n            THEN MART__FATPAY.SHOP_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n            THEN MART__FATPAY.DRIVER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n            THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n            THEN MART__FATPAY.CARD_BANK\n        WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n            THEN MART__FATPAY.CARD_BRAND\n        WHEN groupby.fatpay_columns_groupby = 'Card Type'\n            THEN MART__FATPAY.CARD_TYPE\n        WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n            THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n        WHEN groupby.fatpay_columns_groupby = 'Card Country'\n            THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n        WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n            THEN MART__FATPAY.ANTIFRAUD_STATUS\n        WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n            THEN MART__FATPAY.IS_AFT\n        ELSE null \n    END\ngroup by 1, 2"},"results_timezone":"Etc/UTC","format-rows?":true,"results_metadata":{"columns":[{"display_name":"CREATED_AT","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"base_type":"type/DateTime","effective_type":"type/DateTime","name":"CREATED_AT","semantic_type":"type/CreationTimestamp","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/DateTime":{"earliest":"2025-06-09T00:00:00Z","latest":"2025-06-23T00:00:00Z"}}}},{"display_name":"grouping_top_n","field_ref":["field","grouping_top_n",{"base-type":"type/Text"}],"base_type":"type/Text","effective_type":"type/Text","name":"grouping_top_n","semantic_type":null,"fingerprint":{"global":{"distinct-count":20,"nil%":0.0},"type":{"type/Text":{"percent-json":0.0,"percent-url":0.0,"percent-email":0.0,"percent-state":0.0,"average-length":15.15}}}},{"display_name":"sum_of_transactions","field_ref":["field","sum_of_transactions",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"sum_of_transactions","semantic_type":null,"fingerprint":{"global":{"distinct-count":60,"nil%":0.0},"type":{"type/Number":{"min":256.09,"q1":69114.48999999999,"q3":972501.175,"max":7650434.009999998,"sd":1580768.5763048264,"avg":944183.1818333332}}}}]},"insights":[{"previous-value":null,"unit":null,"offset":1.9576304314065795E9,"last-change":null,"col":"sum_of_transactions","slope":-96602.62889285343,"last-value":9760.480000000001,"best-fit":["+",1.9576304314065795E9,["*",-96602.62889285343,"x"]]}]},"cached":null,"database_id":16,"started_at":"2025-06-23T08:41:57.719832531Z","json_query":{"type":"native","database":16,"native":{"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{granularity}}\n          AND granularity is not null\n),\n\nfiltered_groupby as (\n    select distinct fatpay_columns_groupby\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{groupby}}\n          AND fatpay_columns_groupby is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        {{CREATED_AT}}\n        and {{CARD_GEOSCHEME}}\n        and {{CARD_COUNTRY}}\n        and {{STATUS}}\n        and {{BUSINESS_NAME}}\n        and {{USER_NAME}}\n        and {{FIAT_CURRENCY}}\n        and {{ACQUIRER}}\n        and {{CARD_BRAND}}\n        and {{PAYMENT_TERMINAL}}\n        and {{ERROR_GROUP}}\n        and {{ERROR_NAME}}\n        and {{HAS_ID_PROVIDER}}\n        and {{SHOP}}\n        and {{is_aft}}\n        and day(CREATED_AT) <= {{day_number}}\n),\n\npre_top_n as (\n    select \n        CASE \n            WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n                THEN MART__FATPAY.CURRENCY\n            WHEN groupby.fatpay_columns_groupby = 'Status'\n                THEN MART__FATPAY.STATUS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'User Name'\n                THEN MART__FATPAY.USER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Merchant'\n                THEN MART__FATPAY.BUSINESS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Shop'\n                THEN MART__FATPAY.SHOP_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n                THEN MART__FATPAY.DRIVER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n                THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n                THEN MART__FATPAY.CARD_BANK\n            WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n                THEN MART__FATPAY.CARD_BRAND\n            WHEN groupby.fatpay_columns_groupby = 'Card Type'\n                THEN MART__FATPAY.CARD_TYPE\n            WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n                THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n            WHEN groupby.fatpay_columns_groupby = 'Card Country'\n                THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n            WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n                THEN MART__FATPAY.ANTIFRAUD_STATUS\n            WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n                THEN MART__FATPAY.IS_AFT\n            ELSE null \n        END as grouped,\n        row_number() over (order by sum(MART__FATPAY.AMOUNT_EUR) desc) as rn\n    from filtered_fatpay as MART__FATPAY\n    left join filtered_groupby as groupby\n        on 1 = 1\n    group by 1 \n),\n\ntop_n as (\n    select \n        grouped,\n        CASE \n            WHEN rn < {{top_n}} \n                THEN grouped\n        ELSE 'others' END AS grouping_top_n\n    from pre_top_n\n)\n\nselect \n    date_trunc({{granularity}}, MART__FATPAY.CREATED_AT) as CREATED_AT,\n    top_n.grouping_top_n,\n    sum(MART__FATPAY.AMOUNT_EUR) as sum_of_transactions    \nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\nleft join filtered_groupby as groupby\n    on 1 = 1\nleft join top_n\n    on top_n.grouped = CASE \n        WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n            THEN MART__FATPAY.CURRENCY\n        WHEN groupby.fatpay_columns_groupby = 'Status'\n            THEN MART__FATPAY.STATUS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'User Name'\n            THEN MART__FATPAY.USER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Merchant'\n            THEN MART__FATPAY.BUSINESS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Shop'\n            THEN MART__FATPAY.SHOP_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n            THEN MART__FATPAY.DRIVER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n            THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n            THEN MART__FATPAY.CARD_BANK\n        WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n            THEN MART__FATPAY.CARD_BRAND\n        WHEN groupby.fatpay_columns_groupby = 'Card Type'\n            THEN MART__FATPAY.CARD_TYPE\n        WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n            THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n        WHEN groupby.fatpay_columns_groupby = 'Card Country'\n            THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n        WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n            THEN MART__FATPAY.ANTIFRAUD_STATUS\n        WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n            THEN MART__FATPAY.IS_AFT\n        ELSE null \n    END\ngroup by 1, 2","template-tags":{"HAS_ID_PROVIDER":{"id":"89fd66a2-56de-fe36-fd6a-e35ccbd7c858","name":"HAS_ID_PROVIDER","display-name":"Has id provider","type":"dimension","dimension":["field",756250,null],"widget-type":"string/=","default":null},"top_n":{"type":"number","name":"top_n","id":"0eb7f1d8-4144-4787-9c6d-b7f9ff5aa138","display-name":"Top N","default":"20","required":true},"CARD_COUNTRY":{"id":"29492df1-225c-ccb0-9a4e-272c5f987ac5","name":"CARD_COUNTRY","display-name":"Card country","type":"dimension","dimension":["field",756254,null],"widget-type":"string/=","default":null},"ERROR_GROUP":{"id":"bb7f9117-7da8-bc24-8190-7626f33e6af0","name":"ERROR_GROUP","display-name":"Error group","type":"dimension","dimension":["field",756269,null],"widget-type":"string/=","default":null},"FIAT_CURRENCY":{"id":"5cab7ad0-e021-f0c5-4e22-a66c43242330","name":"FIAT_CURRENCY","display-name":"Fiat currency","type":"dimension","dimension":["field",756268,null],"widget-type":"string/=","default":null},"is_aft":{"type":"dimension","name":"is_aft","id":"6718bddd-1e7d-4615-83af-daba85658df0","display-name":"Is Aft","default":null,"dimension":["field",760549,null],"widget-type":"string/=","options":null},"ERROR_NAME":{"id":"4ed8b652-3c97-6a86-8a35-7a397b6f42ea","name":"ERROR_NAME","display-name":"Error name","type":"dimension","dimension":["field",756230,null],"widget-type":"string/contains","default":null},"PAYMENT_TERMINAL":{"id":"cd9daa34-226e-58e4-673d-7fd1179e7dee","name":"PAYMENT_TERMINAL","display-name":"Payment terminal","type":"dimension","dimension":["field",756239,null],"widget-type":"string/=","default":null},"SHOP":{"id":"9d141b8b-3344-9179-f730-8970a5e2e57e","name":"SHOP","display-name":"Shop","type":"dimension","dimension":["field",756245,null],"widget-type":"string/="},"BUSINESS_NAME":{"id":"1a7ca3c6-ac96-dcc3-dbdc-20e1d3c55320","name":"BUSINESS_NAME","display-name":"Business name","type":"dimension","dimension":["field",756258,null],"widget-type":"string/=","default":null},"day_number":{"type":"number","name":"day_number","id":"1828645c-8d1c-41cc-aa42-3767e01eff2f","display-name":"Month-to-Date Day Number","default":"31","required":true},"granularity":{"id":"37799d21-54a5-2233-9de5-517db3c5bab0","name":"granularity","display-name":"Granularity","type":"text","required":true,"default":"week","values-source-type":"static-list","values-source-config":{"values":[["hour"],["day"],["week"],["month"],["quarter"],["year"]]}},"ACQUIRER":{"id":"0add554f-79fc-6685-f405-66c92af72b79","name":"ACQUIRER","display-name":"Acquirer","type":"dimension","dimension":["field",756224,null],"widget-type":"string/=","default":null},"groupby":{"id":"e17dc612-04b6-9c56-db9b-df98419a776c","name":"groupby","display-name":"Groupby","type":"dimension","default":["Merchant"],"dimension":["field",756658,null],"widget-type":"string/=","required":true},"CREATED_AT":{"id":"7e66dcc1-f9af-d388-5804-ea74427d78fb","name":"CREATED_AT","display-name":"Created at","type":"dimension","dimension":["field",756256,null],"widget-type":"date/all-options","default":"past14days~","required":true},"CARD_GEOSCHEME":{"id":"0d642257-5a4e-bc22-1afa-998bdf910c28","name":"CARD_GEOSCHEME","display-name":"Card geoscheme","type":"dimension","dimension":["field",756227,null],"widget-type":"string/=","default":null},"USER_NAME":{"id":"0ed73475-19ec-3399-0857-ad2c1e797d73","name":"USER_NAME","display-name":"User name","type":"dimension","dimension":["field",756263,null],"widget-type":"string/contains","default":null},"STATUS":{"id":"f05b9ffc-bfb1-f94b-4509-3fa683d56e44","name":"STATUS","display-name":"Status","type":"dimension","dimension":["field",756257,null],"widget-type":"string/=","default":null},"CARD_BRAND":{"id":"45d19436-bb36-cae1-7b66-470806737fb6","name":"CARD_BRAND","display-name":"Card brand","type":"dimension","dimension":["field",756238,null],"widget-type":"string/=","default":null}}},"middleware":{"js-int-to-string?":true,"userland-query?":true,"add-default-userland-constraints?":true}},"average_execution_time":null,"status":"completed","context":"ad-hoc","row_count":60,"running_time":7089}

📝 Validating Question 5/7
--------------------------------------------------
  🔍 Validating Question 4158: 1 Revenue/Turnover,  GMV/Turnover
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_granularity as (
    select granularity
    from MD__FATPAY_DASHBOARD_HELP_TABLE
    w...
    ❌ SQL Error detected in response
    📄 Response: {"data":{"rows":[["2025-06-09T00:00:00Z",0.023003017433676092,0.01586104208469099,0.008053927530723863,0.007807114553967285,0.00714197534898496],["2025-06-16T00:00:00Z",0.020537974571100882,0.013463890401710784,0.004118305378675103,0.009345585023035802,0.007074084169389969],["2025-06-23T00:00:00Z",0.02320046901426174,0.017554908023117086,0.0,0.017554908023117086,0.005645560991144645]],"cols":[{"display_name":"CREATED_AT","source":"native","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"name":"CREATED_AT","base_type":"type/DateTime","database_type":"DATETIME","effective_type":"type/DateTime"},{"display_name":"Revenue / Turnover","source":"native","field_ref":["field","Revenue / Turnover",{"base-type":"type/Float"}],"name":"Revenue / Turnover","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"},{"display_name":"Acquiring Commission Total / Turnover","source":"native","field_ref":["field","Acquiring Commission Total / Turnover",{"base-type":"type/Float"}],"name":"Acquiring Commission Total / Turnover","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"},{"display_name":"Acquiring Commission: Fact / Turnover","source":"native","field_ref":["field","Acquiring Commission: Fact / Turnover",{"base-type":"type/Float"}],"name":"Acquiring Commission: Fact / Turnover","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"},{"display_name":"Acquiring Commission: Forecast / Turnover","source":"native","field_ref":["field","Acquiring Commission: Forecast / Turnover",{"base-type":"type/Float"}],"name":"Acquiring Commission: Forecast / Turnover","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"},{"display_name":"GMV / Turnover","source":"native","field_ref":["field","GMV / Turnover",{"base-type":"type/Float"}],"name":"GMV / Turnover","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"}],"native_form":{"params":["week","2025-06-09T00:00:00Z","2025-06-24T00:00:00Z","week"],"query":"with filtered_granularity as (\n    select granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where ?\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select \n        CREATED_AT,\n        fee_acquirer_eur,\n        calc_fee_mercuryo_eur,\n        fee_acquirer_is_exact,\n        calc_gmv_eur,\n        amount_eur\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        `MART__FATPAY`.`CREATED_AT` >= ? AND `MART__FATPAY`.`CREATED_AT` < ?\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and day(CREATED_AT) <= 31\n)\n\nselect \n    date_trunc(?, ff.CREATED_AT) as CREATED_AT,\n    sum(ff.calc_fee_mercuryo_eur)/cast(sum(ff.amount_eur) as float) as 'Revenue / Turnover',\n    sum(ff.fee_acquirer_eur)/cast(sum(ff.amount_eur) as float) as 'Acquiring Commission Total / Turnover',\n    sum(case when ff.fee_acquirer_is_exact = 'exact' then ff.fee_acquirer_eur end)/cast(sum(ff.amount_eur) as float) as 'Acquiring Commission: Fact / Turnover',\n    sum(case when ff.fee_acquirer_is_exact <> 'exact' then ff.fee_acquirer_eur end)/cast(sum(ff.amount_eur) as float) as 'Acquiring Commission: Forecast / Turnover',\n    sum(ff.calc_gmv_eur)/cast(sum(ff.amount_eur) as float) as 'GMV / Turnover'\nfrom filtered_fatpay as ff\nleft join filtered_granularity as fg\n    on 1 = 1\ngroup by 1"},"results_timezone":"Etc/UTC","format-rows?":true,"results_metadata":{"columns":[{"display_name":"CREATED_AT","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"base_type":"type/DateTime","effective_type":"type/DateTime","name":"CREATED_AT","semantic_type":"type/CreationTimestamp","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/DateTime":{"earliest":"2025-06-09T00:00:00Z","latest":"2025-06-23T00:00:00Z"}}}},{"display_name":"Revenue / Turnover","field_ref":["field","Revenue / Turnover",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"Revenue / Turnover","semantic_type":null,"fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/Number":{"min":0.020537974571100882,"q1":0.021154235286744684,"q3":0.023151106119115326,"max":0.02320046901426174,"sd":0.0014834812716979385,"avg":0.022247153673012905}}}},{"display_name":"Acquiring Commission Total / Turnover","field_ref":["field","Acquiring Commission Total / Turnover",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"Acquiring Commission Total / Turnover","semantic_type":null,"fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/Number":{"min":0.013463890401710784,"q1":0.014063178322455835,"q3":0.01713144153851056,"max":0.017554908023117086,"sd":0.002055559258337895,"avg":0.015626613503172952}}}},{"display_name":"Acquiring Commission: Fact / Turnover","field_ref":["field","Acquiring Commission: Fact / Turnover",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"Acquiring Commission: Fact / Turnover","semantic_type":null,"fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/Number":{"min":0.0,"q1":0.0010295763446687757,"q3":0.0070700219927116725,"max":0.008053927530723863,"sd":0.0040273090599446375,"avg":0.0040574109697996555}}}},{"display_name":"Acquiring Commission: Forecast / Turnover","field_ref":["field","Acquiring Commission: Forecast / Turnover",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"Acquiring Commission: Forecast / Turnover","semantic_type":null,"fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/Number":{"min":0.007807114553967285,"q1":0.008191732171234414,"q3":0.015502577273096764,"max":0.017554908023117086,"sd":0.005240536757194804,"avg":0.011569202533373393}}}},{"display_name":"GMV / Turnover","field_ref":["field","GMV / Turnover",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"GMV / Turnover","semantic_type":null,"fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/Number":{"min":0.005645560991144645,"q1":0.006002691785705975,"q3":0.007125002554086212,"max":0.00714197534898496,"sd":8.45038816998127E-4,"avg":0.006620540169839859}}}}]},"insights":[{"previous-value":0.020537974571100882,"unit":"week","offset":-0.2634229723814379,"last-change":0.12963763461404174,"col":"Revenue / Turnover","slope":1.4103684327546324E-5,"last-value":0.02320046901426174,"best-fit":["+",-0.2634229723814379,["*",1.4103684327546324E-5,"x"]]},{"previous-value":0.013463890401710784,"unit":"week","offset":-2.4350344281268703,"last-change":0.3038510786515671,"col":"Acquiring Commission Total / Turnover","slope":1.2099042417329267E-4,"last-value":0.017554908023117086,"best-fit":["+",-2.4350344281268703,["*",1.2099042417329267E-4,"x"]]},{"previous-value":0.004118305378675103,"unit":"week","offset":11.656364706313504,"last-change":-1.0,"col":"Acquiring Commission: Fact / Turnover","slope":-5.752805379088474E-4,"last-value":0.0,"best-fit":["+",11.656364706313504,["*",-5.752805379088474E-4,"x"]]},{"previous-value":0.009345585023035802,"unit":"week","offset":-14.09139913444014,"last-change":0.8784172397818047,"col":"Acquiring Commission: Forecast / Turnover","slope":6.962709620821285E-4,"last-value":0.017554908023117086,"best-fit":["+",-14.09139913444014,["*",6.962709620821285E-4,"x"]]},{"previous-value":0.007074084169389969,"unit":"week","offset":2.1716114557452393,"last-change":-0.20193754329735553,"col":"GMV / Turnover","slope":-1.0688673984573683E-4,"last-value":0.005645560991144645,"best-fit":["+",2.1716114557452393,["*",-1.0688673984573683E-4,"x"]]}]},"cached":null,"database_id":16,"started_at":"2025-06-23T08:42:06.098703081Z","json_query":{"type":"native","database":16,"native":{"query":"with filtered_granularity as (\n    select granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{granularity}}\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select \n        CREATED_AT,\n        fee_acquirer_eur,\n        calc_fee_mercuryo_eur,\n        fee_acquirer_is_exact,\n        calc_gmv_eur,\n        amount_eur\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        {{CREATED_AT}}\n        and {{CARD_GEOSCHEME}}\n        and {{CARD_COUNTRY}}\n        and {{STATUS}}\n        and {{BUSINESS_NAME}}\n        and {{USER_NAME}}\n        and {{FIAT_CURRENCY}}\n        and {{ACQUIRER}}\n        and {{CARD_BRAND}}\n        and {{PAYMENT_TERMINAL}}\n        and {{ERROR_GROUP}}\n        and {{ERROR_NAME}}\n        and {{HAS_ID_PROVIDER}}\n        and {{SHOP}}\n        and {{is_aft}}\n        and day(CREATED_AT) <= {{day_number}}\n)\n\nselect \n    date_trunc({{granularity}}, ff.CREATED_AT) as CREATED_AT,\n    sum(ff.calc_fee_mercuryo_eur)/cast(sum(ff.amount_eur) as float) as 'Revenue / Turnover',\n    sum(ff.fee_acquirer_eur)/cast(sum(ff.amount_eur) as float) as 'Acquiring Commission Total / Turnover',\n    sum(case when ff.fee_acquirer_is_exact = 'exact' then ff.fee_acquirer_eur end)/cast(sum(ff.amount_eur) as float) as 'Acquiring Commission: Fact / Turnover',\n    sum(case when ff.fee_acquirer_is_exact <> 'exact' then ff.fee_acquirer_eur end)/cast(sum(ff.amount_eur) as float) as 'Acquiring Commission: Forecast / Turnover',\n    sum(ff.calc_gmv_eur)/cast(sum(ff.amount_eur) as float) as 'GMV / Turnover'\nfrom filtered_fatpay as ff\nleft join filtered_granularity as fg\n    on 1 = 1\ngroup by 1 ","template-tags":{"HAS_ID_PROVIDER":{"id":"595b93e0-5e69-b486-5d36-874e60934ac8","name":"HAS_ID_PROVIDER","display-name":"Has id provider","type":"dimension","dimension":["field",756250,null],"widget-type":"string/=","default":null},"CARD_COUNTRY":{"id":"716a10f7-f987-2208-4429-4b0598b2432e","name":"CARD_COUNTRY","display-name":"Card country","type":"dimension","dimension":["field",756254,null],"widget-type":"string/=","required":false},"ERROR_GROUP":{"id":"2287bcf2-879d-a509-ecef-f2f375ebe882","name":"ERROR_GROUP","display-name":"Error group","type":"dimension","dimension":["field",756269,null],"widget-type":"string/=","default":null},"FIAT_CURRENCY":{"id":"e734ceda-ef86-ce9c-358a-69566a4c0214","name":"FIAT_CURRENCY","display-name":"Fiat currency","type":"dimension","dimension":["field",756268,null],"widget-type":"string/=","default":null},"is_aft":{"type":"dimension","name":"is_aft","id":"7c5c0b6d-9a29-4819-aec6-1d0bff0dfa7e","display-name":"Is Aft","default":null,"dimension":["field",760549,null],"widget-type":"string/=","options":null},"ERROR_NAME":{"id":"0f8f7ec3-37a6-f67c-8319-7d255e39e841","name":"ERROR_NAME","display-name":"Error name","type":"dimension","dimension":["field",756230,null],"widget-type":"string/contains","default":null},"PAYMENT_TERMINAL":{"id":"698f65a5-572d-3286-034e-151b59125736","name":"PAYMENT_TERMINAL","display-name":"Payment terminal","type":"dimension","dimension":["field",756239,null],"widget-type":"string/=","default":null},"SHOP":{"id":"07ab1361-a08a-a1d2-24dc-e53e7d520e0c","name":"SHOP","display-name":"Shop","type":"dimension","dimension":["field",756245,null],"widget-type":"string/="},"BUSINESS_NAME":{"id":"bd69ce89-a3be-5f0d-90ef-0ad9b70f116e","name":"BUSINESS_NAME","display-name":"Business name","type":"dimension","dimension":["field",756258,null],"widget-type":"string/=","default":null},"day_number":{"type":"number","name":"day_number","id":"adc2484a-6c6f-4941-a0e1-a8c1f113035a","display-name":"Month-to-Date Day Number","default":"31","required":true},"granularity":{"id":"4b095973-b5cb-4c93-c12a-607019dd0fcd","name":"granularity","display-name":"Granularity","type":"text","required":true,"default":"week","values-source-type":"static-list","values-source-config":{"values":[["hour"],["day"],["week"],["month"],["quarter"],["year"]]}},"ACQUIRER":{"id":"bf51e367-ae6b-c409-020c-711538e8ce91","name":"ACQUIRER","display-name":"Acquirer","type":"dimension","dimension":["field",756224,null],"widget-type":"string/=","default":null},"CREATED_AT":{"id":"cf278b54-4f5f-9fbe-23f8-d1a9fdd227db","name":"CREATED_AT","display-name":"Created at","type":"dimension","dimension":["field",756256,null],"widget-type":"date/all-options","default":"past14days~"},"CARD_GEOSCHEME":{"id":"cba17b07-3a17-4612-ce72-00eeddc3d21e","name":"CARD_GEOSCHEME","display-name":"Card geoscheme","type":"dimension","dimension":["field",756227,null],"widget-type":"string/=","required":false},"USER_NAME":{"id":"3e87e7a8-2e29-86a6-c39d-c0f3b183d924","name":"USER_NAME","display-name":"User name","type":"dimension","dimension":["field",756263,null],"widget-type":"string/contains","default":null},"STATUS":{"id":"ce1486eb-801e-0a23-1514-067b67d5aa73","name":"STATUS","display-name":"Status","type":"dimension","dimension":["field",756257,null],"widget-type":"string/=","default":null},"CARD_BRAND":{"id":"54185955-91b6-f816-51dc-f71b45b3fc83","name":"CARD_BRAND","display-name":"Card brand","type":"dimension","dimension":["field",756238,null],"widget-type":"string/=","default":null}}},"middleware":{"js-int-to-string?":true,"userland-query?":true,"add-default-userland-constraints?":true}},"average_execution_time":null,"status":"completed","context":"ad-hoc","row_count":3,"running_time":392}

📝 Validating Question 6/7
--------------------------------------------------
  🔍 Validating Question 4159: 1 Stat Table 
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_granularity as (
    select distinct granularity
    from MD__FATPAY_DASHBOARD_HELP_TA...
    ❌ SQL Error detected in response
    📄 Response: {"data":{"rows":[["ADV Project Ltd","2025-06-09T00:00:00Z",6503,3669,0.5642011379363371,1004181.0300000003,549559.8800000001],["ADV Project Ltd","2025-06-16T00:00:00Z",6230,3473,0.5574638844301766,1215968.0799999996,567998.53],["ADV Project Ltd","2025-06-23T00:00:00Z",183,104,0.5683060109289617,37318.14,12728.199999999999],["Aifory LLC","2025-06-09T00:00:00Z",12923,7805,0.6039619283448115,356953.9600000004,157006.40000000002],["Aifory LLC","2025-06-16T00:00:00Z",17993,7058,0.39226365808925695,493630.25000000047,197116.04999999996],["Aifory LLC","2025-06-23T00:00:00Z",53,31,0.5849056603773585,3249.9199999999996,2429.71],["BY","2025-06-09T00:00:00Z",27274,20665,0.7576813082056171,7650434.010000002,4840551.570000001],["BY","2025-06-16T00:00:00Z",26893,20767,0.77220838136318,7269900.369999993,4474917.729999997],["BY","2025-06-23T00:00:00Z",774,582,0.751937984496124,205217.02999999997,128772.21000000002],["Bingx","2025-06-09T00:00:00Z",17366,8625,0.49666014050443397,3487412.7599999984,1911881.7200000002],["Bingx","2025-06-16T00:00:00Z",16032,8307,0.5181511976047904,3219736.109999998,1808944.6],["Bingx","2025-06-23T00:00:00Z",557,286,0.5134649910233393,137261.11,73266.59],["Bro Fintech LTD","2025-06-09T00:00:00Z",6487,3928,0.6055187297672268,444148.6599999998,229224.57999999993],["Bro Fintech LTD","2025-06-16T00:00:00Z",5044,2591,0.5136796193497224,319901.45,153046.25000000003],["Bro Fintech LTD","2025-06-23T00:00:00Z",9,6,0.6666666666666666,256.09,187.01],["Darius Tech inc.","2025-06-09T00:00:00Z",8585,4547,0.5296447291788002,662852.3299999998,271329.80999999994],["Darius Tech inc.","2025-06-16T00:00:00Z",7563,4552,0.6018775618140949,551966.6799999999,280691.52],["Darius Tech inc.","2025-06-23T00:00:00Z",143,74,0.5174825174825175,8056.490000000001,2959.9999999999995],["Ecom Center LTD","2025-06-09T00:00:00Z",5960,3983,0.6682885906040269,368098.8199999999,217087.12000000002],["Ecom Center LTD","2025-06-16T00:00:00Z",5774,3881,0.6721510218219605,343783.26999999996,210439.16999999998],["Ecom Center LTD","2025-06-23T00:00:00Z",121,76,0.628099173553719,7114.94,2745.39],["Europe/ROW  Domus Payment Solutions LTD","2025-06-09T00:00:00Z",5659,3411,0.6027566707898923,255046.54,140916.08000000002],["Europe/ROW  Domus Payment Solutions LTD","2025-06-16T00:00:00Z",6166,3929,0.6372040220564386,292249.33,170477.0],["Europe/ROW  Domus Payment Solutions LTD","2025-06-23T00:00:00Z",367,264,0.7193460490463215,12267.02,6492.080000000001],["Exidna Enterprises LTD","2025-06-09T00:00:00Z",10713,7486,0.6987771865957249,710425.8800000001,453652.52],["Exidna Enterprises LTD","2025-06-16T00:00:00Z",14032,9074,0.6466647662485747,772000.8300000001,513358.4099999997],["Exidna Enterprises LTD","2025-06-23T00:00:00Z",518,369,0.7123552123552124,25287.68,17491.14],["Finaster Transfer LTD","2025-06-09T00:00:00Z",9732,7458,0.7663378545006165,403540.2899999999,300590.88000000006],["Finaster Transfer LTD","2025-06-16T00:00:00Z",11617,9628,0.8287854007058622,523626.76,414351.30999999994],["Finaster Transfer LTD","2025-06-23T00:00:00Z",260,238,0.9153846153846154,9760.48,8994.58],["Golden Way Payments LTD","2025-06-09T00:00:00Z",5108,2615,0.5119420516836335,265995.30999999994,113644.35999999997],["Golden Way Payments LTD","2025-06-16T00:00:00Z",5943,3128,0.5263335015985192,292995.8899999999,123784.63999999998],["Golden Way Payments LTD","2025-06-23T00:00:00Z",151,84,0.5562913907284768,6735.35,3763.7299999999996],["KURTLEY QURESHI CONSULTANTS LIMITED","2025-06-09T00:00:00Z",23115,14159,0.6125459658230586,1357533.3,771627.41],["KURTLEY QURESHI CONSULTANTS LIMITED","2025-06-16T00:00:00Z",16660,9782,0.587154861944778,946728.5900000001,494844.48000000016],["KURTLEY QURESHI CONSULTANTS LIMITED","2025-06-23T00:00:00Z",365,204,0.5589041095890411,23791.119999999995,10301.49],["Midway International N.V.","2025-06-09T00:00:00Z",12455,10153,0.8151746286631875,2568872.1600000006,1940967.1000000013],["Midway International N.V.","2025-06-16T00:00:00Z",12979,10578,0.8150088604669081,2365618.619999999,1811969.4999999993],["Midway International N.V.","2025-06-23T00:00:00Z",662,552,0.8338368580060423,116262.38999999998,85231.84999999999],["Mobilum tech","2025-06-09T00:00:00Z",19902,16796,0.8439352828861421,4372600.339999999,3113332.540000001],["Mobilum tech","2025-06-16T00:00:00Z",20129,16925,0.8408266679914551,4374986.869999997,3100664.3899999973],["Mobilum tech","2025-06-23T00:00:00Z",650,585,0.9,104849.67999999998,90176.38999999998],["Payinter LTD","2025-06-09T00:00:00Z",3495,2086,0.5968526466380544,287054.54,125291.63000000002],["Payinter LTD","2025-06-16T00:00:00Z",4054,2076,0.512086827824371,295714.69000000006,129528.93000000002],["Payinter LTD","2025-06-23T00:00:00Z",110,42,0.38181818181818183,18023.68,10655.679999999998],["Phemex","2025-06-09T00:00:00Z",1642,810,0.4933008526187576,636883.1299999999,330308.68],["Phemex","2025-06-16T00:00:00Z",2001,1014,0.5067466266866567,978972.1400000001,491559.77],["Phemex","2025-06-23T00:00:00Z",65,25,0.38461538461538464,78281.70999999999,16939.18],["Pionex","2025-06-09T00:00:00Z",4656,2377,0.5105240549828178,1045321.5299999999,551849.78],["Pionex","2025-06-16T00:00:00Z",5068,2864,0.5651144435674822,1242532.5199999998,794784.8200000001],["Pionex","2025-06-23T00:00:00Z",174,80,0.45977011494252873,59947.270000000004,23702.09],["Venson Ltd","2025-06-09T00:00:00Z",14699,10476,0.712701544322743,466761.8800000005,319125.58000000025],["Venson Ltd","2025-06-16T00:00:00Z",13418,7456,0.5556714860634968,439301.0600000005,228401.04000000012],["Venson Ltd","2025-06-23T00:00:00Z",157,106,0.6751592356687898,4882.45,3183.519999999999],["Whitebit","2025-06-09T00:00:00Z",2852,1421,0.4982468443197756,638551.91,273663.38999999996],["Whitebit","2025-06-16T00:00:00Z",2486,1272,0.5116653258246179,759713.1399999999,281441.12999999995],["Whitebit","2025-06-23T00:00:00Z",48,32,0.6666666666666666,8127.5199999999995,4841.829999999999],["others","2025-06-09T00:00:00Z",11465,6764,0.5899694723070213,966030.2100000002,439539.06000000006],["others","2025-06-16T00:00:00Z",27028,15644,0.5788071629421341,1103003.1700000002,566091.88],["others","2025-06-23T00:00:00Z",648,383,0.5910493827160493,33272.43000000001,23640.750000000004]],"cols":[{"display_name":"grouped","source":"native","field_ref":["field","grouped",{"base-type":"type/Text"}],"name":"grouped","base_type":"type/Text","database_type":"TEXT","effective_type":"type/Text"},{"display_name":"Created at","source":"native","field_ref":["field","Created at",{"base-type":"type/DateTime"}],"name":"Created at","base_type":"type/DateTime","database_type":"DATETIME","effective_type":"type/DateTime"},{"display_name":"Number of total transactions","source":"native","field_ref":["field","Number of total transactions",{"base-type":"type/BigInteger"}],"name":"Number of total transactions","base_type":"type/BigInteger","database_type":"BIGINT","effective_type":"type/BigInteger"},{"display_name":"Number of complete transactions","source":"native","field_ref":["field","Number of complete transactions",{"base-type":"type/BigInteger"}],"name":"Number of complete transactions","base_type":"type/BigInteger","database_type":"BIGINT","effective_type":"type/BigInteger"},{"display_name":"Acceptance Rate","source":"native","field_ref":["field","Acceptance Rate",{"base-type":"type/Float"}],"name":"Acceptance Rate","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"},{"display_name":"Sum of total transactions","source":"native","field_ref":["field","Sum of total transactions",{"base-type":"type/Float"}],"name":"Sum of total transactions","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"},{"display_name":"TURNOVER (of complete transactions)","source":"native","field_ref":["field","TURNOVER (of complete transactions)",{"base-type":"type/Float"}],"name":"TURNOVER (of complete transactions)","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"}],"native_form":{"params":["week","Merchant","2025-06-09T00:00:00Z","2025-06-24T00:00:00Z","week"],"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where ?\n          AND granularity is not null\n),\n\nfiltered_groupby as (\n    select distinct fatpay_columns_groupby\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where (`MD__FATPAY_DASHBOARD_HELP_TABLE`.`FATPAY_COLUMNS_GROUPBY` = ?)\n          AND fatpay_columns_groupby is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        `MART__FATPAY`.`CREATED_AT` >= ? AND `MART__FATPAY`.`CREATED_AT` < ?\n        and 1 = 1\n        and 1 = 1\n        --and {{STATUS}}\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and day(CREATED_AT) <= 31\n),\n\npre_top_n as (\n    select \n        CASE \n            WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n                THEN MART__FATPAY.CURRENCY\n            WHEN groupby.fatpay_columns_groupby = 'Status'\n                THEN MART__FATPAY.STATUS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'User Name'\n                THEN MART__FATPAY.USER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Merchant'\n                THEN MART__FATPAY.BUSINESS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Shop'\n                THEN MART__FATPAY.SHOP_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n                THEN MART__FATPAY.DRIVER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n                THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n                THEN MART__FATPAY.CARD_BANK\n            WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n                THEN MART__FATPAY.CARD_BRAND\n            WHEN groupby.fatpay_columns_groupby = 'Card Type'\n                THEN MART__FATPAY.CARD_TYPE\n            WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n                THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n            WHEN groupby.fatpay_columns_groupby = 'Card Country'\n                THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n            WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n                THEN MART__FATPAY.ANTIFRAUD_STATUS\n            WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n                THEN MART__FATPAY.IS_AFT\n            ELSE null \n        END as grouped,\n        row_number() over (order by sum(MART__FATPAY.AMOUNT_EUR) desc) as rn\n    from filtered_fatpay as MART__FATPAY\n    left join filtered_groupby as groupby\n        on 1 = 1\n    group by 1 \n),\n\ntop_n as (\n    select \n        grouped,\n        CASE \n            WHEN rn < 20 \n                THEN grouped\n        ELSE 'others' END as GROUPING_TOP_N\n    from pre_top_n\n)\n\nselect \n    top_n.GROUPING_TOP_N as 'grouped',\n    date_trunc(?, MART__FATPAY.CREATED_AT) as 'Created at',\n    count(distinct MART__FATPAY.order_id) as 'Number of total transactions',\n    count(distinct case when status_name = 'complete' then MART__FATPAY.order_id end) as 'Number of complete transactions',\n    count(distinct case when status_name = 'complete' then MART__FATPAY.order_id end) / count(distinct MART__FATPAY.order_id) as 'Acceptance Rate',\n    sum(MART__FATPAY.AMOUNT_EUR) as 'Sum of total transactions',\n    sum(case when status_name = 'complete' then MART__FATPAY.AMOUNT_EUR end) as 'TURNOVER (of complete transactions)'    \nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\nleft join filtered_groupby as groupby\n    on 1 = 1\nleft join top_n\n    on top_n.grouped = CASE \n        WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n            THEN MART__FATPAY.CURRENCY\n        WHEN groupby.fatpay_columns_groupby = 'Status'\n            THEN MART__FATPAY.STATUS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'User Name'\n            THEN MART__FATPAY.USER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Merchant'\n            THEN MART__FATPAY.BUSINESS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Shop'\n            THEN MART__FATPAY.SHOP_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n            THEN MART__FATPAY.DRIVER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n            THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n            THEN MART__FATPAY.CARD_BANK\n        WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n            THEN MART__FATPAY.CARD_BRAND\n        WHEN groupby.fatpay_columns_groupby = 'Card Type'\n            THEN MART__FATPAY.CARD_TYPE\n        WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n            THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n        WHEN groupby.fatpay_columns_groupby = 'Card Country'\n            THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n        WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n            THEN MART__FATPAY.ANTIFRAUD_STATUS\n        WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n            THEN MART__FATPAY.IS_AFT\n        ELSE null \n    END\ngroup by 1, 2\norder by 1, 2"},"results_timezone":"Etc/UTC","format-rows?":true,"results_metadata":{"columns":[{"display_name":"grouped","field_ref":["field","grouped",{"base-type":"type/Text"}],"base_type":"type/Text","effective_type":"type/Text","name":"grouped","semantic_type":null,"fingerprint":{"global":{"distinct-count":20,"nil%":0.0},"type":{"type/Text":{"percent-json":0.0,"percent-url":0.0,"percent-email":0.0,"percent-state":0.0,"average-length":15.15}}}},{"display_name":"Created at","field_ref":["field","Created at",{"base-type":"type/DateTime"}],"base_type":"type/DateTime","effective_type":"type/DateTime","name":"Created at","semantic_type":"type/CreationTimestamp","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/DateTime":{"earliest":"2025-06-09T00:00:00Z","latest":"2025-06-23T00:00:00Z"}}}},{"display_name":"Number of total transactions","field_ref":["field","Number of total transactions",{"base-type":"type/BigInteger"}],"base_type":"type/BigInteger","effective_type":"type/BigInteger","name":"Number of total transactions","semantic_type":"type/Quantity","fingerprint":{"global":{"distinct-count":60,"nil%":0.0},"type":{"type/Number":{"min":9.0,"q1":537.5,"q3":12689.0,"max":27274.0,"sd":7757.983913508709,"avg":7395.266666666666}}}},{"display_name":"Number of complete transactions","field_ref":["field","Number of complete transactions",{"base-type":"type/BigInteger"}],"base_type":"type/BigInteger","effective_type":"type/BigInteger","name":"Number of complete transactions","semantic_type":"type/Quantity","fingerprint":{"global":{"distinct-count":60,"nil%":0.0},"type":{"type/Number":{"min":6.0,"q1":327.5,"q3":7645.5,"max":20767.0,"sd":5448.573129547093,"avg":4789.266666666666}}}},{"display_name":"Acceptance Rate","field_ref":["field","Acceptance Rate",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"Acceptance Rate","semantic_type":"type/Share","fingerprint":{"global":{"distinct-count":59,"nil%":0.0},"type":{"type/Number":{"min":0.38181818181818183,"q1":0.5178168575436539,"q3":0.7055661994754686,"max":0.9153846153846154,"sd":0.126614703414656,"avg":0.6200824517522192}}}},{"display_name":"Sum of total transactions","field_ref":["field","Sum of total transactions",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"Sum of total transactions","semantic_type":null,"fingerprint":{"global":{"distinct-count":60,"nil%":0.0},"type":{"type/Number":{"min":256.09,"q1":69114.48999999999,"q3":972501.1750000002,"max":7650434.010000002,"sd":1580768.5763048264,"avg":944183.1818333331}}}},{"display_name":"TURNOVER (of complete transactions)","field_ref":["field","TURNOVER (of complete transactions)",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"TURNOVER (of complete transactions)","semantic_type":null,"fingerprint":{"global":{"distinct-count":60,"nil%":0.0},"type":{"type/Number":{"min":187.01,"q1":23671.420000000002,"q3":504101.44499999995,"max":4840551.570000001,"sd":1023972.5061825498,"avg":573234.411}}}}]},"insights":[{"previous-value":27028,"unit":"week","offset":1.4806276980950948E7,"last-change":-0.9760248631049282,"col":"Number of total transactions","slope":-730.6285714285008,"last-value":648,"best-fit":["+",1.4806276980950948E7,["*",-730.6285714285008,"x"]]},{"previous-value":15644,"unit":"week","offset":9778622.49880933,"last-change":-0.9755177703912042,"col":"Number of complete transactions","slope":-482.5392857142762,"last-value":383,"best-fit":["+",9778622.49880933,["*",-482.5392857142762,"x"]]},{"previous-value":0.5788071629421341,"unit":"week","offset":-7.123012359422967,"last-change":0.021150774485386204,"col":"Acceptance Rate","slope":3.8228066211677057E-4,"last-value":0.5910493827160493,"best-fit":["*",698.2268829126843,["exp",["*",-3.478990065059693E-4,"x"]]]},{"previous-value":1103003.1700000002,"unit":"week","offset":1.9576304314064505E9,"last-change":-0.9698346923155262,"col":"Sum of total transactions","slope":-96602.62889284707,"last-value":33272.43000000001,"best-fit":["+",1.9576304314064505E9,["*",-96602.62889284707,"x"]]},{"previous-value":566091.88,"unit":"week","offset":1.1958096926282704E9,"last-change":-0.9582386696661327,"col":"TURNOVER (of complete transactions)","slope":-59009.45239285463,"last-value":23640.750000000004,"best-fit":["+",1.1958096926282704E9,["*",-59009.45239285463,"x"]]}]},"cached":null,"database_id":16,"started_at":"2025-06-23T08:42:07.705114609Z","json_query":{"type":"native","database":16,"native":{"query":"with filtered_granularity as (\n    select distinct granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{granularity}}\n          AND granularity is not null\n),\n\nfiltered_groupby as (\n    select distinct fatpay_columns_groupby\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{groupby}}\n          AND fatpay_columns_groupby is not null\n),\n\nfiltered_fatpay as (\n    select *\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        {{CREATED_AT}}\n        and {{CARD_GEOSCHEME}}\n        and {{CARD_COUNTRY}}\n        --and {{STATUS}}\n        and {{BUSINESS_NAME}}\n        and {{USER_NAME}}\n        and {{FIAT_CURRENCY}}\n        and {{ACQUIRER}}\n        and {{CARD_BRAND}}\n        and {{PAYMENT_TERMINAL}}\n        and {{ERROR_GROUP}}\n        and {{ERROR_NAME}}\n        and {{HAS_ID_PROVIDER}}\n        and {{SHOP}}\n        and {{is_aft}}\n        and day(CREATED_AT) <= {{day_number}}\n),\n\npre_top_n as (\n    select \n        CASE \n            WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n                THEN MART__FATPAY.CURRENCY\n            WHEN groupby.fatpay_columns_groupby = 'Status'\n                THEN MART__FATPAY.STATUS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'User Name'\n                THEN MART__FATPAY.USER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Merchant'\n                THEN MART__FATPAY.BUSINESS_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Shop'\n                THEN MART__FATPAY.SHOP_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n                THEN MART__FATPAY.DRIVER_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n                THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n            WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n                THEN MART__FATPAY.CARD_BANK\n            WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n                THEN MART__FATPAY.CARD_BRAND\n            WHEN groupby.fatpay_columns_groupby = 'Card Type'\n                THEN MART__FATPAY.CARD_TYPE\n            WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n                THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n            WHEN groupby.fatpay_columns_groupby = 'Card Country'\n                THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n            WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n                THEN MART__FATPAY.ANTIFRAUD_STATUS\n            WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n                THEN MART__FATPAY.IS_AFT\n            ELSE null \n        END as grouped,\n        row_number() over (order by sum(MART__FATPAY.AMOUNT_EUR) desc) as rn\n    from filtered_fatpay as MART__FATPAY\n    left join filtered_groupby as groupby\n        on 1 = 1\n    group by 1 \n),\n\ntop_n as (\n    select \n        grouped,\n        CASE \n            WHEN rn < {{top_n}} \n                THEN grouped\n        ELSE 'others' END as GROUPING_TOP_N\n    from pre_top_n\n)\n\nselect \n    top_n.GROUPING_TOP_N as 'grouped',\n    date_trunc({{granularity}}, MART__FATPAY.CREATED_AT) as 'Created at',\n    count(distinct MART__FATPAY.order_id) as 'Number of total transactions',\n    count(distinct case when status_name = 'complete' then MART__FATPAY.order_id end) as 'Number of complete transactions',\n    count(distinct case when status_name = 'complete' then MART__FATPAY.order_id end) / count(distinct MART__FATPAY.order_id) as 'Acceptance Rate',\n    sum(MART__FATPAY.AMOUNT_EUR) as 'Sum of total transactions',\n    sum(case when status_name = 'complete' then MART__FATPAY.AMOUNT_EUR end) as 'TURNOVER (of complete transactions)'    \nfrom filtered_fatpay as MART__FATPAY\nleft join filtered_granularity as gran\n    on 1 = 1\nleft join filtered_groupby as groupby\n    on 1 = 1\nleft join top_n\n    on top_n.grouped = CASE \n        WHEN groupby.fatpay_columns_groupby = 'Fiat Currency'\n            THEN MART__FATPAY.CURRENCY\n        WHEN groupby.fatpay_columns_groupby = 'Status'\n            THEN MART__FATPAY.STATUS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'User Name'\n            THEN MART__FATPAY.USER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Merchant'\n            THEN MART__FATPAY.BUSINESS_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Shop'\n            THEN MART__FATPAY.SHOP_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Acquirer'\n            THEN MART__FATPAY.DRIVER_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Payment Terminal'\n            THEN MART__FATPAY.PAYMENT_SYSTEM_NAME\n        WHEN groupby.fatpay_columns_groupby = 'Card Bank'\n            THEN MART__FATPAY.CARD_BANK\n        WHEN groupby.fatpay_columns_groupby = 'Card Brand'\n            THEN MART__FATPAY.CARD_BRAND\n        WHEN groupby.fatpay_columns_groupby = 'Card Type'\n            THEN MART__FATPAY.CARD_TYPE\n        WHEN groupby.fatpay_columns_groupby = 'Card Geoscheme'\n            THEN MART__FATPAY.CARD_GEOSCHEME_BUSINESS\n        WHEN groupby.fatpay_columns_groupby = 'Card Country'\n            THEN MART__FATPAY.CARD_BANK_ISO_COUNTRY\n        WHEN groupby.fatpay_columns_groupby = 'Antifraud Status'\n            THEN MART__FATPAY.ANTIFRAUD_STATUS\n        WHEN groupby.fatpay_columns_groupby = 'Is AFT'\n            THEN MART__FATPAY.IS_AFT\n        ELSE null \n    END\ngroup by 1, 2\norder by 1, 2","template-tags":{"HAS_ID_PROVIDER":{"id":"89fd66a2-56de-fe36-fd6a-e35ccbd7c858","name":"HAS_ID_PROVIDER","display-name":"Has id provider","type":"dimension","dimension":["field",756250,null],"widget-type":"string/=","default":null},"top_n":{"type":"number","name":"top_n","id":"0eb7f1d8-4144-4787-9c6d-b7f9ff5aa138","display-name":"Top N","default":"20","required":true},"CARD_COUNTRY":{"id":"29492df1-225c-ccb0-9a4e-272c5f987ac5","name":"CARD_COUNTRY","display-name":"Card country","type":"dimension","dimension":["field",756254,null],"widget-type":"string/=","default":null},"ERROR_GROUP":{"id":"bb7f9117-7da8-bc24-8190-7626f33e6af0","name":"ERROR_GROUP","display-name":"Error group","type":"dimension","dimension":["field",756269,null],"widget-type":"string/=","default":null},"FIAT_CURRENCY":{"id":"5cab7ad0-e021-f0c5-4e22-a66c43242330","name":"FIAT_CURRENCY","display-name":"Fiat currency","type":"dimension","dimension":["field",756268,null],"widget-type":"string/=","default":null},"is_aft":{"type":"dimension","name":"is_aft","id":"55c0bb9e-e9fc-4738-b7ac-d2e8f30c24bd","display-name":"Is Aft","default":null,"dimension":["field",760549,null],"widget-type":"string/=","options":null},"ERROR_NAME":{"id":"4ed8b652-3c97-6a86-8a35-7a397b6f42ea","name":"ERROR_NAME","display-name":"Error name","type":"dimension","dimension":["field",756230,null],"widget-type":"string/contains","default":null},"PAYMENT_TERMINAL":{"id":"cd9daa34-226e-58e4-673d-7fd1179e7dee","name":"PAYMENT_TERMINAL","display-name":"Payment terminal","type":"dimension","dimension":["field",756239,null],"widget-type":"string/=","default":null},"SHOP":{"id":"9d141b8b-3344-9179-f730-8970a5e2e57e","name":"SHOP","display-name":"Shop","type":"dimension","dimension":["field",756245,null],"widget-type":"string/="},"BUSINESS_NAME":{"id":"1a7ca3c6-ac96-dcc3-dbdc-20e1d3c55320","name":"BUSINESS_NAME","display-name":"Business name","type":"dimension","dimension":["field",756258,null],"widget-type":"string/=","default":null},"day_number":{"type":"number","name":"day_number","id":"892e5ae3-d307-4b08-a060-56f90d1b6f48","display-name":"Month-to-Date Day Number","default":"31","required":true},"granularity":{"id":"37799d21-54a5-2233-9de5-517db3c5bab0","name":"granularity","display-name":"Granularity","type":"text","required":true,"default":"week","values-source-type":"static-list","values-source-config":{"values":[["hour"],["day"],["week"],["month"],["quarter"],["year"]]}},"ACQUIRER":{"id":"0add554f-79fc-6685-f405-66c92af72b79","name":"ACQUIRER","display-name":"Acquirer","type":"dimension","dimension":["field",756224,null],"widget-type":"string/=","default":null},"groupby":{"id":"e17dc612-04b6-9c56-db9b-df98419a776c","name":"groupby","display-name":"Groupby","type":"dimension","default":["Merchant"],"dimension":["field",756658,null],"widget-type":"string/=","required":true},"CREATED_AT":{"id":"7e66dcc1-f9af-d388-5804-ea74427d78fb","name":"CREATED_AT","display-name":"Created at","type":"dimension","dimension":["field",756256,null],"widget-type":"date/all-options","default":"past14days~","required":true},"CARD_GEOSCHEME":{"id":"0d642257-5a4e-bc22-1afa-998bdf910c28","name":"CARD_GEOSCHEME","display-name":"Card geoscheme","type":"dimension","dimension":["field",756227,null],"widget-type":"string/=","default":null},"USER_NAME":{"id":"0ed73475-19ec-3399-0857-ad2c1e797d73","name":"USER_NAME","display-name":"User name","type":"dimension","dimension":["field",756263,null],"widget-type":"string/contains","default":null},"STATUS":{"id":"f05b9ffc-bfb1-f94b-4509-3fa683d56e44","name":"STATUS","display-name":"Status","type":"dimension","dimension":["field",756257,null],"widget-type":"string/=","default":null},"CARD_BRAND":{"id":"45d19436-bb36-cae1-7b66-470806737fb6","name":"CARD_BRAND","display-name":"Card brand","type":"dimension","dimension":["field",756238,null],"widget-type":"string/=","default":null}}},"middleware":{"js-int-to-string?":true,"userland-query?":true,"add-default-userland-constraints?":true}},"average_execution_time":null,"status":"completed","context":"ad-hoc","row_count":60,"running_time":1794}

📝 Validating Question 7/7
--------------------------------------------------
  🔍 Validating Question 4160: 1 Sum of Transactions
    📊 Database ID: 16
    📝 Query Type: native
    🔍 SQL Preview: with filtered_granularity as (
    select granularity
    from MD__FATPAY_DASHBOARD_HELP_TABLE
    w...
    ❌ SQL Error detected in response
    📄 Response: {"data":{"rows":[["2025-06-16T00:00:00Z",2.780232982000001E7],["2025-06-23T00:00:00Z",899962.5000000008],["2025-06-09T00:00:00Z",2.7948698589999985E7]],"cols":[{"display_name":"CREATED_AT","source":"native","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"name":"CREATED_AT","base_type":"type/DateTime","database_type":"DATETIME","effective_type":"type/DateTime"},{"display_name":"SUM_OF_TRANSACTIONS","source":"native","field_ref":["field","SUM_OF_TRANSACTIONS",{"base-type":"type/Float"}],"name":"SUM_OF_TRANSACTIONS","base_type":"type/Float","database_type":"DOUBLE","effective_type":"type/Float"}],"native_form":{"params":["week","2025-06-09T00:00:00Z","2025-06-24T00:00:00Z","week"],"query":"with filtered_granularity as (\n    select granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where ?\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select \n        CREATED_AT,\n        AMOUNT_EUR,\n        ORDER_ID\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        `MART__FATPAY`.`CREATED_AT` >= ? AND `MART__FATPAY`.`CREATED_AT` < ?\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and 1 = 1\n        and day(CREATED_AT) <= 31\n)\n\nselect \n    date_trunc(?, ff.CREATED_AT) as CREATED_AT,\n    sum(ff.AMOUNT_EUR) as SUM_OF_TRANSACTIONS    \nfrom filtered_fatpay as ff\nleft join filtered_granularity as fg\n    on 1 = 1\ngroup by 1"},"results_timezone":"Etc/UTC","format-rows?":true,"results_metadata":{"columns":[{"display_name":"CREATED_AT","field_ref":["field","CREATED_AT",{"base-type":"type/DateTime"}],"base_type":"type/DateTime","effective_type":"type/DateTime","name":"CREATED_AT","semantic_type":"type/CreationTimestamp","fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/DateTime":{"earliest":"2025-06-09T00:00:00Z","latest":"2025-06-23T00:00:00Z"}}}},{"display_name":"SUM_OF_TRANSACTIONS","field_ref":["field","SUM_OF_TRANSACTIONS",{"base-type":"type/Float"}],"base_type":"type/Float","effective_type":"type/Float","name":"SUM_OF_TRANSACTIONS","semantic_type":null,"fingerprint":{"global":{"distinct-count":3,"nil%":0.0},"type":{"type/Number":{"min":899962.5000000008,"q1":7625554.330000004,"q3":2.7912106397499993E7,"max":2.7948698589999985E7,"sd":1.5574513985480165E7,"avg":1.8883663636666667E7}}}}]},"insights":[{"previous-value":null,"unit":null,"offset":3.915260862813307E10,"last-change":null,"col":"SUM_OF_TRANSACTIONS","slope":-1932052.5778571416,"last-value":2.7948698589999985E7,"best-fit":["+",3.915260862813307E10,["*",-1932052.5778571416,"x"]]}]},"cached":null,"database_id":16,"started_at":"2025-06-23T08:42:10.727515247Z","json_query":{"type":"native","database":16,"native":{"query":"with filtered_granularity as (\n    select granularity\n    from MD__FATPAY_DASHBOARD_HELP_TABLE\n    where {{granularity}}\n          AND granularity is not null\n),\n\nfiltered_fatpay as (\n    select \n        CREATED_AT,\n        AMOUNT_EUR,\n        ORDER_ID\n    from MART__FATPAY\n    where -- IS_CARD_BINDING = FALSE and IS_REPEAT = FALSE and \n        {{CREATED_AT}}\n        and {{CARD_GEOSCHEME}}\n        and {{CARD_COUNTRY}}\n        and {{STATUS}}\n        and {{BUSINESS_NAME}}\n        and {{USER_NAME}}\n        and {{FIAT_CURRENCY}}\n        and {{ACQUIRER}}\n        and {{CARD_BRAND}}\n        and {{PAYMENT_TERMINAL}}\n        and {{ERROR_GROUP}}\n        and {{ERROR_NAME}}\n        and {{HAS_ID_PROVIDER}}\n        and {{SHOP}}\n        and {{is_aft}}\n        and day(CREATED_AT) <= {{day_number}}\n)\n\nselect \n    date_trunc({{granularity}}, ff.CREATED_AT) as CREATED_AT,\n    sum(ff.AMOUNT_EUR) as SUM_OF_TRANSACTIONS    \nfrom filtered_fatpay as ff\nleft join filtered_granularity as fg\n    on 1 = 1\ngroup by 1 ","template-tags":{"HAS_ID_PROVIDER":{"id":"3ee32b32-11c5-7dfd-a4b0-fd1cbeefad9e","name":"HAS_ID_PROVIDER","display-name":"Has id provider","type":"dimension","dimension":["field",756250,null],"widget-type":"string/=","default":null},"CARD_COUNTRY":{"id":"716a10f7-f987-2208-4429-4b0598b2432e","name":"CARD_COUNTRY","display-name":"Card country","type":"dimension","dimension":["field",756254,null],"widget-type":"string/=","required":false},"ERROR_GROUP":{"id":"2287bcf2-879d-a509-ecef-f2f375ebe882","name":"ERROR_GROUP","display-name":"Error group","type":"dimension","dimension":["field",756269,null],"widget-type":"string/=","default":null},"FIAT_CURRENCY":{"id":"e734ceda-ef86-ce9c-358a-69566a4c0214","name":"FIAT_CURRENCY","display-name":"Fiat currency","type":"dimension","dimension":["field",756268,null],"widget-type":"string/=","default":null},"is_aft":{"type":"dimension","name":"is_aft","id":"cc3cd05b-e10b-44e4-9b12-1a80eaf110e6","display-name":"Is Aft","default":null,"dimension":["field",760549,null],"widget-type":"string/=","options":null},"ERROR_NAME":{"id":"0f8f7ec3-37a6-f67c-8319-7d255e39e841","name":"ERROR_NAME","display-name":"Error name","type":"dimension","dimension":["field",756230,null],"widget-type":"string/contains","default":null},"PAYMENT_TERMINAL":{"id":"698f65a5-572d-3286-034e-151b59125736","name":"PAYMENT_TERMINAL","display-name":"Payment terminal","type":"dimension","dimension":["field",756239,null],"widget-type":"string/=","default":null},"SHOP":{"id":"934280b5-10eb-a429-15e6-bb62fef9356f","name":"SHOP","display-name":"Shop","type":"dimension","dimension":["field",756245,null],"widget-type":"string/="},"BUSINESS_NAME":{"id":"bd69ce89-a3be-5f0d-90ef-0ad9b70f116e","name":"BUSINESS_NAME","display-name":"Business name","type":"dimension","dimension":["field",756258,null],"widget-type":"string/=","default":null},"day_number":{"type":"number","name":"day_number","id":"42bb79ba-8d73-4d6f-a7e3-e22dcc2c67de","display-name":"Month-to-Date Day Number","default":"31","required":true},"granularity":{"id":"4b095973-b5cb-4c93-c12a-607019dd0fcd","name":"granularity","display-name":"Granularity","type":"text","required":true,"default":"week","values-source-type":"static-list","values-source-config":{"values":[["hour"],["day"],["week"],["month"],["quarter"],["year"]]}},"ACQUIRER":{"id":"bf51e367-ae6b-c409-020c-711538e8ce91","name":"ACQUIRER","display-name":"Acquirer","type":"dimension","dimension":["field",756224,null],"widget-type":"string/=","default":null},"CREATED_AT":{"id":"cf278b54-4f5f-9fbe-23f8-d1a9fdd227db","name":"CREATED_AT","display-name":"Created at","type":"dimension","dimension":["field",756256,null],"widget-type":"date/all-options","default":"past14days~"},"CARD_GEOSCHEME":{"id":"cba17b07-3a17-4612-ce72-00eeddc3d21e","name":"CARD_GEOSCHEME","display-name":"Card geoscheme","type":"dimension","dimension":["field",756227,null],"widget-type":"string/=","required":false},"USER_NAME":{"id":"3e87e7a8-2e29-86a6-c39d-c0f3b183d924","name":"USER_NAME","display-name":"User name","type":"dimension","dimension":["field",756263,null],"widget-type":"string/contains","default":null},"STATUS":{"id":"ce1486eb-801e-0a23-1514-067b67d5aa73","name":"STATUS","display-name":"Status","type":"dimension","dimension":["field",756257,null],"widget-type":"string/=","default":null},"CARD_BRAND":{"id":"54185955-91b6-f816-51dc-f71b45b3fc83","name":"CARD_BRAND","display-name":"Card brand","type":"dimension","dimension":["field",756238,null],"widget-type":"string/=","default":null}}},"middleware":{"js-int-to-string?":true,"userland-query?":true,"add-default-userland-constraints?":true}},"average_execution_time":null,"status":"completed","context":"ad-hoc","row_count":3,"running_time":257}

🎉 Validation Summary:
✅ Successfully validated: 0/7 questions
⚠️  Some questions have issues. Migration may need fixes.
