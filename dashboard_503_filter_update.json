{
  "dashboard_id": 503,
  "dashboard_name": "USA  Data Project ",
  "cards_updated": [],
  "cards_skipped": [],
  "cards_failed": [
    {
      "card_id": 5474,
      "card_name": "Costs",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5474]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@4d00bb1b\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5474]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5474]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Costs\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\",\\n\\nROUND(SUM(zeroifnull(FEE_RISKIFIED_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Riskified\\\",\\nROUND(SUM(zeroifnull(FEE_BLOCKCHAIN_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Blockchain\\\",\\nROUND(SUM(zeroifnull(FEE_ACQUIRER_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Acquirer\\\",\\nROUND(SUM(zeroifnull(ACQUIERER_FX_COST_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Acquirer FX Cost\\\",\\n\\nROUND(SUM(zeroifnull(FEE_MOBILIUM_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Mobilium\\\",\\nROUND(SUM(zeroifnull(FEE_WINPAY_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Winpay\\\",\\nROUND(SUM(zeroifnull(FEE_QUICKO_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Quicko\\\",\\nROUND(SUM(zeroifnull(ZH_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 3) AS \\\"ZH Fee\\\",\\n\\nROUND(SUM(zeroifnull(EXCHANGE_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange Fee\\\",\\nROUND(SUM(zeroifnull(EXCHANGE_FX_COST_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange FX Cost\\\",\\nROUND(SUM(zeroifnull(EXCHANGE_FX_AMOUNT_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange FX Amount\\\",\\nROUND(SUM(zeroifnull(FIREBLOCKS_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fireblocks Fee\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"stackable.stack_type\":\"stacked\",\"graph.y_axis.title_text\":\"Costs\",\"column_settings\":{\"[\\\"name\\\",\\\"Exchange FX Cost\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Acquirer FX Cost\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Exchange Fee\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Blockchain\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Riskified\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Exchange FX Amount\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Winpay\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"ZH Fee\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Acquirer\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fireblocks Fee\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Fee Riskified\",\"Fee Blockchain\",\"Fee Acquirer\",\"Acquirer FX Cost\",\"Fee Mobilium\",\"Fee Winpay\",\"Fee Quicko\",\"ZH Fee\",\"Exchange Fee\",\"Exchange FX Cost\",\"Exchange FX Amount\",\"Fireblocks Fee\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Costs\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\",\\n\\nROUND(SUM(zeroifnull(FEE_RISKIFIED_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Riskified\\\",\\nROUND(SUM(zeroifnull(FEE_BLOCKCHAIN_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Blockchain\\\",\\nROUND(SUM(zeroifnull(FEE_ACQUIRER_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Acquirer\\\",\\nROUND(SUM(zeroifnull(ACQUIERER_FX_COST_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Acquirer FX Cost\\\",\\n\\nROUND(SUM(zeroifnull(FEE_MOBILIUM_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Mobilium\\\",\\nROUND(SUM(zeroifnull(FEE_WINPAY_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Winpay\\\",\\nROUND(SUM(zeroifnull(FEE_QUICKO_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Quicko\\\",\\nROUND(SUM(zeroifnull(ZH_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 3) AS \\\"ZH Fee\\\",\\n\\nROUND(SUM(zeroifnull(EXCHANGE_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange Fee\\\",\\nROUND(SUM(zeroifnull(EXCHANGE_FX_COST_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange FX Cost\\\",\\nROUND(SUM(zeroifnull(EXCHANGE_FX_AMOUNT_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange FX Amount\\\",\\nROUND(SUM(zeroifnull(FIREBLOCKS_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fireblocks Fee\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"stackable.stack_type\":\"stacked\",\"graph.y_axis.title_text\":\"Costs\",\"column_settings\":{\"[\\\"name\\\",\\\"Exchange FX Cost\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Acquirer FX Cost\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Exchange Fee\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Blockchain\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Riskified\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Exchange FX Amount\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Winpay\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"ZH Fee\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Acquirer\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fireblocks Fee\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Fee Riskified\",\"Fee Blockchain\",\"Fee Acquirer\",\"Acquirer FX Cost\",\"Fee Mobilium\",\"Fee Winpay\",\"Fee Quicko\",\"ZH Fee\",\"Exchange Fee\",\"Exchange FX Cost\",\"Exchange FX Amount\",\"Fireblocks Fee\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5474}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5474,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Costs\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\",\\n\\nROUND(SUM(zeroifnull(FEE_RISKIFIED_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Riskified\\\",\\nROUND(SUM(zeroifnull(FEE_BLOCKCHAIN_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Blockchain\\\",\\nROUND(SUM(zeroifnull(FEE_ACQUIRER_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Acquirer\\\",\\nROUND(SUM(zeroifnull(ACQUIERER_FX_COST_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Acquirer FX Cost\\\",\\n\\nROUND(SUM(zeroifnull(FEE_MOBILIUM_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Mobilium\\\",\\nROUND(SUM(zeroifnull(FEE_WINPAY_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Winpay\\\",\\nROUND(SUM(zeroifnull(FEE_QUICKO_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Quicko\\\",\\nROUND(SUM(zeroifnull(ZH_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 3) AS \\\"ZH Fee\\\",\\n\\nROUND(SUM(zeroifnull(EXCHANGE_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange Fee\\\",\\nROUND(SUM(zeroifnull(EXCHANGE_FX_COST_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange FX Cost\\\",\\nROUND(SUM(zeroifnull(EXCHANGE_FX_AMOUNT_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange FX Amount\\\",\\nROUND(SUM(zeroifnull(FIREBLOCKS_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fireblocks Fee\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"stackable.stack_type\":\"stacked\",\"graph.y_axis.title_text\":\"Costs\",\"column_settings\":{\"[\\\"name\\\",\\\"Exchange FX Cost\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Acquirer FX Cost\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Exchange Fee\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Blockchain\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Riskified\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Exchange FX Amount\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Winpay\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"ZH Fee\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Acquirer\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fireblocks Fee\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Fee Riskified\",\"Fee Blockchain\",\"Fee Acquirer\",\"Acquirer FX Cost\",\"Fee Mobilium\",\"Fee Winpay\",\"Fee Quicko\",\"ZH Fee\",\"Exchange Fee\",\"Exchange FX Cost\",\"Exchange FX Amount\",\"Fireblocks Fee\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5474]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@4d00bb1b\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5474]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5474]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Costs\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\",\\n\\nROUND(SUM(zeroifnull(FEE_RISKIFIED_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Riskified\\\",\\nROUND(SUM(zeroifnull(FEE_BLOCKCHAIN_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Blockchain\\\",\\nROUND(SUM(zeroifnull(FEE_ACQUIRER_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Acquirer\\\",\\nROUND(SUM(zeroifnull(ACQUIERER_FX_COST_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Acquirer FX Cost\\\",\\n\\nROUND(SUM(zeroifnull(FEE_MOBILIUM_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Mobilium\\\",\\nROUND(SUM(zeroifnull(FEE_WINPAY_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Winpay\\\",\\nROUND(SUM(zeroifnull(FEE_QUICKO_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Quicko\\\",\\nROUND(SUM(zeroifnull(ZH_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 3) AS \\\"ZH Fee\\\",\\n\\nROUND(SUM(zeroifnull(EXCHANGE_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange Fee\\\",\\nROUND(SUM(zeroifnull(EXCHANGE_FX_COST_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange FX Cost\\\",\\nROUND(SUM(zeroifnull(EXCHANGE_FX_AMOUNT_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange FX Amount\\\",\\nROUND(SUM(zeroifnull(FIREBLOCKS_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fireblocks Fee\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"stackable.stack_type\":\"stacked\",\"graph.y_axis.title_text\":\"Costs\",\"column_settings\":{\"[\\\"name\\\",\\\"Exchange FX Cost\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Acquirer FX Cost\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Exchange Fee\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Blockchain\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Riskified\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Exchange FX Amount\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Winpay\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"ZH Fee\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Acquirer\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fireblocks Fee\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Fee Riskified\",\"Fee Blockchain\",\"Fee Acquirer\",\"Acquirer FX Cost\",\"Fee Mobilium\",\"Fee Winpay\",\"Fee Quicko\",\"ZH Fee\",\"Exchange Fee\",\"Exchange FX Cost\",\"Exchange FX Amount\",\"Fireblocks Fee\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Costs\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\",\\n\\nROUND(SUM(zeroifnull(FEE_RISKIFIED_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Riskified\\\",\\nROUND(SUM(zeroifnull(FEE_BLOCKCHAIN_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Blockchain\\\",\\nROUND(SUM(zeroifnull(FEE_ACQUIRER_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Acquirer\\\",\\nROUND(SUM(zeroifnull(ACQUIERER_FX_COST_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Acquirer FX Cost\\\",\\n\\nROUND(SUM(zeroifnull(FEE_MOBILIUM_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Mobilium\\\",\\nROUND(SUM(zeroifnull(FEE_WINPAY_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Winpay\\\",\\nROUND(SUM(zeroifnull(FEE_QUICKO_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Quicko\\\",\\nROUND(SUM(zeroifnull(ZH_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 3) AS \\\"ZH Fee\\\",\\n\\nROUND(SUM(zeroifnull(EXCHANGE_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange Fee\\\",\\nROUND(SUM(zeroifnull(EXCHANGE_FX_COST_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange FX Cost\\\",\\nROUND(SUM(zeroifnull(EXCHANGE_FX_AMOUNT_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange FX Amount\\\",\\nROUND(SUM(zeroifnull(FIREBLOCKS_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fireblocks Fee\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"stackable.stack_type\":\"stacked\",\"graph.y_axis.title_text\":\"Costs\",\"column_settings\":{\"[\\\"name\\\",\\\"Exchange FX Cost\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Acquirer FX Cost\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Exchange Fee\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Blockchain\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Riskified\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Exchange FX Amount\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Winpay\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"ZH Fee\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Acquirer\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fireblocks Fee\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Fee Riskified\",\"Fee Blockchain\",\"Fee Acquirer\",\"Acquirer FX Cost\",\"Fee Mobilium\",\"Fee Winpay\",\"Fee Quicko\",\"ZH Fee\",\"Exchange Fee\",\"Exchange FX Cost\",\"Exchange FX Amount\",\"Fireblocks Fee\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5474}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5474,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Costs\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\",\\n\\nROUND(SUM(zeroifnull(FEE_RISKIFIED_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Riskified\\\",\\nROUND(SUM(zeroifnull(FEE_BLOCKCHAIN_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Blockchain\\\",\\nROUND(SUM(zeroifnull(FEE_ACQUIRER_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Acquirer\\\",\\nROUND(SUM(zeroifnull(ACQUIERER_FX_COST_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Acquirer FX Cost\\\",\\n\\nROUND(SUM(zeroifnull(FEE_MOBILIUM_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Mobilium\\\",\\nROUND(SUM(zeroifnull(FEE_WINPAY_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Winpay\\\",\\nROUND(SUM(zeroifnull(FEE_QUICKO_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fee Quicko\\\",\\nROUND(SUM(zeroifnull(ZH_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 3) AS \\\"ZH Fee\\\",\\n\\nROUND(SUM(zeroifnull(EXCHANGE_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange Fee\\\",\\nROUND(SUM(zeroifnull(EXCHANGE_FX_COST_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange FX Cost\\\",\\nROUND(SUM(zeroifnull(EXCHANGE_FX_AMOUNT_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Exchange FX Amount\\\",\\nROUND(SUM(zeroifnull(FIREBLOCKS_FEE_EUR) * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Fireblocks Fee\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"stackable.stack_type\":\"stacked\",\"graph.y_axis.title_text\":\"Costs\",\"column_settings\":{\"[\\\"name\\\",\\\"Exchange FX Cost\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Acquirer FX Cost\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Exchange Fee\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Blockchain\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Riskified\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Exchange FX Amount\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Winpay\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"ZH Fee\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fee Acquirer\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Fireblocks Fee\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Fee Riskified\",\"Fee Blockchain\",\"Fee Acquirer\",\"Acquirer FX Cost\",\"Fee Mobilium\",\"Fee Winpay\",\"Fee Quicko\",\"ZH Fee\",\"Exchange Fee\",\"Exchange FX Cost\",\"Exchange FX Amount\",\"Fireblocks Fee\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5489,
      "card_name": "GMV",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5489]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@6b7500d\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5489]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5489]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n\\n, round(sum(TRANSACTIONS.GMV_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS GMV\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n\\n, round(sum(TRANSACTIONS.GMV_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS GMV\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5489}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5489,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n\\n, round(sum(TRANSACTIONS.GMV_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS GMV\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5489]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@6b7500d\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5489]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5489]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n\\n, round(sum(TRANSACTIONS.GMV_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS GMV\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n\\n, round(sum(TRANSACTIONS.GMV_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS GMV\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5489}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5489,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n\\n, round(sum(TRANSACTIONS.GMV_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS GMV\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5471,
      "card_name": "GMV detailing",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5471]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@404bc4d\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5471]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5471]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.GMV_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS GMV\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"GMV ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.GMV_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS GMV\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"GMV ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5471}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5471,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.GMV_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS GMV\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"GMV ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5471]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@404bc4d\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5471]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5471]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.GMV_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS GMV\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"GMV ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.GMV_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS GMV\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"GMV ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5471}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5471,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.GMV_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS GMV\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"GMV ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5471,
      "card_name": "GMV detailing",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5471]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@4e93c6af\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5471]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5471]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.GMV_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS GMV\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"GMV ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.GMV_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS GMV\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"GMV ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5471}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5471,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.GMV_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS GMV\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"GMV ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5471]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@4e93c6af\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5471]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5471]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.GMV_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS GMV\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"GMV ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.GMV_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS GMV\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"GMV ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5471}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5471,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"GMV detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.GMV_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS GMV\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"GMV ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"GMV\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5477,
      "card_name": "Turnover detailing",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5477]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@34a0da33\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5477]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5477]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Turnover detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.TURNOVER_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Turnover ($)\\\"\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"Turnover ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"Turnover ($)\\\"]\":{\"number_style\":\"currency\",\"currency\":\"USD\",\"decimals\":0}},\"graph.metrics\":[\"Turnover ($)\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Turnover detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.TURNOVER_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Turnover ($)\\\"\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"Turnover ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"Turnover ($)\\\"]\":{\"number_style\":\"currency\",\"currency\":\"USD\",\"decimals\":0}},\"graph.metrics\":[\"Turnover ($)\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5477}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5477,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Turnover detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.TURNOVER_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Turnover ($)\\\"\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"Turnover ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"Turnover ($)\\\"]\":{\"number_style\":\"currency\",\"currency\":\"USD\",\"decimals\":0}},\"graph.metrics\":[\"Turnover ($)\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5477]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@34a0da33\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5477]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5477]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Turnover detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.TURNOVER_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Turnover ($)\\\"\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"Turnover ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"Turnover ($)\\\"]\":{\"number_style\":\"currency\",\"currency\":\"USD\",\"decimals\":0}},\"graph.metrics\":[\"Turnover ($)\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Turnover detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.TURNOVER_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Turnover ($)\\\"\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"Turnover ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"Turnover ($)\\\"]\":{\"number_style\":\"currency\",\"currency\":\"USD\",\"decimals\":0}},\"graph.metrics\":[\"Turnover ($)\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5477}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5477,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Turnover detailing\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"top\":{\"type\":\"number\",\"name\":\"top\",\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"display-name\":\"Top\",\"default\":\"5\",\"widget-type\":null,\"required\":true},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"display-name\":\"Widget Partner Name\",\"default\":null,\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/month-year\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH cte AS (\\n    SELECT \\n        WIDGET_PARTNER_NAME, \\n        SUM(turnover_eur) AS total_turnover\\n    FROM mart.TRANSACTIONS \\n    GROUP BY WIDGET_PARTNER_NAME\\n    ORDER BY total_turnover DESC\\n    LIMIT {{top}}\\n)\\n\\nSELECT  \\n    DATE_TRUNC('day', TRANSACTIONS.CREATED_AT) AS \\\"Date\\\",\\n    CASE \\n        WHEN c.WIDGET_PARTNER_NAME IS NOT NULL THEN TRANSACTIONS.WIDGET_PARTNER_NAME \\n        ELSE 'other' \\n    END AS WIDGET_PARTNER_NAME,\\n    ROUND(SUM(TRANSACTIONS.TURNOVER_EUR * CAST(rr.RATE AS DECIMAL(18,6))), 0) AS \\\"Turnover ($)\\\"\\nFROM MART.TRANSACTIONS \\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART rr\\n    ON rr.FROM_CURRENCY = 'EUR' \\n    AND rr.TO_CURRENCY = 'USD' \\n    AND rr.dt = DATE_TRUNC('day', TRANSACTIONS.CREATED_AT)\\n    AND rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nLEFT JOIN cte c \\n    ON c.WIDGET_PARTNER_NAME = TRANSACTIONS.WIDGET_PARTNER_NAME                                  \\nWHERE TRANSACTIONS.CREATED_AT >= '2025-01-01' \\n  AND TRANSACTIONS.{{CARD_ISOCOUNTRY}} \\n  AND TRANSACTIONS.CONFIRMED \\n  AND TRANSACTIONS.TYPE_MAIN = 'buy' \\n  AND TRANSACTIONS.SOURCE_MAIN = 'widget'\\n  AND {{CREATED_AT}} \\n  AND {{PAY_SYSTEM}} \\n  AND {{WIDGET_PARTNER_NAME}} \\n  AND {{CURRENCY}} \\n  AND {{CRYPTO}} \\n  AND {{TYPE}} \\n  AND {{CARD_BIN}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"stackable.stack_type\":\"stacked\",\"graph.dimensions\":[\"Date\",\"WIDGET_PARTNER_NAME\"],\"graph.show_values\":true,\"graph.y_axis.title_text\":\"Turnover ($)\",\"column_settings\":{\"[\\\"name\\\",\\\"Turnover ($)\\\"]\":{\"number_style\":\"currency\",\"currency\":\"USD\",\"decimals\":0}},\"graph.metrics\":[\"Turnover ($)\"]},\"parameters\":[{\"id\":\"ff255aac-5913-4467-bee8-af20e28d89f2\",\"type\":\"date/month-year\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d0190c8a-1943-4c38-bb8f-7afe56a35b5a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"ca334719-4ba6-4652-b418-d2f187da77de\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a8d74414-5897-498b-a1ae-3d6aca42cb7f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"97a2acf6-cf3f-497c-af06-d3cad623c11b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"97e666dd-1531-4d0b-be22-3f86ac0bf53b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"75b22b26-d5a9-49c5-bd62-4543c991750c\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}},{\"id\":\"4207f4a3-44d5-49da-bcb3-b2edec38c6e1\",\"type\":\"number/=\",\"target\":[\"variable\",[\"template-tag\",\"top\"]],\"name\":\"Top\",\"slug\":\"top\",\"default\":\"5\",\"required\":true}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5469,
      "card_name": "Turnover",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5469]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@22f80572\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5469]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5469]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, round(sum(TRANSACTIONS.TURNOVER_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS \\\"TURNOVER ($)\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"TURNOVER ($)\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"TURNOVER ($)\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, round(sum(TRANSACTIONS.TURNOVER_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS \\\"TURNOVER ($)\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"TURNOVER ($)\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"TURNOVER ($)\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5469}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5469,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, round(sum(TRANSACTIONS.TURNOVER_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS \\\"TURNOVER ($)\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"TURNOVER ($)\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"TURNOVER ($)\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5469]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@22f80572\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5469]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5469]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, round(sum(TRANSACTIONS.TURNOVER_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS \\\"TURNOVER ($)\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"TURNOVER ($)\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"TURNOVER ($)\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, round(sum(TRANSACTIONS.TURNOVER_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS \\\"TURNOVER ($)\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"TURNOVER ($)\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"TURNOVER ($)\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5469}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5469,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, round(sum(TRANSACTIONS.TURNOVER_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS \\\"TURNOVER ($)\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"TURNOVER ($)\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"TURNOVER ($)\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5473,
      "card_name": "MAU OOR",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5473]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@76f2eebf\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5473]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5473]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"MAU OOR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"partner\":{\"id\":\"57da5e94-6636-9a43-d752-77c7e3e7dcb3\",\"name\":\"partner\",\"display-name\":\"Partner\",\"type\":\"dimension\",\"dimension\":[\"field\",402,null],\"widget-type\":\"string/=\",\"default\":null},\"USR_COUNTRY_ENG\":{\"id\":\"f5a6e879-eefb-de54-2b7c-df1acd59585f\",\"name\":\"USR_COUNTRY_ENG\",\"display-name\":\"Country\",\"type\":\"dimension\",\"dimension\":[\"field\",874,null],\"widget-type\":\"string/=\",\"default\":null},\"USR_GEOSCHEME_ENG\":{\"id\":\"78227215-b161-1990-a2db-d40e170bde9b\",\"name\":\"USR_GEOSCHEME_ENG\",\"display-name\":\"Geoscheme\",\"type\":\"dimension\",\"dimension\":[\"field\",876,null],\"widget-type\":\"string/=\",\"default\":null},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"WITH all_calc as (\\r\\n    select c.CREATED_AT\\r\\n         , PARTNER_NAME\\r\\n         , USR_COUNTRY_ENG\\r\\n         , USR_GEOSCHEME_ENG\\r\\n         , c.USER_ID\\r\\n         , case when c.kyc_status is not null \\r\\n             then true \\r\\n             else false end USER_AUTHORIZED\\r\\n         , FALSE AS HAS_TRANSACTION\\r\\n         , FALSE AS CONFIRMED\\r\\n    from REPLICA.WEBAPP_WIDGET_CALCULATIONS_LOG as c\\r\\n    inner join MART.WIDGETS as w on w.id = c.WIDGET_ID\\r\\n    inner join MART.USERS as u on u.USER_ID = c.USER_ID\\r\\n    where c.CREATED_AT >= add_months(date_trunc('month', now()), -6)\\r\\n\\r\\n    union\\r\\n\\r\\n    select tr.CREATED_AT\\r\\n         , tr.WIDGET_PARTNER_NAME                                          as PARTNER_NAME\\r\\n         , coalesce(CARD_ISOCOUNTRY, COUNTRY_NAME_EN, USR_COUNTRY_ENG)     as USR_COUNTRY_ENG\\r\\n         , coalesce(CARD_GEOSCHEME, GEOSCHEME_BUSINESS, USR_GEOSCHEME_ENG) as USR_GEOSCHEME_ENG\\r\\n         , tr.USER_ID\\r\\n         , TRUE                                                            AS USER_AUTHORIZED\\r\\n         , TRUE                                                            AS HAS_TRANSACTION\\r\\n         , CONFIRMED\\r\\n    from MART.TRANSACTIONS as tr\\r\\n             left join md.COUNTRY_CODES as cc on lower(cc.COUNTRY_CODE_ALPHA_3) =\\r\\n                                                 lower(tr.LOCATION_COUNTRY)\\r\\n             inner join MART.USERS as u on u.USER_ID = tr.USER_ID\\r\\n    where tr.CREATED_AT >= add_months(date_trunc('month', now()), -6)\\r\\n      and tr.WIDGET_ID is not null\\r\\n      and TYPE_MAIN in ('buy', 'sell')\\r\\n    ),\\r\\n  group_us as (\\r\\n      select date_trunc('month', all_calc.CREATED_AT)  AS created_dt\\r\\n           , USER_ID\\r\\n           , USER_AUTHORIZED \\r\\n           , HAS_TRANSACTION\\r\\n           , CONFIRMED\\r\\n      from all_calc\\r\\n      inner join MART.widgets on MART.widgets.PARTNER_NAME = all_calc.PARTNER_NAME\\r\\n      inner join MD.COUNTRY_CODES on MD.COUNTRY_CODES.COUNTRY_NAME_EN = all_calc.USR_COUNTRY_ENG\\r\\n      where {{partner}} and {{USR_COUNTRY_ENG}} and {{USR_GEOSCHEME_ENG}} \\r\\n      ), \\r\\n  all_u as (\\r\\n      select created_dt\\r\\n           , 'create calculation'       AS type\\r\\n           , count(distinct USER_ID)    AS DAU\\r\\n      from group_us and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.dimensions\":[\"CREATED_DT\",\"TYPE\"],\"graph.y_axis.title_text\":\"Count users\",\"graph.metrics\":[\"DAU\"]},\"parameters\":[{\"id\":\"57da5e94-6636-9a43-d752-77c7e3e7dcb3\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"partner\"]],\"name\":\"Partner\",\"slug\":\"partner\"},{\"id\":\"f5a6e879-eefb-de54-2b7c-df1acd59585f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"USR_COUNTRY_ENG\"]],\"name\":\"Country\",\"slug\":\"USR_COUNTRY_ENG\"},{\"id\":\"78227215-b161-1990-a2db-d40e170bde9b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"USR_GEOSCHEME_ENG\"]],\"name\":\"Geoscheme\",\"slug\":\"USR_GEOSCHEME_ENG\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"MAU OOR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"partner\":{\"id\":\"57da5e94-6636-9a43-d752-77c7e3e7dcb3\",\"name\":\"partner\",\"display-name\":\"Partner\",\"type\":\"dimension\",\"dimension\":[\"field\",402,null],\"widget-type\":\"string/=\",\"default\":null},\"USR_COUNTRY_ENG\":{\"id\":\"f5a6e879-eefb-de54-2b7c-df1acd59585f\",\"name\":\"USR_COUNTRY_ENG\",\"display-name\":\"Country\",\"type\":\"dimension\",\"dimension\":[\"field\",874,null],\"widget-type\":\"string/=\",\"default\":null},\"USR_GEOSCHEME_ENG\":{\"id\":\"78227215-b161-1990-a2db-d40e170bde9b\",\"name\":\"USR_GEOSCHEME_ENG\",\"display-name\":\"Geoscheme\",\"type\":\"dimension\",\"dimension\":[\"field\",876,null],\"widget-type\":\"string/=\",\"default\":null},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"WITH all_calc as (\\r\\n    select c.CREATED_AT\\r\\n         , PARTNER_NAME\\r\\n         , USR_COUNTRY_ENG\\r\\n         , USR_GEOSCHEME_ENG\\r\\n         , c.USER_ID\\r\\n         , case when c.kyc_status is not null \\r\\n             then true \\r\\n             else false end USER_AUTHORIZED\\r\\n         , FALSE AS HAS_TRANSACTION\\r\\n         , FALSE AS CONFIRMED\\r\\n    from REPLICA.WEBAPP_WIDGET_CALCULATIONS_LOG as c\\r\\n    inner join MART.WIDGETS as w on w.id = c.WIDGET_ID\\r\\n    inner join MART.USERS as u on u.USER_ID = c.USER_ID\\r\\n    where c.CREATED_AT >= add_months(date_trunc('month', now()), -6)\\r\\n\\r\\n    union\\r\\n\\r\\n    select tr.CREATED_AT\\r\\n         , tr.WIDGET_PARTNER_NAME                                          as PARTNER_NAME\\r\\n         , coalesce(CARD_ISOCOUNTRY, COUNTRY_NAME_EN, USR_COUNTRY_ENG)     as USR_COUNTRY_ENG\\r\\n         , coalesce(CARD_GEOSCHEME, GEOSCHEME_BUSINESS, USR_GEOSCHEME_ENG) as USR_GEOSCHEME_ENG\\r\\n         , tr.USER_ID\\r\\n         , TRUE                                                            AS USER_AUTHORIZED\\r\\n         , TRUE                                                            AS HAS_TRANSACTION\\r\\n         , CONFIRMED\\r\\n    from MART.TRANSACTIONS as tr\\r\\n             left join md.COUNTRY_CODES as cc on lower(cc.COUNTRY_CODE_ALPHA_3) =\\r\\n                                                 lower(tr.LOCATION_COUNTRY)\\r\\n             inner join MART.USERS as u on u.USER_ID = tr.USER_ID\\r\\n    where tr.CREATED_AT >= add_months(date_trunc('month', now()), -6)\\r\\n      and tr.WIDGET_ID is not null\\r\\n      and TYPE_MAIN in ('buy', 'sell')\\r\\n    ),\\r\\n  group_us as (\\r\\n      select date_trunc('month', all_calc.CREATED_AT)  AS created_dt\\r\\n           , USER_ID\\r\\n           , USER_AUTHORIZED \\r\\n           , HAS_TRANSACTION\\r\\n           , CONFIRMED\\r\\n      from all_calc\\r\\n      inner join MART.widgets on MART.widgets.PARTNER_NAME = all_calc.PARTNER_NAME\\r\\n      inner join MD.COUNTRY_CODES on MD.COUNTRY_CODES.COUNTRY_NAME_EN = all_calc.USR_COUNTRY_ENG\\r\\n      where {{partner}} and {{USR_COUNTRY_ENG}} and {{USR_GEOSCHEME_ENG}} \\r\\n      ), \\r\\n  all_u as (\\r\\n      select created_dt\\r\\n           , 'create calculation'       AS type\\r\\n           , count(distinct USER_ID)    AS DAU\\r\\n      from group_us and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.dimensions\":[\"CREATED_DT\",\"TYPE\"],\"graph.y_axis.title_text\":\"Count users\",\"graph.metrics\":[\"DAU\"]},\"parameters\":[{\"id\":\"57da5e94-6636-9a43-d752-77c7e3e7dcb3\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"partner\"]],\"name\":\"Partner\",\"slug\":\"partner\"},{\"id\":\"f5a6e879-eefb-de54-2b7c-df1acd59585f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"USR_COUNTRY_ENG\"]],\"name\":\"Country\",\"slug\":\"USR_COUNTRY_ENG\"},{\"id\":\"78227215-b161-1990-a2db-d40e170bde9b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"USR_GEOSCHEME_ENG\"]],\"name\":\"Geoscheme\",\"slug\":\"USR_GEOSCHEME_ENG\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5473}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5473,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"MAU OOR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"partner\":{\"id\":\"57da5e94-6636-9a43-d752-77c7e3e7dcb3\",\"name\":\"partner\",\"display-name\":\"Partner\",\"type\":\"dimension\",\"dimension\":[\"field\",402,null],\"widget-type\":\"string/=\",\"default\":null},\"USR_COUNTRY_ENG\":{\"id\":\"f5a6e879-eefb-de54-2b7c-df1acd59585f\",\"name\":\"USR_COUNTRY_ENG\",\"display-name\":\"Country\",\"type\":\"dimension\",\"dimension\":[\"field\",874,null],\"widget-type\":\"string/=\",\"default\":null},\"USR_GEOSCHEME_ENG\":{\"id\":\"78227215-b161-1990-a2db-d40e170bde9b\",\"name\":\"USR_GEOSCHEME_ENG\",\"display-name\":\"Geoscheme\",\"type\":\"dimension\",\"dimension\":[\"field\",876,null],\"widget-type\":\"string/=\",\"default\":null},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"WITH all_calc as (\\r\\n    select c.CREATED_AT\\r\\n         , PARTNER_NAME\\r\\n         , USR_COUNTRY_ENG\\r\\n         , USR_GEOSCHEME_ENG\\r\\n         , c.USER_ID\\r\\n         , case when c.kyc_status is not null \\r\\n             then true \\r\\n             else false end USER_AUTHORIZED\\r\\n         , FALSE AS HAS_TRANSACTION\\r\\n         , FALSE AS CONFIRMED\\r\\n    from REPLICA.WEBAPP_WIDGET_CALCULATIONS_LOG as c\\r\\n    inner join MART.WIDGETS as w on w.id = c.WIDGET_ID\\r\\n    inner join MART.USERS as u on u.USER_ID = c.USER_ID\\r\\n    where c.CREATED_AT >= add_months(date_trunc('month', now()), -6)\\r\\n\\r\\n    union\\r\\n\\r\\n    select tr.CREATED_AT\\r\\n         , tr.WIDGET_PARTNER_NAME                                          as PARTNER_NAME\\r\\n         , coalesce(CARD_ISOCOUNTRY, COUNTRY_NAME_EN, USR_COUNTRY_ENG)     as USR_COUNTRY_ENG\\r\\n         , coalesce(CARD_GEOSCHEME, GEOSCHEME_BUSINESS, USR_GEOSCHEME_ENG) as USR_GEOSCHEME_ENG\\r\\n         , tr.USER_ID\\r\\n         , TRUE                                                            AS USER_AUTHORIZED\\r\\n         , TRUE                                                            AS HAS_TRANSACTION\\r\\n         , CONFIRMED\\r\\n    from MART.TRANSACTIONS as tr\\r\\n             left join md.COUNTRY_CODES as cc on lower(cc.COUNTRY_CODE_ALPHA_3) =\\r\\n                                                 lower(tr.LOCATION_COUNTRY)\\r\\n             inner join MART.USERS as u on u.USER_ID = tr.USER_ID\\r\\n    where tr.CREATED_AT >= add_months(date_trunc('month', now()), -6)\\r\\n      and tr.WIDGET_ID is not null\\r\\n      and TYPE_MAIN in ('buy', 'sell')\\r\\n    ),\\r\\n  group_us as (\\r\\n      select date_trunc('month', all_calc.CREATED_AT)  AS created_dt\\r\\n           , USER_ID\\r\\n           , USER_AUTHORIZED \\r\\n           , HAS_TRANSACTION\\r\\n           , CONFIRMED\\r\\n      from all_calc\\r\\n      inner join MART.widgets on MART.widgets.PARTNER_NAME = all_calc.PARTNER_NAME\\r\\n      inner join MD.COUNTRY_CODES on MD.COUNTRY_CODES.COUNTRY_NAME_EN = all_calc.USR_COUNTRY_ENG\\r\\n      where {{partner}} and {{USR_COUNTRY_ENG}} and {{USR_GEOSCHEME_ENG}} \\r\\n      ), \\r\\n  all_u as (\\r\\n      select created_dt\\r\\n           , 'create calculation'       AS type\\r\\n           , count(distinct USER_ID)    AS DAU\\r\\n      from group_us and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.dimensions\":[\"CREATED_DT\",\"TYPE\"],\"graph.y_axis.title_text\":\"Count users\",\"graph.metrics\":[\"DAU\"]},\"parameters\":[{\"id\":\"57da5e94-6636-9a43-d752-77c7e3e7dcb3\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"partner\"]],\"name\":\"Partner\",\"slug\":\"partner\"},{\"id\":\"f5a6e879-eefb-de54-2b7c-df1acd59585f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"USR_COUNTRY_ENG\"]],\"name\":\"Country\",\"slug\":\"USR_COUNTRY_ENG\"},{\"id\":\"78227215-b161-1990-a2db-d40e170bde9b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"USR_GEOSCHEME_ENG\"]],\"name\":\"Geoscheme\",\"slug\":\"USR_GEOSCHEME_ENG\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5473]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@76f2eebf\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5473]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5473]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"MAU OOR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"partner\":{\"id\":\"57da5e94-6636-9a43-d752-77c7e3e7dcb3\",\"name\":\"partner\",\"display-name\":\"Partner\",\"type\":\"dimension\",\"dimension\":[\"field\",402,null],\"widget-type\":\"string/=\",\"default\":null},\"USR_COUNTRY_ENG\":{\"id\":\"f5a6e879-eefb-de54-2b7c-df1acd59585f\",\"name\":\"USR_COUNTRY_ENG\",\"display-name\":\"Country\",\"type\":\"dimension\",\"dimension\":[\"field\",874,null],\"widget-type\":\"string/=\",\"default\":null},\"USR_GEOSCHEME_ENG\":{\"id\":\"78227215-b161-1990-a2db-d40e170bde9b\",\"name\":\"USR_GEOSCHEME_ENG\",\"display-name\":\"Geoscheme\",\"type\":\"dimension\",\"dimension\":[\"field\",876,null],\"widget-type\":\"string/=\",\"default\":null},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"WITH all_calc as (\\r\\n    select c.CREATED_AT\\r\\n         , PARTNER_NAME\\r\\n         , USR_COUNTRY_ENG\\r\\n         , USR_GEOSCHEME_ENG\\r\\n         , c.USER_ID\\r\\n         , case when c.kyc_status is not null \\r\\n             then true \\r\\n             else false end USER_AUTHORIZED\\r\\n         , FALSE AS HAS_TRANSACTION\\r\\n         , FALSE AS CONFIRMED\\r\\n    from REPLICA.WEBAPP_WIDGET_CALCULATIONS_LOG as c\\r\\n    inner join MART.WIDGETS as w on w.id = c.WIDGET_ID\\r\\n    inner join MART.USERS as u on u.USER_ID = c.USER_ID\\r\\n    where c.CREATED_AT >= add_months(date_trunc('month', now()), -6)\\r\\n\\r\\n    union\\r\\n\\r\\n    select tr.CREATED_AT\\r\\n         , tr.WIDGET_PARTNER_NAME                                          as PARTNER_NAME\\r\\n         , coalesce(CARD_ISOCOUNTRY, COUNTRY_NAME_EN, USR_COUNTRY_ENG)     as USR_COUNTRY_ENG\\r\\n         , coalesce(CARD_GEOSCHEME, GEOSCHEME_BUSINESS, USR_GEOSCHEME_ENG) as USR_GEOSCHEME_ENG\\r\\n         , tr.USER_ID\\r\\n         , TRUE                                                            AS USER_AUTHORIZED\\r\\n         , TRUE                                                            AS HAS_TRANSACTION\\r\\n         , CONFIRMED\\r\\n    from MART.TRANSACTIONS as tr\\r\\n             left join md.COUNTRY_CODES as cc on lower(cc.COUNTRY_CODE_ALPHA_3) =\\r\\n                                                 lower(tr.LOCATION_COUNTRY)\\r\\n             inner join MART.USERS as u on u.USER_ID = tr.USER_ID\\r\\n    where tr.CREATED_AT >= add_months(date_trunc('month', now()), -6)\\r\\n      and tr.WIDGET_ID is not null\\r\\n      and TYPE_MAIN in ('buy', 'sell')\\r\\n    ),\\r\\n  group_us as (\\r\\n      select date_trunc('month', all_calc.CREATED_AT)  AS created_dt\\r\\n           , USER_ID\\r\\n           , USER_AUTHORIZED \\r\\n           , HAS_TRANSACTION\\r\\n           , CONFIRMED\\r\\n      from all_calc\\r\\n      inner join MART.widgets on MART.widgets.PARTNER_NAME = all_calc.PARTNER_NAME\\r\\n      inner join MD.COUNTRY_CODES on MD.COUNTRY_CODES.COUNTRY_NAME_EN = all_calc.USR_COUNTRY_ENG\\r\\n      where {{partner}} and {{USR_COUNTRY_ENG}} and {{USR_GEOSCHEME_ENG}} \\r\\n      ), \\r\\n  all_u as (\\r\\n      select created_dt\\r\\n           , 'create calculation'       AS type\\r\\n           , count(distinct USER_ID)    AS DAU\\r\\n      from group_us and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.dimensions\":[\"CREATED_DT\",\"TYPE\"],\"graph.y_axis.title_text\":\"Count users\",\"graph.metrics\":[\"DAU\"]},\"parameters\":[{\"id\":\"57da5e94-6636-9a43-d752-77c7e3e7dcb3\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"partner\"]],\"name\":\"Partner\",\"slug\":\"partner\"},{\"id\":\"f5a6e879-eefb-de54-2b7c-df1acd59585f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"USR_COUNTRY_ENG\"]],\"name\":\"Country\",\"slug\":\"USR_COUNTRY_ENG\"},{\"id\":\"78227215-b161-1990-a2db-d40e170bde9b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"USR_GEOSCHEME_ENG\"]],\"name\":\"Geoscheme\",\"slug\":\"USR_GEOSCHEME_ENG\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"MAU OOR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"partner\":{\"id\":\"57da5e94-6636-9a43-d752-77c7e3e7dcb3\",\"name\":\"partner\",\"display-name\":\"Partner\",\"type\":\"dimension\",\"dimension\":[\"field\",402,null],\"widget-type\":\"string/=\",\"default\":null},\"USR_COUNTRY_ENG\":{\"id\":\"f5a6e879-eefb-de54-2b7c-df1acd59585f\",\"name\":\"USR_COUNTRY_ENG\",\"display-name\":\"Country\",\"type\":\"dimension\",\"dimension\":[\"field\",874,null],\"widget-type\":\"string/=\",\"default\":null},\"USR_GEOSCHEME_ENG\":{\"id\":\"78227215-b161-1990-a2db-d40e170bde9b\",\"name\":\"USR_GEOSCHEME_ENG\",\"display-name\":\"Geoscheme\",\"type\":\"dimension\",\"dimension\":[\"field\",876,null],\"widget-type\":\"string/=\",\"default\":null},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"WITH all_calc as (\\r\\n    select c.CREATED_AT\\r\\n         , PARTNER_NAME\\r\\n         , USR_COUNTRY_ENG\\r\\n         , USR_GEOSCHEME_ENG\\r\\n         , c.USER_ID\\r\\n         , case when c.kyc_status is not null \\r\\n             then true \\r\\n             else false end USER_AUTHORIZED\\r\\n         , FALSE AS HAS_TRANSACTION\\r\\n         , FALSE AS CONFIRMED\\r\\n    from REPLICA.WEBAPP_WIDGET_CALCULATIONS_LOG as c\\r\\n    inner join MART.WIDGETS as w on w.id = c.WIDGET_ID\\r\\n    inner join MART.USERS as u on u.USER_ID = c.USER_ID\\r\\n    where c.CREATED_AT >= add_months(date_trunc('month', now()), -6)\\r\\n\\r\\n    union\\r\\n\\r\\n    select tr.CREATED_AT\\r\\n         , tr.WIDGET_PARTNER_NAME                                          as PARTNER_NAME\\r\\n         , coalesce(CARD_ISOCOUNTRY, COUNTRY_NAME_EN, USR_COUNTRY_ENG)     as USR_COUNTRY_ENG\\r\\n         , coalesce(CARD_GEOSCHEME, GEOSCHEME_BUSINESS, USR_GEOSCHEME_ENG) as USR_GEOSCHEME_ENG\\r\\n         , tr.USER_ID\\r\\n         , TRUE                                                            AS USER_AUTHORIZED\\r\\n         , TRUE                                                            AS HAS_TRANSACTION\\r\\n         , CONFIRMED\\r\\n    from MART.TRANSACTIONS as tr\\r\\n             left join md.COUNTRY_CODES as cc on lower(cc.COUNTRY_CODE_ALPHA_3) =\\r\\n                                                 lower(tr.LOCATION_COUNTRY)\\r\\n             inner join MART.USERS as u on u.USER_ID = tr.USER_ID\\r\\n    where tr.CREATED_AT >= add_months(date_trunc('month', now()), -6)\\r\\n      and tr.WIDGET_ID is not null\\r\\n      and TYPE_MAIN in ('buy', 'sell')\\r\\n    ),\\r\\n  group_us as (\\r\\n      select date_trunc('month', all_calc.CREATED_AT)  AS created_dt\\r\\n           , USER_ID\\r\\n           , USER_AUTHORIZED \\r\\n           , HAS_TRANSACTION\\r\\n           , CONFIRMED\\r\\n      from all_calc\\r\\n      inner join MART.widgets on MART.widgets.PARTNER_NAME = all_calc.PARTNER_NAME\\r\\n      inner join MD.COUNTRY_CODES on MD.COUNTRY_CODES.COUNTRY_NAME_EN = all_calc.USR_COUNTRY_ENG\\r\\n      where {{partner}} and {{USR_COUNTRY_ENG}} and {{USR_GEOSCHEME_ENG}} \\r\\n      ), \\r\\n  all_u as (\\r\\n      select created_dt\\r\\n           , 'create calculation'       AS type\\r\\n           , count(distinct USER_ID)    AS DAU\\r\\n      from group_us and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.dimensions\":[\"CREATED_DT\",\"TYPE\"],\"graph.y_axis.title_text\":\"Count users\",\"graph.metrics\":[\"DAU\"]},\"parameters\":[{\"id\":\"57da5e94-6636-9a43-d752-77c7e3e7dcb3\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"partner\"]],\"name\":\"Partner\",\"slug\":\"partner\"},{\"id\":\"f5a6e879-eefb-de54-2b7c-df1acd59585f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"USR_COUNTRY_ENG\"]],\"name\":\"Country\",\"slug\":\"USR_COUNTRY_ENG\"},{\"id\":\"78227215-b161-1990-a2db-d40e170bde9b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"USR_GEOSCHEME_ENG\"]],\"name\":\"Geoscheme\",\"slug\":\"USR_GEOSCHEME_ENG\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5473}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5473,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"MAU OOR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"partner\":{\"id\":\"57da5e94-6636-9a43-d752-77c7e3e7dcb3\",\"name\":\"partner\",\"display-name\":\"Partner\",\"type\":\"dimension\",\"dimension\":[\"field\",402,null],\"widget-type\":\"string/=\",\"default\":null},\"USR_COUNTRY_ENG\":{\"id\":\"f5a6e879-eefb-de54-2b7c-df1acd59585f\",\"name\":\"USR_COUNTRY_ENG\",\"display-name\":\"Country\",\"type\":\"dimension\",\"dimension\":[\"field\",874,null],\"widget-type\":\"string/=\",\"default\":null},\"USR_GEOSCHEME_ENG\":{\"id\":\"78227215-b161-1990-a2db-d40e170bde9b\",\"name\":\"USR_GEOSCHEME_ENG\",\"display-name\":\"Geoscheme\",\"type\":\"dimension\",\"dimension\":[\"field\",876,null],\"widget-type\":\"string/=\",\"default\":null},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"WITH all_calc as (\\r\\n    select c.CREATED_AT\\r\\n         , PARTNER_NAME\\r\\n         , USR_COUNTRY_ENG\\r\\n         , USR_GEOSCHEME_ENG\\r\\n         , c.USER_ID\\r\\n         , case when c.kyc_status is not null \\r\\n             then true \\r\\n             else false end USER_AUTHORIZED\\r\\n         , FALSE AS HAS_TRANSACTION\\r\\n         , FALSE AS CONFIRMED\\r\\n    from REPLICA.WEBAPP_WIDGET_CALCULATIONS_LOG as c\\r\\n    inner join MART.WIDGETS as w on w.id = c.WIDGET_ID\\r\\n    inner join MART.USERS as u on u.USER_ID = c.USER_ID\\r\\n    where c.CREATED_AT >= add_months(date_trunc('month', now()), -6)\\r\\n\\r\\n    union\\r\\n\\r\\n    select tr.CREATED_AT\\r\\n         , tr.WIDGET_PARTNER_NAME                                          as PARTNER_NAME\\r\\n         , coalesce(CARD_ISOCOUNTRY, COUNTRY_NAME_EN, USR_COUNTRY_ENG)     as USR_COUNTRY_ENG\\r\\n         , coalesce(CARD_GEOSCHEME, GEOSCHEME_BUSINESS, USR_GEOSCHEME_ENG) as USR_GEOSCHEME_ENG\\r\\n         , tr.USER_ID\\r\\n         , TRUE                                                            AS USER_AUTHORIZED\\r\\n         , TRUE                                                            AS HAS_TRANSACTION\\r\\n         , CONFIRMED\\r\\n    from MART.TRANSACTIONS as tr\\r\\n             left join md.COUNTRY_CODES as cc on lower(cc.COUNTRY_CODE_ALPHA_3) =\\r\\n                                                 lower(tr.LOCATION_COUNTRY)\\r\\n             inner join MART.USERS as u on u.USER_ID = tr.USER_ID\\r\\n    where tr.CREATED_AT >= add_months(date_trunc('month', now()), -6)\\r\\n      and tr.WIDGET_ID is not null\\r\\n      and TYPE_MAIN in ('buy', 'sell')\\r\\n    ),\\r\\n  group_us as (\\r\\n      select date_trunc('month', all_calc.CREATED_AT)  AS created_dt\\r\\n           , USER_ID\\r\\n           , USER_AUTHORIZED \\r\\n           , HAS_TRANSACTION\\r\\n           , CONFIRMED\\r\\n      from all_calc\\r\\n      inner join MART.widgets on MART.widgets.PARTNER_NAME = all_calc.PARTNER_NAME\\r\\n      inner join MD.COUNTRY_CODES on MD.COUNTRY_CODES.COUNTRY_NAME_EN = all_calc.USR_COUNTRY_ENG\\r\\n      where {{partner}} and {{USR_COUNTRY_ENG}} and {{USR_GEOSCHEME_ENG}} \\r\\n      ), \\r\\n  all_u as (\\r\\n      select created_dt\\r\\n           , 'create calculation'       AS type\\r\\n           , count(distinct USER_ID)    AS DAU\\r\\n      from group_us and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.dimensions\":[\"CREATED_DT\",\"TYPE\"],\"graph.y_axis.title_text\":\"Count users\",\"graph.metrics\":[\"DAU\"]},\"parameters\":[{\"id\":\"57da5e94-6636-9a43-d752-77c7e3e7dcb3\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"partner\"]],\"name\":\"Partner\",\"slug\":\"partner\"},{\"id\":\"f5a6e879-eefb-de54-2b7c-df1acd59585f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"USR_COUNTRY_ENG\"]],\"name\":\"Country\",\"slug\":\"USR_COUNTRY_ENG\"},{\"id\":\"78227215-b161-1990-a2db-d40e170bde9b\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"USR_GEOSCHEME_ENG\"]],\"name\":\"Geoscheme\",\"slug\":\"USR_GEOSCHEME_ENG\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5468,
      "card_name": "DAU OOR",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5468]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@c1baecf\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5468]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5468]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"DAU OOR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"e4c9ba39-dfa6-4dfd-9d0e-45ac023dc549\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"partner\":{\"id\":\"0f5ade90-dc17-8424-8957-d844fc2b0c6d\",\"name\":\"partner\",\"display-name\":\"Partner\",\"type\":\"dimension\",\"dimension\":[\"field\",402,null],\"widget-type\":\"string/=\",\"required\":false},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"026e0a0e-299f-4883-97f1-c6e65649e62a\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"6535e6e8-c271-4022-a47e-d8e1a984cdc0\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"35332238-6e5d-43e3-9065-544ae86f95c7\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\"},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a92758b5-6d2e-46e9-9002-8289ea4763bc\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"5c2a799e-1d29-4e5e-9d84-fbca05645d01\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH all_calc AS (\\r\\n    -- \u0422\u043e\u043b\u044c\u043a\u043e \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0438\\r\\n    SELECT \\r\\n        TRANSACTIONS.CREATED_AT,\\r\\n        TRANSACTIONS.WIDGET_PARTNER_NAME AS PARTNER_NAME,\\r\\n        TRANSACTIONS.USER_ID,\\r\\n        TRUE AS USER_AUTHORIZED,\\r\\n        TRUE AS HAS_TRANSACTION,\\r\\n        CONFIRMED\\r\\n    FROM MART.TRANSACTIONS \\r\\n    LEFT JOIN md.COUNTRY_CODES AS cc \\r\\n        ON LOWER(cc.COUNTRY_CODE_ALPHA_3) = LOWER(TRANSACTIONS.LOCATION_COUNTRY)\\r\\n    INNER JOIN MART.USERS AS u \\r\\n        ON u.USER_ID = TRANSACTIONS.USER_ID\\r\\n    WHERE TRANSACTIONS.CREATED_AT >= add_days(date_trunc('day', now()), -30)\\r\\n      AND TRANSACTIONS.WIDGET_ID IS NOT NULL\\r\\n      AND TYPE_MAIN IN ('buy', 'sell')\\r\\n      AND {{CREATED_AT}}\\r\\n      AND {{CARD_ISOCOUNTRY}}\\r\\n),\\r\\n\\r\\ngroup_us AS (\\r\\n    SELECT \\r\\n        TO_DATE(all_calc.CREATED_AT) AS created_dt,\\r\\n        USER_ID,\\r\\n        USER_AUTHORIZED,\\r\\n        HAS_TRANSACTION,\\r\\n        CONFIRMED\\r\\n    FROM all_calc\\r\\n    LEFT JOIN MART.widgets AS w ON w.PARTNER_NAME = all_calc.PARTNER_NAME\\r\\n    WHERE {{partner}} and {{PAY_SYSTEM}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}}\\r\\n),\\r\\n\\r\\nuser_st_tr AS (\\r\\n    SELECT \\r\\n        created_dt,\\r\\n        'start transaction' AS type,\\r\\n        COUNT(DISTINCT USER_ID) AS DAU\\r\\n    FROM group_us\\r\\n    WHERE HAS_TRANSACTION and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.dimensions\":[\"CREATED_DT\",\"TYPE\"],\"graph.y_axis.title_text\":\"Count of users\",\"graph.show_values\":true,\"graph.metrics\":[\"DAU\"]},\"parameters\":[{\"id\":\"0f5ade90-dc17-8424-8957-d844fc2b0c6d\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"partner\"]],\"name\":\"Partner\",\"slug\":\"partner\",\"required\":false},{\"id\":\"35332238-6e5d-43e3-9065-544ae86f95c7\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"6535e6e8-c271-4022-a47e-d8e1a984cdc0\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"5c2a799e-1d29-4e5e-9d84-fbca05645d01\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"026e0a0e-299f-4883-97f1-c6e65649e62a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a92758b5-6d2e-46e9-9002-8289ea4763bc\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"e4c9ba39-dfa6-4dfd-9d0e-45ac023dc549\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"DAU OOR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"e4c9ba39-dfa6-4dfd-9d0e-45ac023dc549\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"partner\":{\"id\":\"0f5ade90-dc17-8424-8957-d844fc2b0c6d\",\"name\":\"partner\",\"display-name\":\"Partner\",\"type\":\"dimension\",\"dimension\":[\"field\",402,null],\"widget-type\":\"string/=\",\"required\":false},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"026e0a0e-299f-4883-97f1-c6e65649e62a\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"6535e6e8-c271-4022-a47e-d8e1a984cdc0\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"35332238-6e5d-43e3-9065-544ae86f95c7\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\"},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a92758b5-6d2e-46e9-9002-8289ea4763bc\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"5c2a799e-1d29-4e5e-9d84-fbca05645d01\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH all_calc AS (\\r\\n    -- \u0422\u043e\u043b\u044c\u043a\u043e \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0438\\r\\n    SELECT \\r\\n        TRANSACTIONS.CREATED_AT,\\r\\n        TRANSACTIONS.WIDGET_PARTNER_NAME AS PARTNER_NAME,\\r\\n        TRANSACTIONS.USER_ID,\\r\\n        TRUE AS USER_AUTHORIZED,\\r\\n        TRUE AS HAS_TRANSACTION,\\r\\n        CONFIRMED\\r\\n    FROM MART.TRANSACTIONS \\r\\n    LEFT JOIN md.COUNTRY_CODES AS cc \\r\\n        ON LOWER(cc.COUNTRY_CODE_ALPHA_3) = LOWER(TRANSACTIONS.LOCATION_COUNTRY)\\r\\n    INNER JOIN MART.USERS AS u \\r\\n        ON u.USER_ID = TRANSACTIONS.USER_ID\\r\\n    WHERE TRANSACTIONS.CREATED_AT >= add_days(date_trunc('day', now()), -30)\\r\\n      AND TRANSACTIONS.WIDGET_ID IS NOT NULL\\r\\n      AND TYPE_MAIN IN ('buy', 'sell')\\r\\n      AND {{CREATED_AT}}\\r\\n      AND {{CARD_ISOCOUNTRY}}\\r\\n),\\r\\n\\r\\ngroup_us AS (\\r\\n    SELECT \\r\\n        TO_DATE(all_calc.CREATED_AT) AS created_dt,\\r\\n        USER_ID,\\r\\n        USER_AUTHORIZED,\\r\\n        HAS_TRANSACTION,\\r\\n        CONFIRMED\\r\\n    FROM all_calc\\r\\n    LEFT JOIN MART.widgets AS w ON w.PARTNER_NAME = all_calc.PARTNER_NAME\\r\\n    WHERE {{partner}} and {{PAY_SYSTEM}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}}\\r\\n),\\r\\n\\r\\nuser_st_tr AS (\\r\\n    SELECT \\r\\n        created_dt,\\r\\n        'start transaction' AS type,\\r\\n        COUNT(DISTINCT USER_ID) AS DAU\\r\\n    FROM group_us\\r\\n    WHERE HAS_TRANSACTION and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.dimensions\":[\"CREATED_DT\",\"TYPE\"],\"graph.y_axis.title_text\":\"Count of users\",\"graph.show_values\":true,\"graph.metrics\":[\"DAU\"]},\"parameters\":[{\"id\":\"0f5ade90-dc17-8424-8957-d844fc2b0c6d\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"partner\"]],\"name\":\"Partner\",\"slug\":\"partner\",\"required\":false},{\"id\":\"35332238-6e5d-43e3-9065-544ae86f95c7\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"6535e6e8-c271-4022-a47e-d8e1a984cdc0\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"5c2a799e-1d29-4e5e-9d84-fbca05645d01\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"026e0a0e-299f-4883-97f1-c6e65649e62a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a92758b5-6d2e-46e9-9002-8289ea4763bc\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"e4c9ba39-dfa6-4dfd-9d0e-45ac023dc549\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5468}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5468,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"DAU OOR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"e4c9ba39-dfa6-4dfd-9d0e-45ac023dc549\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"partner\":{\"id\":\"0f5ade90-dc17-8424-8957-d844fc2b0c6d\",\"name\":\"partner\",\"display-name\":\"Partner\",\"type\":\"dimension\",\"dimension\":[\"field\",402,null],\"widget-type\":\"string/=\",\"required\":false},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"026e0a0e-299f-4883-97f1-c6e65649e62a\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"6535e6e8-c271-4022-a47e-d8e1a984cdc0\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"35332238-6e5d-43e3-9065-544ae86f95c7\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\"},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a92758b5-6d2e-46e9-9002-8289ea4763bc\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"5c2a799e-1d29-4e5e-9d84-fbca05645d01\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH all_calc AS (\\r\\n    -- \u0422\u043e\u043b\u044c\u043a\u043e \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0438\\r\\n    SELECT \\r\\n        TRANSACTIONS.CREATED_AT,\\r\\n        TRANSACTIONS.WIDGET_PARTNER_NAME AS PARTNER_NAME,\\r\\n        TRANSACTIONS.USER_ID,\\r\\n        TRUE AS USER_AUTHORIZED,\\r\\n        TRUE AS HAS_TRANSACTION,\\r\\n        CONFIRMED\\r\\n    FROM MART.TRANSACTIONS \\r\\n    LEFT JOIN md.COUNTRY_CODES AS cc \\r\\n        ON LOWER(cc.COUNTRY_CODE_ALPHA_3) = LOWER(TRANSACTIONS.LOCATION_COUNTRY)\\r\\n    INNER JOIN MART.USERS AS u \\r\\n        ON u.USER_ID = TRANSACTIONS.USER_ID\\r\\n    WHERE TRANSACTIONS.CREATED_AT >= add_days(date_trunc('day', now()), -30)\\r\\n      AND TRANSACTIONS.WIDGET_ID IS NOT NULL\\r\\n      AND TYPE_MAIN IN ('buy', 'sell')\\r\\n      AND {{CREATED_AT}}\\r\\n      AND {{CARD_ISOCOUNTRY}}\\r\\n),\\r\\n\\r\\ngroup_us AS (\\r\\n    SELECT \\r\\n        TO_DATE(all_calc.CREATED_AT) AS created_dt,\\r\\n        USER_ID,\\r\\n        USER_AUTHORIZED,\\r\\n        HAS_TRANSACTION,\\r\\n        CONFIRMED\\r\\n    FROM all_calc\\r\\n    LEFT JOIN MART.widgets AS w ON w.PARTNER_NAME = all_calc.PARTNER_NAME\\r\\n    WHERE {{partner}} and {{PAY_SYSTEM}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}}\\r\\n),\\r\\n\\r\\nuser_st_tr AS (\\r\\n    SELECT \\r\\n        created_dt,\\r\\n        'start transaction' AS type,\\r\\n        COUNT(DISTINCT USER_ID) AS DAU\\r\\n    FROM group_us\\r\\n    WHERE HAS_TRANSACTION and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.dimensions\":[\"CREATED_DT\",\"TYPE\"],\"graph.y_axis.title_text\":\"Count of users\",\"graph.show_values\":true,\"graph.metrics\":[\"DAU\"]},\"parameters\":[{\"id\":\"0f5ade90-dc17-8424-8957-d844fc2b0c6d\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"partner\"]],\"name\":\"Partner\",\"slug\":\"partner\",\"required\":false},{\"id\":\"35332238-6e5d-43e3-9065-544ae86f95c7\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"6535e6e8-c271-4022-a47e-d8e1a984cdc0\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"5c2a799e-1d29-4e5e-9d84-fbca05645d01\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"026e0a0e-299f-4883-97f1-c6e65649e62a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a92758b5-6d2e-46e9-9002-8289ea4763bc\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"e4c9ba39-dfa6-4dfd-9d0e-45ac023dc549\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5468]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@c1baecf\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5468]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5468]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"DAU OOR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"e4c9ba39-dfa6-4dfd-9d0e-45ac023dc549\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"partner\":{\"id\":\"0f5ade90-dc17-8424-8957-d844fc2b0c6d\",\"name\":\"partner\",\"display-name\":\"Partner\",\"type\":\"dimension\",\"dimension\":[\"field\",402,null],\"widget-type\":\"string/=\",\"required\":false},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"026e0a0e-299f-4883-97f1-c6e65649e62a\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"6535e6e8-c271-4022-a47e-d8e1a984cdc0\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"35332238-6e5d-43e3-9065-544ae86f95c7\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\"},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a92758b5-6d2e-46e9-9002-8289ea4763bc\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"5c2a799e-1d29-4e5e-9d84-fbca05645d01\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH all_calc AS (\\r\\n    -- \u0422\u043e\u043b\u044c\u043a\u043e \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0438\\r\\n    SELECT \\r\\n        TRANSACTIONS.CREATED_AT,\\r\\n        TRANSACTIONS.WIDGET_PARTNER_NAME AS PARTNER_NAME,\\r\\n        TRANSACTIONS.USER_ID,\\r\\n        TRUE AS USER_AUTHORIZED,\\r\\n        TRUE AS HAS_TRANSACTION,\\r\\n        CONFIRMED\\r\\n    FROM MART.TRANSACTIONS \\r\\n    LEFT JOIN md.COUNTRY_CODES AS cc \\r\\n        ON LOWER(cc.COUNTRY_CODE_ALPHA_3) = LOWER(TRANSACTIONS.LOCATION_COUNTRY)\\r\\n    INNER JOIN MART.USERS AS u \\r\\n        ON u.USER_ID = TRANSACTIONS.USER_ID\\r\\n    WHERE TRANSACTIONS.CREATED_AT >= add_days(date_trunc('day', now()), -30)\\r\\n      AND TRANSACTIONS.WIDGET_ID IS NOT NULL\\r\\n      AND TYPE_MAIN IN ('buy', 'sell')\\r\\n      AND {{CREATED_AT}}\\r\\n      AND {{CARD_ISOCOUNTRY}}\\r\\n),\\r\\n\\r\\ngroup_us AS (\\r\\n    SELECT \\r\\n        TO_DATE(all_calc.CREATED_AT) AS created_dt,\\r\\n        USER_ID,\\r\\n        USER_AUTHORIZED,\\r\\n        HAS_TRANSACTION,\\r\\n        CONFIRMED\\r\\n    FROM all_calc\\r\\n    LEFT JOIN MART.widgets AS w ON w.PARTNER_NAME = all_calc.PARTNER_NAME\\r\\n    WHERE {{partner}} and {{PAY_SYSTEM}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}}\\r\\n),\\r\\n\\r\\nuser_st_tr AS (\\r\\n    SELECT \\r\\n        created_dt,\\r\\n        'start transaction' AS type,\\r\\n        COUNT(DISTINCT USER_ID) AS DAU\\r\\n    FROM group_us\\r\\n    WHERE HAS_TRANSACTION and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.dimensions\":[\"CREATED_DT\",\"TYPE\"],\"graph.y_axis.title_text\":\"Count of users\",\"graph.show_values\":true,\"graph.metrics\":[\"DAU\"]},\"parameters\":[{\"id\":\"0f5ade90-dc17-8424-8957-d844fc2b0c6d\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"partner\"]],\"name\":\"Partner\",\"slug\":\"partner\",\"required\":false},{\"id\":\"35332238-6e5d-43e3-9065-544ae86f95c7\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"6535e6e8-c271-4022-a47e-d8e1a984cdc0\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"5c2a799e-1d29-4e5e-9d84-fbca05645d01\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"026e0a0e-299f-4883-97f1-c6e65649e62a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a92758b5-6d2e-46e9-9002-8289ea4763bc\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"e4c9ba39-dfa6-4dfd-9d0e-45ac023dc549\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"DAU OOR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"e4c9ba39-dfa6-4dfd-9d0e-45ac023dc549\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"partner\":{\"id\":\"0f5ade90-dc17-8424-8957-d844fc2b0c6d\",\"name\":\"partner\",\"display-name\":\"Partner\",\"type\":\"dimension\",\"dimension\":[\"field\",402,null],\"widget-type\":\"string/=\",\"required\":false},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"026e0a0e-299f-4883-97f1-c6e65649e62a\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"6535e6e8-c271-4022-a47e-d8e1a984cdc0\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"35332238-6e5d-43e3-9065-544ae86f95c7\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\"},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a92758b5-6d2e-46e9-9002-8289ea4763bc\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"5c2a799e-1d29-4e5e-9d84-fbca05645d01\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH all_calc AS (\\r\\n    -- \u0422\u043e\u043b\u044c\u043a\u043e \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0438\\r\\n    SELECT \\r\\n        TRANSACTIONS.CREATED_AT,\\r\\n        TRANSACTIONS.WIDGET_PARTNER_NAME AS PARTNER_NAME,\\r\\n        TRANSACTIONS.USER_ID,\\r\\n        TRUE AS USER_AUTHORIZED,\\r\\n        TRUE AS HAS_TRANSACTION,\\r\\n        CONFIRMED\\r\\n    FROM MART.TRANSACTIONS \\r\\n    LEFT JOIN md.COUNTRY_CODES AS cc \\r\\n        ON LOWER(cc.COUNTRY_CODE_ALPHA_3) = LOWER(TRANSACTIONS.LOCATION_COUNTRY)\\r\\n    INNER JOIN MART.USERS AS u \\r\\n        ON u.USER_ID = TRANSACTIONS.USER_ID\\r\\n    WHERE TRANSACTIONS.CREATED_AT >= add_days(date_trunc('day', now()), -30)\\r\\n      AND TRANSACTIONS.WIDGET_ID IS NOT NULL\\r\\n      AND TYPE_MAIN IN ('buy', 'sell')\\r\\n      AND {{CREATED_AT}}\\r\\n      AND {{CARD_ISOCOUNTRY}}\\r\\n),\\r\\n\\r\\ngroup_us AS (\\r\\n    SELECT \\r\\n        TO_DATE(all_calc.CREATED_AT) AS created_dt,\\r\\n        USER_ID,\\r\\n        USER_AUTHORIZED,\\r\\n        HAS_TRANSACTION,\\r\\n        CONFIRMED\\r\\n    FROM all_calc\\r\\n    LEFT JOIN MART.widgets AS w ON w.PARTNER_NAME = all_calc.PARTNER_NAME\\r\\n    WHERE {{partner}} and {{PAY_SYSTEM}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}}\\r\\n),\\r\\n\\r\\nuser_st_tr AS (\\r\\n    SELECT \\r\\n        created_dt,\\r\\n        'start transaction' AS type,\\r\\n        COUNT(DISTINCT USER_ID) AS DAU\\r\\n    FROM group_us\\r\\n    WHERE HAS_TRANSACTION and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.dimensions\":[\"CREATED_DT\",\"TYPE\"],\"graph.y_axis.title_text\":\"Count of users\",\"graph.show_values\":true,\"graph.metrics\":[\"DAU\"]},\"parameters\":[{\"id\":\"0f5ade90-dc17-8424-8957-d844fc2b0c6d\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"partner\"]],\"name\":\"Partner\",\"slug\":\"partner\",\"required\":false},{\"id\":\"35332238-6e5d-43e3-9065-544ae86f95c7\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"6535e6e8-c271-4022-a47e-d8e1a984cdc0\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"5c2a799e-1d29-4e5e-9d84-fbca05645d01\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"026e0a0e-299f-4883-97f1-c6e65649e62a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a92758b5-6d2e-46e9-9002-8289ea4763bc\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"e4c9ba39-dfa6-4dfd-9d0e-45ac023dc549\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5468}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5468,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"DAU OOR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"e4c9ba39-dfa6-4dfd-9d0e-45ac023dc549\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"partner\":{\"id\":\"0f5ade90-dc17-8424-8957-d844fc2b0c6d\",\"name\":\"partner\",\"display-name\":\"Partner\",\"type\":\"dimension\",\"dimension\":[\"field\",402,null],\"widget-type\":\"string/=\",\"required\":false},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"026e0a0e-299f-4883-97f1-c6e65649e62a\",\"display-name\":\"Crypto\",\"default\":null,\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\",\"options\":null},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"6535e6e8-c271-4022-a47e-d8e1a984cdc0\",\"display-name\":\"Pay System\",\"default\":null,\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\",\"options\":null},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"35332238-6e5d-43e3-9065-544ae86f95c7\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\"},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a92758b5-6d2e-46e9-9002-8289ea4763bc\",\"display-name\":\"Type\",\"default\":null,\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\",\"options\":null},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"5c2a799e-1d29-4e5e-9d84-fbca05645d01\",\"display-name\":\"Currency\",\"default\":null,\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\",\"options\":null}},\"query\":\"WITH all_calc AS (\\r\\n    -- \u0422\u043e\u043b\u044c\u043a\u043e \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0438\\r\\n    SELECT \\r\\n        TRANSACTIONS.CREATED_AT,\\r\\n        TRANSACTIONS.WIDGET_PARTNER_NAME AS PARTNER_NAME,\\r\\n        TRANSACTIONS.USER_ID,\\r\\n        TRUE AS USER_AUTHORIZED,\\r\\n        TRUE AS HAS_TRANSACTION,\\r\\n        CONFIRMED\\r\\n    FROM MART.TRANSACTIONS \\r\\n    LEFT JOIN md.COUNTRY_CODES AS cc \\r\\n        ON LOWER(cc.COUNTRY_CODE_ALPHA_3) = LOWER(TRANSACTIONS.LOCATION_COUNTRY)\\r\\n    INNER JOIN MART.USERS AS u \\r\\n        ON u.USER_ID = TRANSACTIONS.USER_ID\\r\\n    WHERE TRANSACTIONS.CREATED_AT >= add_days(date_trunc('day', now()), -30)\\r\\n      AND TRANSACTIONS.WIDGET_ID IS NOT NULL\\r\\n      AND TYPE_MAIN IN ('buy', 'sell')\\r\\n      AND {{CREATED_AT}}\\r\\n      AND {{CARD_ISOCOUNTRY}}\\r\\n),\\r\\n\\r\\ngroup_us AS (\\r\\n    SELECT \\r\\n        TO_DATE(all_calc.CREATED_AT) AS created_dt,\\r\\n        USER_ID,\\r\\n        USER_AUTHORIZED,\\r\\n        HAS_TRANSACTION,\\r\\n        CONFIRMED\\r\\n    FROM all_calc\\r\\n    LEFT JOIN MART.widgets AS w ON w.PARTNER_NAME = all_calc.PARTNER_NAME\\r\\n    WHERE {{partner}} and {{PAY_SYSTEM}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}}\\r\\n),\\r\\n\\r\\nuser_st_tr AS (\\r\\n    SELECT \\r\\n        created_dt,\\r\\n        'start transaction' AS type,\\r\\n        COUNT(DISTINCT USER_ID) AS DAU\\r\\n    FROM group_us\\r\\n    WHERE HAS_TRANSACTION and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.dimensions\":[\"CREATED_DT\",\"TYPE\"],\"graph.y_axis.title_text\":\"Count of users\",\"graph.show_values\":true,\"graph.metrics\":[\"DAU\"]},\"parameters\":[{\"id\":\"0f5ade90-dc17-8424-8957-d844fc2b0c6d\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"partner\"]],\"name\":\"Partner\",\"slug\":\"partner\",\"required\":false},{\"id\":\"35332238-6e5d-43e3-9065-544ae86f95c7\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"6535e6e8-c271-4022-a47e-d8e1a984cdc0\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"5c2a799e-1d29-4e5e-9d84-fbca05645d01\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"026e0a0e-299f-4883-97f1-c6e65649e62a\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a92758b5-6d2e-46e9-9002-8289ea4763bc\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"e4c9ba39-dfa6-4dfd-9d0e-45ac023dc549\",\"type\":\"string/contains\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\",\"options\":{\"case-sensitive\":false}}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5486,
      "card_name": "Revenue",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5486]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@72821590\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5486]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5486]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n     , round(sum(FEE_MERCURIO_FIAT_EUR*cast(rr.RATE as DECIMAL(18,6))),0)    AS \\\"Commission Revenue\\\"\\n     , round(sum(FEE_NETWORK_REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6))),0)  as \\\"Network Revenue\\\"\\n     , round(sum(FEE_FX_EUR*cast(rr.RATE as DECIMAL(18,6))),0)               AS \\\"FEE FX\\\"\\n     , round(sum(FEE_RATIO_RATES_FIAT_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS \\\"Mark up Revenue\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"stackable.stack_type\":\"stacked\",\"graph.y_axis.title_text\":\"Revenue\",\"column_settings\":{\"[\\\"name\\\",\\\"Commission Revenue\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Network Revenue\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"FEE FX\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Mark up Revenue\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Commission Revenue\",\"Network Revenue\",\"FEE FX\",\"Mark up Revenue\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n     , round(sum(FEE_MERCURIO_FIAT_EUR*cast(rr.RATE as DECIMAL(18,6))),0)    AS \\\"Commission Revenue\\\"\\n     , round(sum(FEE_NETWORK_REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6))),0)  as \\\"Network Revenue\\\"\\n     , round(sum(FEE_FX_EUR*cast(rr.RATE as DECIMAL(18,6))),0)               AS \\\"FEE FX\\\"\\n     , round(sum(FEE_RATIO_RATES_FIAT_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS \\\"Mark up Revenue\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"stackable.stack_type\":\"stacked\",\"graph.y_axis.title_text\":\"Revenue\",\"column_settings\":{\"[\\\"name\\\",\\\"Commission Revenue\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Network Revenue\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"FEE FX\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Mark up Revenue\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Commission Revenue\",\"Network Revenue\",\"FEE FX\",\"Mark up Revenue\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5486}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5486,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n     , round(sum(FEE_MERCURIO_FIAT_EUR*cast(rr.RATE as DECIMAL(18,6))),0)    AS \\\"Commission Revenue\\\"\\n     , round(sum(FEE_NETWORK_REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6))),0)  as \\\"Network Revenue\\\"\\n     , round(sum(FEE_FX_EUR*cast(rr.RATE as DECIMAL(18,6))),0)               AS \\\"FEE FX\\\"\\n     , round(sum(FEE_RATIO_RATES_FIAT_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS \\\"Mark up Revenue\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"stackable.stack_type\":\"stacked\",\"graph.y_axis.title_text\":\"Revenue\",\"column_settings\":{\"[\\\"name\\\",\\\"Commission Revenue\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Network Revenue\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"FEE FX\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Mark up Revenue\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Commission Revenue\",\"Network Revenue\",\"FEE FX\",\"Mark up Revenue\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5486]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@72821590\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5486]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5486]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n     , round(sum(FEE_MERCURIO_FIAT_EUR*cast(rr.RATE as DECIMAL(18,6))),0)    AS \\\"Commission Revenue\\\"\\n     , round(sum(FEE_NETWORK_REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6))),0)  as \\\"Network Revenue\\\"\\n     , round(sum(FEE_FX_EUR*cast(rr.RATE as DECIMAL(18,6))),0)               AS \\\"FEE FX\\\"\\n     , round(sum(FEE_RATIO_RATES_FIAT_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS \\\"Mark up Revenue\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"stackable.stack_type\":\"stacked\",\"graph.y_axis.title_text\":\"Revenue\",\"column_settings\":{\"[\\\"name\\\",\\\"Commission Revenue\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Network Revenue\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"FEE FX\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Mark up Revenue\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Commission Revenue\",\"Network Revenue\",\"FEE FX\",\"Mark up Revenue\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n     , round(sum(FEE_MERCURIO_FIAT_EUR*cast(rr.RATE as DECIMAL(18,6))),0)    AS \\\"Commission Revenue\\\"\\n     , round(sum(FEE_NETWORK_REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6))),0)  as \\\"Network Revenue\\\"\\n     , round(sum(FEE_FX_EUR*cast(rr.RATE as DECIMAL(18,6))),0)               AS \\\"FEE FX\\\"\\n     , round(sum(FEE_RATIO_RATES_FIAT_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS \\\"Mark up Revenue\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"stackable.stack_type\":\"stacked\",\"graph.y_axis.title_text\":\"Revenue\",\"column_settings\":{\"[\\\"name\\\",\\\"Commission Revenue\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Network Revenue\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"FEE FX\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Mark up Revenue\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Commission Revenue\",\"Network Revenue\",\"FEE FX\",\"Mark up Revenue\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5486}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5486,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n     , round(sum(FEE_MERCURIO_FIAT_EUR*cast(rr.RATE as DECIMAL(18,6))),0)    AS \\\"Commission Revenue\\\"\\n     , round(sum(FEE_NETWORK_REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6))),0)  as \\\"Network Revenue\\\"\\n     , round(sum(FEE_FX_EUR*cast(rr.RATE as DECIMAL(18,6))),0)               AS \\\"FEE FX\\\"\\n     , round(sum(FEE_RATIO_RATES_FIAT_EUR*cast(rr.RATE as DECIMAL(18,6))),0) AS \\\"Mark up Revenue\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"stackable.stack_type\":\"stacked\",\"graph.y_axis.title_text\":\"Revenue\",\"column_settings\":{\"[\\\"name\\\",\\\"Commission Revenue\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Network Revenue\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"FEE FX\\\"]\":{\"prefix\":\"$\"},\"[\\\"name\\\",\\\"Mark up Revenue\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Commission Revenue\",\"Network Revenue\",\"FEE FX\",\"Mark up Revenue\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5483,
      "card_name": "Revenue Per User",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5483]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@7dcbf19\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5483]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5483]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue Per User\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, round(sum(TRANSACTIONS.REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6)))/count(distinct user_id), 2) as \\\"Revenue Per User\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"Revenue Per User\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Revenue Per User\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue Per User\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, round(sum(TRANSACTIONS.REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6)))/count(distinct user_id), 2) as \\\"Revenue Per User\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"Revenue Per User\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Revenue Per User\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5483}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5483,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue Per User\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, round(sum(TRANSACTIONS.REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6)))/count(distinct user_id), 2) as \\\"Revenue Per User\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"Revenue Per User\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Revenue Per User\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5483]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@7dcbf19\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5483]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5483]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue Per User\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, round(sum(TRANSACTIONS.REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6)))/count(distinct user_id), 2) as \\\"Revenue Per User\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"Revenue Per User\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Revenue Per User\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue Per User\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, round(sum(TRANSACTIONS.REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6)))/count(distinct user_id), 2) as \\\"Revenue Per User\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"Revenue Per User\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Revenue Per User\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5483}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5483,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue Per User\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, round(sum(TRANSACTIONS.REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6)))/count(distinct user_id), 2) as \\\"Revenue Per User\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"Revenue Per User\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[\"Revenue Per User\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5484,
      "card_name": "Revenue Per Turnover",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5484]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@7f841849\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5484]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5484]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue Per Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, SUM(TRANSACTIONS.REVENUE_EUR)/SUM(TRANSACTIONS.TURNOVER_EUR) as \\\"Revenue Per Turnover\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand {{CREATED_AT}}\\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"Revenue Per Turnover\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[\"Revenue Per Turnover\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue Per Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, SUM(TRANSACTIONS.REVENUE_EUR)/SUM(TRANSACTIONS.TURNOVER_EUR) as \\\"Revenue Per Turnover\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand {{CREATED_AT}}\\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"Revenue Per Turnover\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[\"Revenue Per Turnover\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5484}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5484,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue Per Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, SUM(TRANSACTIONS.REVENUE_EUR)/SUM(TRANSACTIONS.TURNOVER_EUR) as \\\"Revenue Per Turnover\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand {{CREATED_AT}}\\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"Revenue Per Turnover\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[\"Revenue Per Turnover\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5484]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@7f841849\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5484]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5484]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue Per Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, SUM(TRANSACTIONS.REVENUE_EUR)/SUM(TRANSACTIONS.TURNOVER_EUR) as \\\"Revenue Per Turnover\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand {{CREATED_AT}}\\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"Revenue Per Turnover\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[\"Revenue Per Turnover\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue Per Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, SUM(TRANSACTIONS.REVENUE_EUR)/SUM(TRANSACTIONS.TURNOVER_EUR) as \\\"Revenue Per Turnover\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand {{CREATED_AT}}\\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"Revenue Per Turnover\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[\"Revenue Per Turnover\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5484}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5484,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Revenue Per Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\ndate_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Date\\\"\\n, SUM(TRANSACTIONS.REVENUE_EUR)/SUM(TRANSACTIONS.TURNOVER_EUR) as \\\"Revenue Per Turnover\\\"\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand {{CREATED_AT}}\\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Date\"],\"column_settings\":{\"[\\\"name\\\",\\\"Revenue Per Turnover\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[\"Revenue Per Turnover\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5487,
      "card_name": "Total Revenue",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5487]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@55708fa\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5487]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5487]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Revenue\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TRANSACTIONS.REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as Revenue\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"REVENUE\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Revenue\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TRANSACTIONS.REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as Revenue\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"REVENUE\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5487}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5487,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Revenue\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TRANSACTIONS.REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as Revenue\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"REVENUE\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5487]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@55708fa\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5487]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5487]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Revenue\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TRANSACTIONS.REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as Revenue\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"REVENUE\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Revenue\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TRANSACTIONS.REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as Revenue\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"REVENUE\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5487}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5487,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Revenue\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TRANSACTIONS.REVENUE_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as Revenue\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"REVENUE\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5479,
      "card_name": "Total GMV",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5479]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@a184da8\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5479]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5479]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total GMV\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TRANSACTIONS.GMV_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as GMV\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total GMV\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TRANSACTIONS.GMV_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as GMV\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5479}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5479,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total GMV\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TRANSACTIONS.GMV_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as GMV\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5479]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@a184da8\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5479]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5479]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total GMV\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TRANSACTIONS.GMV_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as GMV\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total GMV\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TRANSACTIONS.GMV_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as GMV\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5479}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5479,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total GMV\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TRANSACTIONS.GMV_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as GMV\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"GMV\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5470,
      "card_name": "Total Turnover",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5470]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@1e4a4bd2\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5470]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5470]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\nround(sum(TRANSACTIONS.TURNOVER_EUR\\n*cast(rr.RATE as DECIMAL(18,6))),0) AS TURNOVER\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"TURNOVER\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\nround(sum(TRANSACTIONS.TURNOVER_EUR\\n*cast(rr.RATE as DECIMAL(18,6))),0) AS TURNOVER\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"TURNOVER\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5470}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5470,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\nround(sum(TRANSACTIONS.TURNOVER_EUR\\n*cast(rr.RATE as DECIMAL(18,6))),0) AS TURNOVER\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"TURNOVER\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5470]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@1e4a4bd2\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5470]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5470]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\nround(sum(TRANSACTIONS.TURNOVER_EUR\\n*cast(rr.RATE as DECIMAL(18,6))),0) AS TURNOVER\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"TURNOVER\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\nround(sum(TRANSACTIONS.TURNOVER_EUR\\n*cast(rr.RATE as DECIMAL(18,6))),0) AS TURNOVER\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"TURNOVER\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5470}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5470,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Turnover\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\nround(sum(TRANSACTIONS.TURNOVER_EUR\\n*cast(rr.RATE as DECIMAL(18,6))),0) AS TURNOVER\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"TURNOVER\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5476,
      "card_name": "Total Costs",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5476]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@770ce508\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5476]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5476]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Costs\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TOTAL_TRANSACTION_COSTS_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as \\\"Costs\\\"\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"Costs\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Costs\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TOTAL_TRANSACTION_COSTS_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as \\\"Costs\\\"\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"Costs\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5476}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5476,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Costs\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TOTAL_TRANSACTION_COSTS_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as \\\"Costs\\\"\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"Costs\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5476]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@770ce508\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5476]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5476]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Costs\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TOTAL_TRANSACTION_COSTS_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as \\\"Costs\\\"\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"Costs\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Costs\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TOTAL_TRANSACTION_COSTS_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as \\\"Costs\\\"\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"Costs\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5476}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5476,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Costs\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n-- date_trunc('day',tr.CREATED_AT)\\n--  tr.ID \\n-- ,rr.RATE                                            AS DAY_CLOSE\\n-- , sum(tr.REVENUE_EUR/rr.RATE) as Revenue_USD\\n-- , sum(tr.GMV_EUR/rr.RATE) as GMV_USD\\n round(sum(TOTAL_TRANSACTION_COSTS_EUR*cast(rr.RATE as DECIMAL(18,6))), 0) as \\\"Costs\\\"\\n--  sum(TOTAL_TRANSACTION_COSTS_EUR/rr.RATE) as TRANSACTION_COST\\n-- , CARD_ISOCOUNTRY\\n-- , CURRENCY\\n-- , PAY_SYSTEM\\n-- , CARD_BRAND\\n-- , WIDGET_PARTNER_NAME\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}} and CONFIRMED\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"Costs\\\"]\":{\"prefix\":\"$\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5472,
      "card_name": "Transactions dynamic",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5472]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@6003c47a\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5472]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5472]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Transactions dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n--   source_main, \\n  COUNT(*) as \\\"Count transactions\\\"\\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\"],\"graph.metrics\":[\"Count transactions\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Transactions dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n--   source_main, \\n  COUNT(*) as \\\"Count transactions\\\"\\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\"],\"graph.metrics\":[\"Count transactions\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5472}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5472,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Transactions dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n--   source_main, \\n  COUNT(*) as \\\"Count transactions\\\"\\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\"],\"graph.metrics\":[\"Count transactions\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5472]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@6003c47a\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5472]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5472]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Transactions dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n--   source_main, \\n  COUNT(*) as \\\"Count transactions\\\"\\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\"],\"graph.metrics\":[\"Count transactions\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Transactions dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n--   source_main, \\n  COUNT(*) as \\\"Count transactions\\\"\\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\"],\"graph.metrics\":[\"Count transactions\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5472}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5472,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Transactions dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n--   source_main, \\n  COUNT(*) as \\\"Count transactions\\\"\\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\"],\"graph.metrics\":[\"Count transactions\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5490,
      "card_name": "AR dynamic",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5490]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@5187ec49\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5490]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5490]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":\"Calculations from the widget with the type \u201cbuy\u201d were included.\\n\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"AR dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n  source_main, \\n   round(CAST(\\n    SUM(\\n      CASE\\n        WHEN CONFIRMED THEN 1\\n        ELSE 0\\n      END\\n    ) AS float\\n  ) / NULLIF(COUNT(*), 0),2) \\\"Acceptance Rate\\\"\\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"SOURCE_MAIN\"],\"column_settings\":{\"[\\\"name\\\",\\\"Acceptance Rate\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[\"Acceptance Rate\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":\"Calculations from the widget with the type \u201cbuy\u201d were included.\\n\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"AR dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n  source_main, \\n   round(CAST(\\n    SUM(\\n      CASE\\n        WHEN CONFIRMED THEN 1\\n        ELSE 0\\n      END\\n    ) AS float\\n  ) / NULLIF(COUNT(*), 0),2) \\\"Acceptance Rate\\\"\\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"SOURCE_MAIN\"],\"column_settings\":{\"[\\\"name\\\",\\\"Acceptance Rate\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[\"Acceptance Rate\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5490}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5490,{\"description\":\"Calculations from the widget with the type \u201cbuy\u201d were included.\\n\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"AR dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n  source_main, \\n   round(CAST(\\n    SUM(\\n      CASE\\n        WHEN CONFIRMED THEN 1\\n        ELSE 0\\n      END\\n    ) AS float\\n  ) / NULLIF(COUNT(*), 0),2) \\\"Acceptance Rate\\\"\\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"SOURCE_MAIN\"],\"column_settings\":{\"[\\\"name\\\",\\\"Acceptance Rate\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[\"Acceptance Rate\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5490]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@5187ec49\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5490]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5490]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":\"Calculations from the widget with the type \u201cbuy\u201d were included.\\n\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"AR dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n  source_main, \\n   round(CAST(\\n    SUM(\\n      CASE\\n        WHEN CONFIRMED THEN 1\\n        ELSE 0\\n      END\\n    ) AS float\\n  ) / NULLIF(COUNT(*), 0),2) \\\"Acceptance Rate\\\"\\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"SOURCE_MAIN\"],\"column_settings\":{\"[\\\"name\\\",\\\"Acceptance Rate\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[\"Acceptance Rate\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":\"Calculations from the widget with the type \u201cbuy\u201d were included.\\n\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"AR dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n  source_main, \\n   round(CAST(\\n    SUM(\\n      CASE\\n        WHEN CONFIRMED THEN 1\\n        ELSE 0\\n      END\\n    ) AS float\\n  ) / NULLIF(COUNT(*), 0),2) \\\"Acceptance Rate\\\"\\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"SOURCE_MAIN\"],\"column_settings\":{\"[\\\"name\\\",\\\"Acceptance Rate\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[\"Acceptance Rate\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5490}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5490,{\"description\":\"Calculations from the widget with the type \u201cbuy\u201d were included.\\n\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"AR dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n  source_main, \\n   round(CAST(\\n    SUM(\\n      CASE\\n        WHEN CONFIRMED THEN 1\\n        ELSE 0\\n      END\\n    ) AS float\\n  ) / NULLIF(COUNT(*), 0),2) \\\"Acceptance Rate\\\"\\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"SOURCE_MAIN\"],\"column_settings\":{\"[\\\"name\\\",\\\"Acceptance Rate\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[\"Acceptance Rate\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5480,
      "card_name": "Failed reasons",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5480]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@1f06a0b6\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5480]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5480]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Failed reasons\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\nGROUP_FAILED_REASON, count(ID) \\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"GROUP_FAILED_REASON\"],\"stackable.stack_type\":\"stacked\",\"graph.metrics\":[\"Count(ID)\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Failed reasons\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\nGROUP_FAILED_REASON, count(ID) \\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"GROUP_FAILED_REASON\"],\"stackable.stack_type\":\"stacked\",\"graph.metrics\":[\"Count(ID)\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5480}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5480,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Failed reasons\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\nGROUP_FAILED_REASON, count(ID) \\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"GROUP_FAILED_REASON\"],\"stackable.stack_type\":\"stacked\",\"graph.metrics\":[\"Count(ID)\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5480]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@1f06a0b6\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5480]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5480]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Failed reasons\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\nGROUP_FAILED_REASON, count(ID) \\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"GROUP_FAILED_REASON\"],\"stackable.stack_type\":\"stacked\",\"graph.metrics\":[\"Count(ID)\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Failed reasons\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\nGROUP_FAILED_REASON, count(ID) \\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"GROUP_FAILED_REASON\"],\"stackable.stack_type\":\"stacked\",\"graph.metrics\":[\"Count(ID)\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5480}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5480,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Failed reasons\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\nGROUP_FAILED_REASON, count(ID) \\n  from mart.Transactions \\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"GROUP_FAILED_REASON\"],\"stackable.stack_type\":\"stacked\",\"graph.metrics\":[\"Count(ID)\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5482,
      "card_name": "Total Transactions ",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5482]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@48eab060\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5482]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5482]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":\"Only confirmed transactions from widget with type buy\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Transactions \",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n\\n count(TRANSACTIONS.ID)   \\n\\nfrom MART.TRANSACTIONS\\nwhere {{CARD_ISOCOUNTRY}}\\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget' and\\n      confirmed\\n\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":\"Only confirmed transactions from widget with type buy\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Transactions \",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n\\n count(TRANSACTIONS.ID)   \\n\\nfrom MART.TRANSACTIONS\\nwhere {{CARD_ISOCOUNTRY}}\\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget' and\\n      confirmed\\n\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5482}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5482,{\"description\":\"Only confirmed transactions from widget with type buy\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Transactions \",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n\\n count(TRANSACTIONS.ID)   \\n\\nfrom MART.TRANSACTIONS\\nwhere {{CARD_ISOCOUNTRY}}\\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget' and\\n      confirmed\\n\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5482]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@48eab060\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5482]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5482]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":\"Only confirmed transactions from widget with type buy\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Transactions \",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n\\n count(TRANSACTIONS.ID)   \\n\\nfrom MART.TRANSACTIONS\\nwhere {{CARD_ISOCOUNTRY}}\\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget' and\\n      confirmed\\n\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":\"Only confirmed transactions from widget with type buy\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Transactions \",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n\\n count(TRANSACTIONS.ID)   \\n\\nfrom MART.TRANSACTIONS\\nwhere {{CARD_ISOCOUNTRY}}\\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget' and\\n      confirmed\\n\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5482}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5482,{\"description\":\"Only confirmed transactions from widget with type buy\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total Transactions \",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n\\n count(TRANSACTIONS.ID)   \\n\\nfrom MART.TRANSACTIONS\\nwhere {{CARD_ISOCOUNTRY}}\\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget' and\\n      confirmed\\n\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5488,
      "card_name": "Total AR",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5488]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@5c23cb1c\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5488]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5488]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":\"Only calculations from widgets with the type \u201cbuy\u201d were included.\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total AR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n   CAST(\\n    SUM(\\n      CASE\\n        WHEN CONFIRMED THEN 1\\n        ELSE 0\\n      END\\n    ) AS float\\n  ) / NULLIF(COUNT(*), 0) as AR\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}}\\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"AR\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":\"Only calculations from widgets with the type \u201cbuy\u201d were included.\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total AR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n   CAST(\\n    SUM(\\n      CASE\\n        WHEN CONFIRMED THEN 1\\n        ELSE 0\\n      END\\n    ) AS float\\n  ) / NULLIF(COUNT(*), 0) as AR\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}}\\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"AR\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5488}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5488,{\"description\":\"Only calculations from widgets with the type \u201cbuy\u201d were included.\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total AR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n   CAST(\\n    SUM(\\n      CASE\\n        WHEN CONFIRMED THEN 1\\n        ELSE 0\\n      END\\n    ) AS float\\n  ) / NULLIF(COUNT(*), 0) as AR\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}}\\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"AR\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5488]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@5c23cb1c\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5488]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5488]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":\"Only calculations from widgets with the type \u201cbuy\u201d were included.\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total AR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n   CAST(\\n    SUM(\\n      CASE\\n        WHEN CONFIRMED THEN 1\\n        ELSE 0\\n      END\\n    ) AS float\\n  ) / NULLIF(COUNT(*), 0) as AR\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}}\\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"AR\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":\"Only calculations from widgets with the type \u201cbuy\u201d were included.\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total AR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n   CAST(\\n    SUM(\\n      CASE\\n        WHEN CONFIRMED THEN 1\\n        ELSE 0\\n      END\\n    ) AS float\\n  ) / NULLIF(COUNT(*), 0) as AR\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}}\\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"AR\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5488}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5488,{\"description\":\"Only calculations from widgets with the type \u201cbuy\u201d were included.\",\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Total AR\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  \\n   CAST(\\n    SUM(\\n      CASE\\n        WHEN CONFIRMED THEN 1\\n        ELSE 0\\n      END\\n    ) AS float\\n  ) / NULLIF(COUNT(*), 0) as AR\\nfrom MART.TRANSACTIONS\\nLEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere {{CARD_ISOCOUNTRY}}\\nand\\n      TYPE_MAIN = 'buy' and\\n      SOURCE_MAIN = 'widget'\\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}\"}},\"parameter_mappings\":[],\"display\":\"scalar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DATE_TRUNC('day',CREATED_AT)\"],\"column_settings\":{\"[\\\"name\\\",\\\"AR\\\"]\":{\"number_style\":\"percent\"}},\"graph.metrics\":[]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5485,
      "card_name": "Transaction size dynamic",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5485]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@7dfdf5bb\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5485]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5485]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Transaction size dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n  source_main, \\n round(sum(TRANSACTIONS.TURNOVER_EUR*cast(rr.RATE as DECIMAL(18,6))) / COUNT(*), 0) as \\\"Turnover to count of transactions\\\"\\n  from mart.Transactions \\n  LEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"SOURCE_MAIN\"],\"graph.metrics\":[\"Turnover to count of transactions\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Transaction size dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n  source_main, \\n round(sum(TRANSACTIONS.TURNOVER_EUR*cast(rr.RATE as DECIMAL(18,6))) / COUNT(*), 0) as \\\"Turnover to count of transactions\\\"\\n  from mart.Transactions \\n  LEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"SOURCE_MAIN\"],\"graph.metrics\":[\"Turnover to count of transactions\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5485}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5485,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Transaction size dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n  source_main, \\n round(sum(TRANSACTIONS.TURNOVER_EUR*cast(rr.RATE as DECIMAL(18,6))) / COUNT(*), 0) as \\\"Turnover to count of transactions\\\"\\n  from mart.Transactions \\n  LEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"SOURCE_MAIN\"],\"graph.metrics\":[\"Turnover to count of transactions\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5485]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@7dfdf5bb\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5485]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5485]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Transaction size dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n  source_main, \\n round(sum(TRANSACTIONS.TURNOVER_EUR*cast(rr.RATE as DECIMAL(18,6))) / COUNT(*), 0) as \\\"Turnover to count of transactions\\\"\\n  from mart.Transactions \\n  LEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"SOURCE_MAIN\"],\"graph.metrics\":[\"Turnover to count of transactions\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Transaction size dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n  source_main, \\n round(sum(TRANSACTIONS.TURNOVER_EUR*cast(rr.RATE as DECIMAL(18,6))) / COUNT(*), 0) as \\\"Turnover to count of transactions\\\"\\n  from mart.Transactions \\n  LEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"SOURCE_MAIN\"],\"graph.metrics\":[\"Turnover to count of transactions\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5485}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5485,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Transaction size dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"CRYPTO\":{\"type\":\"dimension\",\"name\":\"CRYPTO\",\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"display-name\":\"Crypto\",\"dimension\":[\"field\",20836,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}},\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",20834,null],\"widget-type\":\"string/=\"},\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",20835,null],\"widget-type\":\"date/all-options\",\"options\":null},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CURRENCY\":{\"type\":\"dimension\",\"name\":\"CURRENCY\",\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"display-name\":\"Currency\",\"dimension\":[\"field\",20892,null],\"widget-type\":\"string/=\"}},\"query\":\"Select  date_trunc('day',TRANSACTIONS.CREATED_AT) as \\\"Day\\\", \\n  source_main, \\n round(sum(TRANSACTIONS.TURNOVER_EUR*cast(rr.RATE as DECIMAL(18,6))) / COUNT(*), 0) as \\\"Turnover to count of transactions\\\"\\n  from mart.Transactions \\n  LEFT JOIN RATES.CURRENCY_RATES_PER_DAY___MART as rr\\n                                         on rr.FROM_CURRENCY = 'EUR' and\\n                                            rr.TO_CURRENCY = 'USD' and\\n                                            rr.dt = date_trunc('day',TRANSACTIONS.CREATED_AT) and\\n                                            rr.RATES_SOURCE = 'YAHOO_FINANCE'\\nwhere TRANSACTIONS.created_at >= '2025-01-01' and {{CARD_ISOCOUNTRY}} and CONFIRMED \\nand {{CREATED_AT}}\\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{CURRENCY}} and {{CRYPTO}} and {{TYPE}} and {{CARD_BIN}} and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_values\":true,\"graph.label_value_frequency\":\"fit\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"Day\",\"SOURCE_MAIN\"],\"graph.metrics\":[\"Turnover to count of transactions\"]},\"parameters\":[{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"},{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"1a31bc3f-cdc2-4904-b21d-9a150d0b7937\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CURRENCY\"]],\"name\":\"Currency\",\"slug\":\"CURRENCY\"},{\"id\":\"381c2993-7db6-4a68-9787-9cd1ec02b7b9\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CRYPTO\"]],\"name\":\"Crypto\",\"slug\":\"CRYPTO\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5475,
      "card_name": "Antifraud",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5475]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@5ba1fd8e\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5475]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5475]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Antifraud\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"e3597fa4-8bd1-428c-8ff3-ce2b1bc19117\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",1700,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"\\nSELECT\\n    CAST(CREATED_AT AS DATE) AS \\\"Date\\\",\\n    CASE\\n        WHEN COUNT(CASE WHEN STATUS_RISKIFIED IS NOT NULL THEN 1 END) > 0\\n        THEN ROUND(\\n            SUM(CASE WHEN STATUS_RISKIFIED = TRUE THEN 1 ELSE 0 END) * 1.0\\n            / COUNT(CASE WHEN STATUS_RISKIFIED IS NOT NULL THEN 1 END) * 100,\\n            1\\n        )\\n        ELSE 0\\n    END AS \\\"Riskified conversion rate (%)\\\",\\n    CASE\\n        WHEN SUM(CASE WHEN ANTIFRAUD_STATUS IS NOT NULL AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) > 0\\n        THEN ROUND(\\n            SUM(CASE WHEN ANTIFRAUD_STATUS = TRUE AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) * 1.0\\n            / SUM(CASE WHEN ANTIFRAUD_STATUS IS NOT NULL AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) * 100,\\n            1\\n        )\\n        ELSE 0\\n    END AS \\\"Antifraud (no riskified) conversion rate (%)\\\"\\nFROM MART.CALCULATIONS_UNIQ\\nWHERE CREATED_AT >= add_months(now(), -4) and USR_COUNTRY_ENG='United States of America'\\nand DATE_TRUNC('week', CREATED_AT) != DATE_TRUNC('week', NOW()) and {{CREATED_AT}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"table.pivot_column\":\"Riskified conversion rate (%)\",\"table.cell_column\":\"Antifraud (no riskified) conversion rate (%)\",\"graph.show_values\":true,\"graph.dimensions\":[\"Date\"],\"graph.y_axis.title_text\":\"Conversion rate\",\"column_settings\":{\"[\\\"name\\\",\\\"Riskified conversion rate (%)\\\"]\":{\"suffix\":\"%\"},\"[\\\"name\\\",\\\"Antifraud (no riskified) conversion rate (%)\\\"]\":{\"suffix\":\"%\"}},\"graph.metrics\":[\"Riskified conversion rate (%)\",\"Antifraud (no riskified) conversion rate (%)\"]},\"parameters\":[{\"id\":\"e3597fa4-8bd1-428c-8ff3-ce2b1bc19117\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Antifraud\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"e3597fa4-8bd1-428c-8ff3-ce2b1bc19117\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",1700,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"\\nSELECT\\n    CAST(CREATED_AT AS DATE) AS \\\"Date\\\",\\n    CASE\\n        WHEN COUNT(CASE WHEN STATUS_RISKIFIED IS NOT NULL THEN 1 END) > 0\\n        THEN ROUND(\\n            SUM(CASE WHEN STATUS_RISKIFIED = TRUE THEN 1 ELSE 0 END) * 1.0\\n            / COUNT(CASE WHEN STATUS_RISKIFIED IS NOT NULL THEN 1 END) * 100,\\n            1\\n        )\\n        ELSE 0\\n    END AS \\\"Riskified conversion rate (%)\\\",\\n    CASE\\n        WHEN SUM(CASE WHEN ANTIFRAUD_STATUS IS NOT NULL AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) > 0\\n        THEN ROUND(\\n            SUM(CASE WHEN ANTIFRAUD_STATUS = TRUE AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) * 1.0\\n            / SUM(CASE WHEN ANTIFRAUD_STATUS IS NOT NULL AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) * 100,\\n            1\\n        )\\n        ELSE 0\\n    END AS \\\"Antifraud (no riskified) conversion rate (%)\\\"\\nFROM MART.CALCULATIONS_UNIQ\\nWHERE CREATED_AT >= add_months(now(), -4) and USR_COUNTRY_ENG='United States of America'\\nand DATE_TRUNC('week', CREATED_AT) != DATE_TRUNC('week', NOW()) and {{CREATED_AT}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"table.pivot_column\":\"Riskified conversion rate (%)\",\"table.cell_column\":\"Antifraud (no riskified) conversion rate (%)\",\"graph.show_values\":true,\"graph.dimensions\":[\"Date\"],\"graph.y_axis.title_text\":\"Conversion rate\",\"column_settings\":{\"[\\\"name\\\",\\\"Riskified conversion rate (%)\\\"]\":{\"suffix\":\"%\"},\"[\\\"name\\\",\\\"Antifraud (no riskified) conversion rate (%)\\\"]\":{\"suffix\":\"%\"}},\"graph.metrics\":[\"Riskified conversion rate (%)\",\"Antifraud (no riskified) conversion rate (%)\"]},\"parameters\":[{\"id\":\"e3597fa4-8bd1-428c-8ff3-ce2b1bc19117\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5475}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5475,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Antifraud\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"e3597fa4-8bd1-428c-8ff3-ce2b1bc19117\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",1700,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"\\nSELECT\\n    CAST(CREATED_AT AS DATE) AS \\\"Date\\\",\\n    CASE\\n        WHEN COUNT(CASE WHEN STATUS_RISKIFIED IS NOT NULL THEN 1 END) > 0\\n        THEN ROUND(\\n            SUM(CASE WHEN STATUS_RISKIFIED = TRUE THEN 1 ELSE 0 END) * 1.0\\n            / COUNT(CASE WHEN STATUS_RISKIFIED IS NOT NULL THEN 1 END) * 100,\\n            1\\n        )\\n        ELSE 0\\n    END AS \\\"Riskified conversion rate (%)\\\",\\n    CASE\\n        WHEN SUM(CASE WHEN ANTIFRAUD_STATUS IS NOT NULL AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) > 0\\n        THEN ROUND(\\n            SUM(CASE WHEN ANTIFRAUD_STATUS = TRUE AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) * 1.0\\n            / SUM(CASE WHEN ANTIFRAUD_STATUS IS NOT NULL AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) * 100,\\n            1\\n        )\\n        ELSE 0\\n    END AS \\\"Antifraud (no riskified) conversion rate (%)\\\"\\nFROM MART.CALCULATIONS_UNIQ\\nWHERE CREATED_AT >= add_months(now(), -4) and USR_COUNTRY_ENG='United States of America'\\nand DATE_TRUNC('week', CREATED_AT) != DATE_TRUNC('week', NOW()) and {{CREATED_AT}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"table.pivot_column\":\"Riskified conversion rate (%)\",\"table.cell_column\":\"Antifraud (no riskified) conversion rate (%)\",\"graph.show_values\":true,\"graph.dimensions\":[\"Date\"],\"graph.y_axis.title_text\":\"Conversion rate\",\"column_settings\":{\"[\\\"name\\\",\\\"Riskified conversion rate (%)\\\"]\":{\"suffix\":\"%\"},\"[\\\"name\\\",\\\"Antifraud (no riskified) conversion rate (%)\\\"]\":{\"suffix\":\"%\"}},\"graph.metrics\":[\"Riskified conversion rate (%)\",\"Antifraud (no riskified) conversion rate (%)\"]},\"parameters\":[{\"id\":\"e3597fa4-8bd1-428c-8ff3-ce2b1bc19117\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5475]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@5ba1fd8e\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5475]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5475]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Antifraud\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"e3597fa4-8bd1-428c-8ff3-ce2b1bc19117\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",1700,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"\\nSELECT\\n    CAST(CREATED_AT AS DATE) AS \\\"Date\\\",\\n    CASE\\n        WHEN COUNT(CASE WHEN STATUS_RISKIFIED IS NOT NULL THEN 1 END) > 0\\n        THEN ROUND(\\n            SUM(CASE WHEN STATUS_RISKIFIED = TRUE THEN 1 ELSE 0 END) * 1.0\\n            / COUNT(CASE WHEN STATUS_RISKIFIED IS NOT NULL THEN 1 END) * 100,\\n            1\\n        )\\n        ELSE 0\\n    END AS \\\"Riskified conversion rate (%)\\\",\\n    CASE\\n        WHEN SUM(CASE WHEN ANTIFRAUD_STATUS IS NOT NULL AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) > 0\\n        THEN ROUND(\\n            SUM(CASE WHEN ANTIFRAUD_STATUS = TRUE AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) * 1.0\\n            / SUM(CASE WHEN ANTIFRAUD_STATUS IS NOT NULL AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) * 100,\\n            1\\n        )\\n        ELSE 0\\n    END AS \\\"Antifraud (no riskified) conversion rate (%)\\\"\\nFROM MART.CALCULATIONS_UNIQ\\nWHERE CREATED_AT >= add_months(now(), -4) and USR_COUNTRY_ENG='United States of America'\\nand DATE_TRUNC('week', CREATED_AT) != DATE_TRUNC('week', NOW()) and {{CREATED_AT}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"table.pivot_column\":\"Riskified conversion rate (%)\",\"table.cell_column\":\"Antifraud (no riskified) conversion rate (%)\",\"graph.show_values\":true,\"graph.dimensions\":[\"Date\"],\"graph.y_axis.title_text\":\"Conversion rate\",\"column_settings\":{\"[\\\"name\\\",\\\"Riskified conversion rate (%)\\\"]\":{\"suffix\":\"%\"},\"[\\\"name\\\",\\\"Antifraud (no riskified) conversion rate (%)\\\"]\":{\"suffix\":\"%\"}},\"graph.metrics\":[\"Riskified conversion rate (%)\",\"Antifraud (no riskified) conversion rate (%)\"]},\"parameters\":[{\"id\":\"e3597fa4-8bd1-428c-8ff3-ce2b1bc19117\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Antifraud\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"e3597fa4-8bd1-428c-8ff3-ce2b1bc19117\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",1700,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"\\nSELECT\\n    CAST(CREATED_AT AS DATE) AS \\\"Date\\\",\\n    CASE\\n        WHEN COUNT(CASE WHEN STATUS_RISKIFIED IS NOT NULL THEN 1 END) > 0\\n        THEN ROUND(\\n            SUM(CASE WHEN STATUS_RISKIFIED = TRUE THEN 1 ELSE 0 END) * 1.0\\n            / COUNT(CASE WHEN STATUS_RISKIFIED IS NOT NULL THEN 1 END) * 100,\\n            1\\n        )\\n        ELSE 0\\n    END AS \\\"Riskified conversion rate (%)\\\",\\n    CASE\\n        WHEN SUM(CASE WHEN ANTIFRAUD_STATUS IS NOT NULL AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) > 0\\n        THEN ROUND(\\n            SUM(CASE WHEN ANTIFRAUD_STATUS = TRUE AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) * 1.0\\n            / SUM(CASE WHEN ANTIFRAUD_STATUS IS NOT NULL AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) * 100,\\n            1\\n        )\\n        ELSE 0\\n    END AS \\\"Antifraud (no riskified) conversion rate (%)\\\"\\nFROM MART.CALCULATIONS_UNIQ\\nWHERE CREATED_AT >= add_months(now(), -4) and USR_COUNTRY_ENG='United States of America'\\nand DATE_TRUNC('week', CREATED_AT) != DATE_TRUNC('week', NOW()) and {{CREATED_AT}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"table.pivot_column\":\"Riskified conversion rate (%)\",\"table.cell_column\":\"Antifraud (no riskified) conversion rate (%)\",\"graph.show_values\":true,\"graph.dimensions\":[\"Date\"],\"graph.y_axis.title_text\":\"Conversion rate\",\"column_settings\":{\"[\\\"name\\\",\\\"Riskified conversion rate (%)\\\"]\":{\"suffix\":\"%\"},\"[\\\"name\\\",\\\"Antifraud (no riskified) conversion rate (%)\\\"]\":{\"suffix\":\"%\"}},\"graph.metrics\":[\"Riskified conversion rate (%)\",\"Antifraud (no riskified) conversion rate (%)\"]},\"parameters\":[{\"id\":\"e3597fa4-8bd1-428c-8ff3-ce2b1bc19117\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5475}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5475,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Antifraud\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"e3597fa4-8bd1-428c-8ff3-ce2b1bc19117\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",1700,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"\\nSELECT\\n    CAST(CREATED_AT AS DATE) AS \\\"Date\\\",\\n    CASE\\n        WHEN COUNT(CASE WHEN STATUS_RISKIFIED IS NOT NULL THEN 1 END) > 0\\n        THEN ROUND(\\n            SUM(CASE WHEN STATUS_RISKIFIED = TRUE THEN 1 ELSE 0 END) * 1.0\\n            / COUNT(CASE WHEN STATUS_RISKIFIED IS NOT NULL THEN 1 END) * 100,\\n            1\\n        )\\n        ELSE 0\\n    END AS \\\"Riskified conversion rate (%)\\\",\\n    CASE\\n        WHEN SUM(CASE WHEN ANTIFRAUD_STATUS IS NOT NULL AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) > 0\\n        THEN ROUND(\\n            SUM(CASE WHEN ANTIFRAUD_STATUS = TRUE AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) * 1.0\\n            / SUM(CASE WHEN ANTIFRAUD_STATUS IS NOT NULL AND STATUS_RISKIFIED IS NULL THEN 1 ELSE 0 END) * 100,\\n            1\\n        )\\n        ELSE 0\\n    END AS \\\"Antifraud (no riskified) conversion rate (%)\\\"\\nFROM MART.CALCULATIONS_UNIQ\\nWHERE CREATED_AT >= add_months(now(), -4) and USR_COUNTRY_ENG='United States of America'\\nand DATE_TRUNC('week', CREATED_AT) != DATE_TRUNC('week', NOW()) and {{CREATED_AT}} and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"line\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"table.pivot_column\":\"Riskified conversion rate (%)\",\"table.cell_column\":\"Antifraud (no riskified) conversion rate (%)\",\"graph.show_values\":true,\"graph.dimensions\":[\"Date\"],\"graph.y_axis.title_text\":\"Conversion rate\",\"column_settings\":{\"[\\\"name\\\",\\\"Riskified conversion rate (%)\\\"]\":{\"suffix\":\"%\"},\"[\\\"name\\\",\\\"Antifraud (no riskified) conversion rate (%)\\\"]\":{\"suffix\":\"%\"}},\"graph.metrics\":[\"Riskified conversion rate (%)\",\"Antifraud (no riskified) conversion rate (%)\"]},\"parameters\":[{\"id\":\"e3597fa4-8bd1-428c-8ff3-ce2b1bc19117\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5478,
      "card_name": "Reason reject statistics",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5478]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@6e45c75b\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5478]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5478]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Reason reject statistics\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"8ffd33df-2180-49b5-8780-654bd3c9f143\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",1700,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"\\n    SELECT\\n        -- to_date(CREATED_AT) AS dt,\\n        CASE\\n            WHEN REASON_REJECT LIKE 'riskified%' THEN 'riskified reject'\\n            ELSE REASON_REJECT\\n        END AS REASON_REJECT,\\n        COUNT(1) AS error_count\\n    FROM MART.CALCULATIONS_UNIQ\\n    LEFT JOIN (\\n        SELECT\\n            ANTIFRAUD_EVENTS.ID,\\n            ANTIFRAUD_TX.REASON_REJECT, ANTIFRAUD_TX.bank_country\\n        FROM MART.ANTIFRAUD_TX\\n        INNER JOIN ANTIFRAUD.ANTIFRAUD_EVENTS\\n            ON ANTIFRAUD_EVENTS.TX_ID = ANTIFRAUD_TX.TX_ID\\n        WHERE to_date(ANTIFRAUD_TX.PAYMENT_AT) >= add_months(now(), -4)\\n    ) AS ant\\n      ON ant.id = CALCULATIONS_UNIQ.UUID_ANTIFRAUD_CHECK\\n    WHERE CREATED_AT >= add_months(now(), -4) and {{CREATED_AT}}\\n    and ant.bank_country = 'United States of America'\\n      AND ANTIFRAUD_STATUS IS FALSE and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"pie\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"pie.show_labels\":false},\"parameters\":[{\"id\":\"8ffd33df-2180-49b5-8780-654bd3c9f143\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Reason reject statistics\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"8ffd33df-2180-49b5-8780-654bd3c9f143\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",1700,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"\\n    SELECT\\n        -- to_date(CREATED_AT) AS dt,\\n        CASE\\n            WHEN REASON_REJECT LIKE 'riskified%' THEN 'riskified reject'\\n            ELSE REASON_REJECT\\n        END AS REASON_REJECT,\\n        COUNT(1) AS error_count\\n    FROM MART.CALCULATIONS_UNIQ\\n    LEFT JOIN (\\n        SELECT\\n            ANTIFRAUD_EVENTS.ID,\\n            ANTIFRAUD_TX.REASON_REJECT, ANTIFRAUD_TX.bank_country\\n        FROM MART.ANTIFRAUD_TX\\n        INNER JOIN ANTIFRAUD.ANTIFRAUD_EVENTS\\n            ON ANTIFRAUD_EVENTS.TX_ID = ANTIFRAUD_TX.TX_ID\\n        WHERE to_date(ANTIFRAUD_TX.PAYMENT_AT) >= add_months(now(), -4)\\n    ) AS ant\\n      ON ant.id = CALCULATIONS_UNIQ.UUID_ANTIFRAUD_CHECK\\n    WHERE CREATED_AT >= add_months(now(), -4) and {{CREATED_AT}}\\n    and ant.bank_country = 'United States of America'\\n      AND ANTIFRAUD_STATUS IS FALSE and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"pie\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"pie.show_labels\":false},\"parameters\":[{\"id\":\"8ffd33df-2180-49b5-8780-654bd3c9f143\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5478}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5478,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Reason reject statistics\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"8ffd33df-2180-49b5-8780-654bd3c9f143\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",1700,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"\\n    SELECT\\n        -- to_date(CREATED_AT) AS dt,\\n        CASE\\n            WHEN REASON_REJECT LIKE 'riskified%' THEN 'riskified reject'\\n            ELSE REASON_REJECT\\n        END AS REASON_REJECT,\\n        COUNT(1) AS error_count\\n    FROM MART.CALCULATIONS_UNIQ\\n    LEFT JOIN (\\n        SELECT\\n            ANTIFRAUD_EVENTS.ID,\\n            ANTIFRAUD_TX.REASON_REJECT, ANTIFRAUD_TX.bank_country\\n        FROM MART.ANTIFRAUD_TX\\n        INNER JOIN ANTIFRAUD.ANTIFRAUD_EVENTS\\n            ON ANTIFRAUD_EVENTS.TX_ID = ANTIFRAUD_TX.TX_ID\\n        WHERE to_date(ANTIFRAUD_TX.PAYMENT_AT) >= add_months(now(), -4)\\n    ) AS ant\\n      ON ant.id = CALCULATIONS_UNIQ.UUID_ANTIFRAUD_CHECK\\n    WHERE CREATED_AT >= add_months(now(), -4) and {{CREATED_AT}}\\n    and ant.bank_country = 'United States of America'\\n      AND ANTIFRAUD_STATUS IS FALSE and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"pie\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"pie.show_labels\":false},\"parameters\":[{\"id\":\"8ffd33df-2180-49b5-8780-654bd3c9f143\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5478]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@6e45c75b\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5478]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5478]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Reason reject statistics\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"8ffd33df-2180-49b5-8780-654bd3c9f143\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",1700,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"\\n    SELECT\\n        -- to_date(CREATED_AT) AS dt,\\n        CASE\\n            WHEN REASON_REJECT LIKE 'riskified%' THEN 'riskified reject'\\n            ELSE REASON_REJECT\\n        END AS REASON_REJECT,\\n        COUNT(1) AS error_count\\n    FROM MART.CALCULATIONS_UNIQ\\n    LEFT JOIN (\\n        SELECT\\n            ANTIFRAUD_EVENTS.ID,\\n            ANTIFRAUD_TX.REASON_REJECT, ANTIFRAUD_TX.bank_country\\n        FROM MART.ANTIFRAUD_TX\\n        INNER JOIN ANTIFRAUD.ANTIFRAUD_EVENTS\\n            ON ANTIFRAUD_EVENTS.TX_ID = ANTIFRAUD_TX.TX_ID\\n        WHERE to_date(ANTIFRAUD_TX.PAYMENT_AT) >= add_months(now(), -4)\\n    ) AS ant\\n      ON ant.id = CALCULATIONS_UNIQ.UUID_ANTIFRAUD_CHECK\\n    WHERE CREATED_AT >= add_months(now(), -4) and {{CREATED_AT}}\\n    and ant.bank_country = 'United States of America'\\n      AND ANTIFRAUD_STATUS IS FALSE and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"pie\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"pie.show_labels\":false},\"parameters\":[{\"id\":\"8ffd33df-2180-49b5-8780-654bd3c9f143\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Reason reject statistics\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"8ffd33df-2180-49b5-8780-654bd3c9f143\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",1700,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"\\n    SELECT\\n        -- to_date(CREATED_AT) AS dt,\\n        CASE\\n            WHEN REASON_REJECT LIKE 'riskified%' THEN 'riskified reject'\\n            ELSE REASON_REJECT\\n        END AS REASON_REJECT,\\n        COUNT(1) AS error_count\\n    FROM MART.CALCULATIONS_UNIQ\\n    LEFT JOIN (\\n        SELECT\\n            ANTIFRAUD_EVENTS.ID,\\n            ANTIFRAUD_TX.REASON_REJECT, ANTIFRAUD_TX.bank_country\\n        FROM MART.ANTIFRAUD_TX\\n        INNER JOIN ANTIFRAUD.ANTIFRAUD_EVENTS\\n            ON ANTIFRAUD_EVENTS.TX_ID = ANTIFRAUD_TX.TX_ID\\n        WHERE to_date(ANTIFRAUD_TX.PAYMENT_AT) >= add_months(now(), -4)\\n    ) AS ant\\n      ON ant.id = CALCULATIONS_UNIQ.UUID_ANTIFRAUD_CHECK\\n    WHERE CREATED_AT >= add_months(now(), -4) and {{CREATED_AT}}\\n    and ant.bank_country = 'United States of America'\\n      AND ANTIFRAUD_STATUS IS FALSE and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"pie\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"pie.show_labels\":false},\"parameters\":[{\"id\":\"8ffd33df-2180-49b5-8780-654bd3c9f143\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5478}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5478,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"Reason reject statistics\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"CREATED_AT\":{\"type\":\"dimension\",\"name\":\"CREATED_AT\",\"id\":\"8ffd33df-2180-49b5-8780-654bd3c9f143\",\"display-name\":\"Created At\",\"default\":null,\"dimension\":[\"field\",1700,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"\\n    SELECT\\n        -- to_date(CREATED_AT) AS dt,\\n        CASE\\n            WHEN REASON_REJECT LIKE 'riskified%' THEN 'riskified reject'\\n            ELSE REASON_REJECT\\n        END AS REASON_REJECT,\\n        COUNT(1) AS error_count\\n    FROM MART.CALCULATIONS_UNIQ\\n    LEFT JOIN (\\n        SELECT\\n            ANTIFRAUD_EVENTS.ID,\\n            ANTIFRAUD_TX.REASON_REJECT, ANTIFRAUD_TX.bank_country\\n        FROM MART.ANTIFRAUD_TX\\n        INNER JOIN ANTIFRAUD.ANTIFRAUD_EVENTS\\n            ON ANTIFRAUD_EVENTS.TX_ID = ANTIFRAUD_TX.TX_ID\\n        WHERE to_date(ANTIFRAUD_TX.PAYMENT_AT) >= add_months(now(), -4)\\n    ) AS ant\\n      ON ant.id = CALCULATIONS_UNIQ.UUID_ANTIFRAUD_CHECK\\n    WHERE CREATED_AT >= add_months(now(), -4) and {{CREATED_AT}}\\n    and ant.bank_country = 'United States of America'\\n      AND ANTIFRAUD_STATUS IS FALSE and {{Card_Geo}}GROUP BY\"}},\"parameter_mappings\":[],\"display\":\"pie\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"pie.show_labels\":false},\"parameters\":[{\"id\":\"8ffd33df-2180-49b5-8780-654bd3c9f143\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"CREATED_AT\"]],\"name\":\"Created At\",\"slug\":\"CREATED_AT\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    },
    {
      "card_id": 5481,
      "card_name": "KYC dynamic",
      "error": "API error: 400 - {\"via\":[{\"type\":\"clojure.lang.ExceptionInfo\",\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5481]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@75abb506\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5481]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5481]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"KYC dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",4073,null],\"widget-type\":\"string/=\"},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"Registration\":{\"type\":\"dimension\",\"name\":\"Registration\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Registration\",\"default\":null,\"dimension\":[\"field\",4094,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"with cte as(  \\n\\nselect to_date(REG_DT)                                                      as DT\\n                     , REG_SOURCE_MAIN                                                      as reg_source\\n                     , WIDGET_KYC_TYPE\\n                     , WIDGET_PARTNER_NAME\\n                     , KYC_SOURCE\\n                     , KYC_STATUS_KYC_SSN                                                   AS SSN_STATUS\\n                     , case when KYC_STATUS = 'GREEN' then 'Approved Checks'\\n                            when KYC_STATUS = 'RED' then 'Rejected Checks' end              AS Type_KYC\\n                from MART.USERS\\n                where KYC_STATUS in ('RED', 'GREEN') and REG_SOURCE_MAIN = 'widget'\\n                and DATE_TRUNC('week', REG_DT) != DATE_TRUNC('week', NOW()) \\n                and KYC_DOC_COUNTRY='United States of America' \\nand {{Registration}} \\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{TYPE}} and {{CARD_BIN}}\\n ) select Type_KYC, dt, count(1) as cnt_value\\n                  from cte and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_goal\":false,\"graph.show_trendline\":false,\"graph.y_axis.title_text\":\"Count checks\",\"graph.show_values\":true,\"graph.x_axis.title_text\":\"Date\",\"graph.label_value_frequency\":\"fit\",\"graph.metrics\":[\"CNT_VALUE\"],\"graph.y_axis.axis_enabled\":true,\"graph.show_stack_values\":\"total\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DT\",\"TYPE_KYC\"],\"stackable.stack_type\":\"stacked\"},\"parameters\":[{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"},{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"Registration\"]],\"name\":\"Registration\",\"slug\":\"Registration\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"KYC dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",4073,null],\"widget-type\":\"string/=\"},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"Registration\":{\"type\":\"dimension\",\"name\":\"Registration\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Registration\",\"default\":null,\"dimension\":[\"field\",4094,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"with cte as(  \\n\\nselect to_date(REG_DT)                                                      as DT\\n                     , REG_SOURCE_MAIN                                                      as reg_source\\n                     , WIDGET_KYC_TYPE\\n                     , WIDGET_PARTNER_NAME\\n                     , KYC_SOURCE\\n                     , KYC_STATUS_KYC_SSN                                                   AS SSN_STATUS\\n                     , case when KYC_STATUS = 'GREEN' then 'Approved Checks'\\n                            when KYC_STATUS = 'RED' then 'Rejected Checks' end              AS Type_KYC\\n                from MART.USERS\\n                where KYC_STATUS in ('RED', 'GREEN') and REG_SOURCE_MAIN = 'widget'\\n                and DATE_TRUNC('week', REG_DT) != DATE_TRUNC('week', NOW()) \\n                and KYC_DOC_COUNTRY='United States of America' \\nand {{Registration}} \\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{TYPE}} and {{CARD_BIN}}\\n ) select Type_KYC, dt, count(1) as cnt_value\\n                  from cte and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_goal\":false,\"graph.show_trendline\":false,\"graph.y_axis.title_text\":\"Count checks\",\"graph.show_values\":true,\"graph.x_axis.title_text\":\"Date\",\"graph.label_value_frequency\":\"fit\",\"graph.metrics\":[\"CNT_VALUE\"],\"graph.y_axis.axis_enabled\":true,\"graph.show_stack_values\":\"total\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DT\",\"TYPE_KYC\"],\"stackable.stack_type\":\"stacked\"},\"parameters\":[{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"},{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"Registration\"]],\"name\":\"Registration\",\"slug\":\"Registration\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5481}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5481,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"KYC dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",4073,null],\"widget-type\":\"string/=\"},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"Registration\":{\"type\":\"dimension\",\"name\":\"Registration\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Registration\",\"default\":null,\"dimension\":[\"field\",4094,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"with cte as(  \\n\\nselect to_date(REG_DT)                                                      as DT\\n                     , REG_SOURCE_MAIN                                                      as reg_source\\n                     , WIDGET_KYC_TYPE\\n                     , WIDGET_PARTNER_NAME\\n                     , KYC_SOURCE\\n                     , KYC_STATUS_KYC_SSN                                                   AS SSN_STATUS\\n                     , case when KYC_STATUS = 'GREEN' then 'Approved Checks'\\n                            when KYC_STATUS = 'RED' then 'Rejected Checks' end              AS Type_KYC\\n                from MART.USERS\\n                where KYC_STATUS in ('RED', 'GREEN') and REG_SOURCE_MAIN = 'widget'\\n                and DATE_TRUNC('week', REG_DT) != DATE_TRUNC('week', NOW()) \\n                and KYC_DOC_COUNTRY='United States of America' \\nand {{Registration}} \\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{TYPE}} and {{CARD_BIN}}\\n ) select Type_KYC, dt, count(1) as cnt_value\\n                  from cte and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_goal\":false,\"graph.show_trendline\":false,\"graph.y_axis.title_text\":\"Count checks\",\"graph.show_values\":true,\"graph.x_axis.title_text\":\"Date\",\"graph.label_value_frequency\":\"fit\",\"graph.metrics\":[\"CNT_VALUE\"],\"graph.y_axis.axis_enabled\":true,\"graph.show_stack_values\":\"total\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DT\",\"TYPE_KYC\"],\"stackable.stack_type\":\"stacked\"},\"parameters\":[{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"},{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"Registration\"]],\"name\":\"Registration\",\"slug\":\"Registration\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"at\":[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397]}],\"trace\":[[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invokeStatic\",\"card.clj\",397],[\"metabase.models.card$check_field_filter_fields_are_from_correct_database\",\"invoke\",\"card.clj\",375],[\"metabase.models.card$pre_update\",\"invokeStatic\",\"card.clj\",537],[\"metabase.models.card$pre_update\",\"invoke\",\"card.clj\",501],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invokeStatic\",\"card.clj\",606],[\"metabase.models.card$before_update_primary_method_model_Card\",\"invoke\",\"card.clj\",598],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invokeStatic\",\"before_update.clj\",34],[\"toucan2.tools.before_update$before_update_around_method_default\",\"invoke\",\"before_update.clj\",30],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.tools.before_update$changes__GT_affected_pk_maps_rf$fn__26963\",\"invoke\",\"before_update.clj\",54],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"clojure.core$map$fn__5950$fn__5951\",\"invoke\",\"core.clj\",2759],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invokeStatic\",\"result_set.clj\",156],[\"toucan2.jdbc.result_set$reduce_result_set\",\"invoke\",\"result_set.clj\",125],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invokeStatic\",\"query.clj\",51],[\"toucan2.jdbc.query$reduce_jdbc_query\",\"invoke\",\"query.clj\",22],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invokeStatic\",\"pipeline.clj\",19],[\"toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default\",\"invoke\",\"pipeline.clj\",9],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_execute$with_connection_STAR___22818\",\"invoke\",\"pipeline.clj\",78],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",13],[\"toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",11],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.pipeline$transduce_execute\",\"invokeStatic\",\"pipeline.clj\",77],[\"toucan2.pipeline$transduce_execute\",\"invoke\",\"pipeline.clj\",64],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",401],[\"toucan2.pipeline$transduce_compiled_query\",\"invokeStatic\",\"pipeline.clj\",244],[\"toucan2.pipeline$transduce_compiled_query\",\"invoke\",\"pipeline.clj\",240],[\"toucan2.pipeline$transduce_built_query\",\"invokeStatic\",\"pipeline.clj\",252],[\"toucan2.pipeline$transduce_built_query\",\"invoke\",\"pipeline.clj\",246],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invokeStatic\",\"pipeline.clj\",272],[\"toucan2.pipeline$transduce_query_primary_method_default\",\"invoke\",\"pipeline.clj\",269],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invokeStatic\",\"before_update.clj\",71],[\"toucan2.tools.before_update$fetch_changes__GT_pk_maps\",\"invoke\",\"before_update.clj\",69],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invokeStatic\",\"before_update.clj\",85],[\"toucan2.tools.before_update$apply_before_update_to_matching_rows\",\"invoke\",\"before_update.clj\",79],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invokeStatic\",\"before_update.clj\",110],[\"toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default\",\"invoke\",\"before_update.clj\",96],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",15],[\"methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733\",\"invoke\",\"threaded.clj\",64],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",65],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",216],[\"toucan2.pipeline$transduce_query_STAR_\",\"invokeStatic\",\"pipeline.clj\",278],[\"toucan2.pipeline$transduce_query_STAR_\",\"invoke\",\"pipeline.clj\",274],[\"toucan2.pipeline$transduce_with_model\",\"invokeStatic\",\"pipeline.clj\",293],[\"toucan2.pipeline$transduce_with_model\",\"invoke\",\"pipeline.clj\",280],[\"toucan2.pipeline$transduce_parsed\",\"invokeStatic\",\"pipeline.clj\",309],[\"toucan2.pipeline$transduce_parsed\",\"invoke\",\"pipeline.clj\",295],[\"toucan2.pipeline$transduce_unparsed\",\"invokeStatic\",\"pipeline.clj\",317],[\"toucan2.pipeline$transduce_unparsed\",\"invoke\",\"pipeline.clj\",311],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invokeStatic\",\"pipeline.clj\",383],[\"toucan2.pipeline$transduce_unparsed_with_default_rf\",\"invoke\",\"pipeline.clj\",377],[\"toucan2.update$update_BANG_\",\"invokeStatic\",\"update.clj\",53],[\"toucan2.update$update_BANG_\",\"doInvoke\",\"update.clj\",50],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713$with_transaction_STAR___80714\",\"invoke\",\"card.clj\",894],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"metabase.db.connection$do_transaction$thunk__43657\",\"invoke\",\"connection.clj\",140],[\"metabase.db.connection$do_transaction\",\"invokeStatic\",\"connection.clj\",159],[\"metabase.db.connection$do_transaction\",\"invoke\",\"connection.clj\",136],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invokeStatic\",\"connection.clj\",196],[\"metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection\",\"invoke\",\"connection.clj\",169],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",249],[\"toucan2.connection$do_with_transaction_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",245],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",13],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",58],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",212],[\"metabase.models.card$update_card_BANG_$with_connection_STAR___80713\",\"invoke\",\"card.clj\",881],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.connection$bind_current_connectable_fn$fn__22495\",\"invoke\",\"connection.clj\",104],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invokeStatic\",\"connection.clj\",18],[\"toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource\",\"invoke\",\"connection.clj\",15],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invokeStatic\",\"connection.clj\",132],[\"metabase.db.connection$do_with_connection_primary_method_default\",\"invoke\",\"connection.clj\",130],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"toucan2.connection$do_with_connection_primary_method_\",\"invokeStatic\",\"connection.clj\",204],[\"toucan2.connection$do_with_connection_primary_method_\",\"invoke\",\"connection.clj\",194],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invokeStatic\",\"connection.clj\",118],[\"toucan2.connection$do_with_connection_around_method_toucan2_connection_default\",\"invoke\",\"connection.clj\",106],[\"methodical.impl.combo.common$partial_STAR_$fn__19422\",\"invoke\",\"common.clj\",12],[\"methodical.util.FnWithMeta\",\"invoke\",\"util.clj\",46],[\"methodical.impl.standard$invoke_multifn\",\"invokeStatic\",\"standard.clj\",55],[\"methodical.impl.standard$invoke_multifn\",\"invoke\",\"standard.clj\",47],[\"methodical.impl.standard.StandardMultiFn\",\"invoke\",\"standard.clj\",210],[\"metabase.models.card$update_card_BANG_\",\"invokeStatic\",\"card.clj\",881],[\"metabase.models.card$update_card_BANG_\",\"invoke\",\"card.clj\",876],[\"metabase.api.card$fn__103613\",\"invokeStatic\",\"card.clj\",574],[\"metabase.api.card$fn__103613\",\"invoke\",\"card.clj\",526],[\"compojure.core$wrap_response$fn__54250\",\"invoke\",\"core.clj\",160],[\"compojure.core$wrap_route_middleware$fn__54234\",\"invoke\",\"core.clj\",132],[\"compojure.core$wrap_route_info$fn__54239\",\"invoke\",\"core.clj\",139],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",151],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"metabase.server.middleware.auth$enforce_authentication$fn__104954\",\"invoke\",\"auth.clj\",18],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.lang.AFunction$1\",\"doInvoke\",\"AFunction.java\",33],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"clojure.lang.Var\",\"invoke\",\"Var.java\",395],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"metabase.api.routes$fn__109599$fn__109602\",\"invoke\",\"routes.clj\",75],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"clojure.lang.AFn\",\"applyToHelper\",\"AFn.java\",160],[\"clojure.lang.AFn\",\"applyTo\",\"AFn.java\",144],[\"clojure.core$apply\",\"invokeStatic\",\"core.clj\",667],[\"clojure.core$apply\",\"invoke\",\"core.clj\",662],[\"metabase.server.routes$fn__110355$fn__110356\",\"doInvoke\",\"routes.clj\",67],[\"clojure.lang.RestFn\",\"invoke\",\"RestFn.java\",439],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$wrap_route_matches$fn__54243\",\"invoke\",\"core.clj\",153],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",199],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$make_context$handler__54290\",\"invoke\",\"core.clj\",290],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",300],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262$f__54263$respond_SINGLEQUOTE___54264\",\"invoke\",\"core.clj\",197],[\"compojure.core$make_context$fn__54294\",\"invoke\",\"core.clj\",301],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"compojure.core$routes$fn__54262$f__54263\",\"invoke\",\"core.clj\",198],[\"compojure.core$routes$fn__54262\",\"invoke\",\"core.clj\",200],[\"metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107083\",\"invoke\",\"exceptions.clj\",111],[\"metabase.server.middleware.exceptions$catch_api_exceptions$fn__107080\",\"invoke\",\"exceptions.clj\",100],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722$fn__110723\",\"invoke\",\"log.clj\",233],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invokeStatic\",\"diagnostic.clj\",17],[\"metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info\",\"invoke\",\"diagnostic.clj\",12],[\"metabase.server.middleware.log$log_api_call$fn__110721$fn__110722\",\"invoke\",\"log.clj\",224],[\"toucan2.execute$do_with_call_counts\",\"invokeStatic\",\"execute.clj\",112],[\"toucan2.execute$do_with_call_counts\",\"invoke\",\"execute.clj\",103],[\"metabase.server.middleware.log$log_api_call$fn__110721\",\"invoke\",\"log.clj\",223],[\"metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114458\",\"invoke\",\"browser_cookie.clj\",42],[\"metabase.server.middleware.security$add_security_headers$fn__107039\",\"invoke\",\"security.clj\",273],[\"ring.middleware.json$wrap_json_body$fn__114717\",\"invoke\",\"json.clj\",64],[\"metabase.server.middleware.offset_paging$handle_paging$fn__96549\",\"invoke\",\"offset_paging.clj\",56],[\"metabase.server.middleware.json$wrap_streamed_json_response$fn__55895\",\"invoke\",\"json.clj\",88],[\"ring.middleware.keyword_params$wrap_keyword_params$fn__114806\",\"invoke\",\"keyword_params.clj\",55],[\"ring.middleware.params$wrap_params$fn__114825\",\"invoke\",\"params.clj\",77],[\"metabase.server.middleware.misc$maybe_set_site_url$fn__86190\",\"invoke\",\"misc.clj\",59],[\"metabase.server.middleware.session$reset_session_timeout$fn__72190\",\"invoke\",\"session.clj\",566],[\"metabase.server.middleware.session$bind_current_user$fn__72156$fn__72157\",\"invoke\",\"session.clj\",459],[\"metabase.server.middleware.session$do_with_current_user\",\"invokeStatic\",\"session.clj\",438],[\"metabase.server.middleware.session$do_with_current_user\",\"invoke\",\"session.clj\",421],[\"metabase.server.middleware.session$bind_current_user$fn__72156\",\"invoke\",\"session.clj\",458],[\"metabase.server.middleware.session$wrap_current_user_info$fn__72133\",\"invoke\",\"session.clj\",383],[\"metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78484\",\"invoke\",\"sdk.clj\",63],[\"metabase.server.middleware.session$wrap_session_id$fn__72105\",\"invoke\",\"session.clj\",261],[\"metabase.server.middleware.auth$wrap_static_api_key$fn__104962\",\"invoke\",\"auth.clj\",33],[\"ring.middleware.cookies$wrap_cookies$fn__114645\",\"invoke\",\"cookies.clj\",200],[\"metabase.server.middleware.misc$add_content_type$fn__86172\",\"invoke\",\"misc.clj\",28],[\"metabase.server.middleware.misc$disable_streaming_buffering$fn__86198\",\"invoke\",\"misc.clj\",75],[\"ring.middleware.gzip$wrap_gzip$fn__114687\",\"invoke\",\"gzip.clj\",86],[\"metabase.server.middleware.request_id$wrap_request_id$fn__110417\",\"invoke\",\"request_id.clj\",9],[\"metabase.server.middleware.misc$bind_request$fn__86201\",\"invoke\",\"misc.clj\",91],[\"metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114474\",\"invoke\",\"ssl.clj\",41],[\"metabase.server$async_proxy_handler$fn__56864\",\"invoke\",\"server.clj\",77],[\"metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a\",\"handle\",null,-1],[\"org.eclipse.jetty.server.handler.StatisticsHandler\",\"handle\",\"StatisticsHandler.java\",173],[\"org.eclipse.jetty.server.handler.HandlerWrapper\",\"handle\",\"HandlerWrapper.java\",122],[\"org.eclipse.jetty.server.Server\",\"handle\",\"Server.java\",563],[\"org.eclipse.jetty.server.HttpChannel$RequestDispatchable\",\"dispatch\",\"HttpChannel.java\",1598],[\"org.eclipse.jetty.server.HttpChannel\",\"dispatch\",\"HttpChannel.java\",753],[\"org.eclipse.jetty.server.HttpChannel\",\"handle\",\"HttpChannel.java\",501],[\"org.eclipse.jetty.server.HttpConnection\",\"onFillable\",\"HttpConnection.java\",287],[\"org.eclipse.jetty.io.AbstractConnection$ReadCallback\",\"succeeded\",\"AbstractConnection.java\",314],[\"org.eclipse.jetty.io.FillInterest\",\"fillable\",\"FillInterest.java\",100],[\"org.eclipse.jetty.io.SelectableChannelEndPoint$1\",\"run\",\"SelectableChannelEndPoint.java\",53],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"runTask\",\"AdaptiveExecutionStrategy.java\",421],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"consumeTask\",\"AdaptiveExecutionStrategy.java\",390],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"tryProduce\",\"AdaptiveExecutionStrategy.java\",277],[\"org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy\",\"run\",\"AdaptiveExecutionStrategy.java\",199],[\"org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread\",\"run\",\"ReservedThreadExecutor.java\",411],[\"org.eclipse.jetty.util.thread.QueuedThreadPool\",\"runJob\",\"QueuedThreadPool.java\",969],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"doRunJob\",\"QueuedThreadPool.java\",1194],[\"org.eclipse.jetty.util.thread.QueuedThreadPool$Runner\",\"run\",\"QueuedThreadPool.java\",1149],[\"java.lang.Thread\",\"run\",null,-1]],\"cause\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"data\":{\"status-code\":400,\"query-database\":2,\"field-filter-database\":16,\"toucan2/context-trace\":[[\"execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection\",{\"toucan2.jdbc.query/sql-args\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5481]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class org.postgresql.jdbc.PgConnection\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}],{\"toucan2.pipeline/rf\":\"clojure.core$map$fn__5950$fn__5951@75abb506\"},[\"with compiled query\",{\"toucan2.pipeline/compiled-query\":[\"SELECT * FROM \\\"report_card\\\" WHERE \\\"id\\\" = ?\",5481]}],[\"with built query\",{\"toucan2.pipeline/built-query\":{\"select\":[\"*\"],\"from\":[[\"report_card\"]],\"where\":[\"=\",\"id\",5481]}}],[\"apply before-update to matching rows\",{\"toucan2.tools.before-update/model\":\"model/Card\",\"toucan2.tools.before-update/changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"KYC dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",4073,null],\"widget-type\":\"string/=\"},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"Registration\":{\"type\":\"dimension\",\"name\":\"Registration\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Registration\",\"default\":null,\"dimension\":[\"field\",4094,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"with cte as(  \\n\\nselect to_date(REG_DT)                                                      as DT\\n                     , REG_SOURCE_MAIN                                                      as reg_source\\n                     , WIDGET_KYC_TYPE\\n                     , WIDGET_PARTNER_NAME\\n                     , KYC_SOURCE\\n                     , KYC_STATUS_KYC_SSN                                                   AS SSN_STATUS\\n                     , case when KYC_STATUS = 'GREEN' then 'Approved Checks'\\n                            when KYC_STATUS = 'RED' then 'Rejected Checks' end              AS Type_KYC\\n                from MART.USERS\\n                where KYC_STATUS in ('RED', 'GREEN') and REG_SOURCE_MAIN = 'widget'\\n                and DATE_TRUNC('week', REG_DT) != DATE_TRUNC('week', NOW()) \\n                and KYC_DOC_COUNTRY='United States of America' \\nand {{Registration}} \\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{TYPE}} and {{CARD_BIN}}\\n ) select Type_KYC, dt, count(1) as cnt_value\\n                  from cte and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_goal\":false,\"graph.show_trendline\":false,\"graph.y_axis.title_text\":\"Count checks\",\"graph.show_values\":true,\"graph.x_axis.title_text\":\"Date\",\"graph.label_value_frequency\":\"fit\",\"graph.metrics\":[\"CNT_VALUE\"],\"graph.y_axis.axis_enabled\":true,\"graph.show_stack_values\":\"total\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DT\",\"TYPE_KYC\"],\"stackable.stack_type\":\"stacked\"},\"parameters\":[{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"},{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"Registration\"]],\"name\":\"Registration\",\"slug\":\"Registration\"}]}}],[\"with resolved query\",{\"toucan2.pipeline/resolved-query\":{}}],[\"with parsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/parsed-args\":{\"changes\":{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"KYC dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",4073,null],\"widget-type\":\"string/=\"},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"Registration\":{\"type\":\"dimension\",\"name\":\"Registration\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Registration\",\"default\":null,\"dimension\":[\"field\",4094,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"with cte as(  \\n\\nselect to_date(REG_DT)                                                      as DT\\n                     , REG_SOURCE_MAIN                                                      as reg_source\\n                     , WIDGET_KYC_TYPE\\n                     , WIDGET_PARTNER_NAME\\n                     , KYC_SOURCE\\n                     , KYC_STATUS_KYC_SSN                                                   AS SSN_STATUS\\n                     , case when KYC_STATUS = 'GREEN' then 'Approved Checks'\\n                            when KYC_STATUS = 'RED' then 'Rejected Checks' end              AS Type_KYC\\n                from MART.USERS\\n                where KYC_STATUS in ('RED', 'GREEN') and REG_SOURCE_MAIN = 'widget'\\n                and DATE_TRUNC('week', REG_DT) != DATE_TRUNC('week', NOW()) \\n                and KYC_DOC_COUNTRY='United States of America' \\nand {{Registration}} \\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{TYPE}} and {{CARD_BIN}}\\n ) select Type_KYC, dt, count(1) as cnt_value\\n                  from cte and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_goal\":false,\"graph.show_trendline\":false,\"graph.y_axis.title_text\":\"Count checks\",\"graph.show_values\":true,\"graph.x_axis.title_text\":\"Date\",\"graph.label_value_frequency\":\"fit\",\"graph.metrics\":[\"CNT_VALUE\"],\"graph.y_axis.axis_enabled\":true,\"graph.show_stack_values\":\"total\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DT\",\"TYPE_KYC\"],\"stackable.stack_type\":\"stacked\"},\"parameters\":[{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"},{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"Registration\"]],\"name\":\"Registration\",\"slug\":\"Registration\"}]},\"queryable\":{},\"kv-args\":{\"toucan/pk\":5481}}}],[\"with model\",{\"toucan2.pipeline/model\":\"model/Card\"}],[\"with unparsed args\",{\"toucan2.pipeline/query-type\":\"toucan.query-type/update.update-count\",\"toucan2.pipeline/unparsed-args\":[\"model/Card\",5481,{\"description\":null,\"archived\":false,\"collection_position\":null,\"result_metadata\":[],\"enable_embedding\":false,\"collection_id\":820,\"name\":\"KYC dynamic\",\"verified-result-metadata?\":true,\"type\":\"question\",\"cache_ttl\":null,\"dataset_query\":{\"database\":2,\"type\":\"native\",\"native\":{\"template-tags\":{\"PAY_SYSTEM\":{\"type\":\"dimension\",\"name\":\"PAY_SYSTEM\",\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"display-name\":\"Pay System\",\"dimension\":[\"field\",20885,null],\"widget-type\":\"string/=\"},\"WIDGET_PARTNER_NAME\":{\"type\":\"dimension\",\"name\":\"WIDGET_PARTNER_NAME\",\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"display-name\":\"Widget Partner Name\",\"dimension\":[\"field\",4073,null],\"widget-type\":\"string/=\"},\"TYPE\":{\"type\":\"dimension\",\"name\":\"TYPE\",\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"display-name\":\"Type\",\"dimension\":[\"field\",20838,null],\"widget-type\":\"string/=\"},\"CARD_BIN\":{\"type\":\"dimension\",\"name\":\"CARD_BIN\",\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"display-name\":\"Card Bin\",\"default\":null,\"dimension\":[\"field\",767,null],\"widget-type\":\"string/=\"},\"Registration\":{\"type\":\"dimension\",\"name\":\"Registration\",\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"display-name\":\"Registration\",\"default\":null,\"dimension\":[\"field\",4094,null],\"widget-type\":\"date/all-options\"},\"Card_Geo\":{\"type\":\"dimension\",\"name\":\"Card_Geo\",\"id\":\"f9338c61-c741-44d7-a6a5-ac57bac8b387\",\"display-name\":\"Card Geo\",\"dimension\":[\"field\",756074,null],\"widget-type\":\"string/=\"},\"CARD_ISOCOUNTRY\":{\"type\":\"dimension\",\"name\":\"CARD_ISOCOUNTRY\",\"id\":\"3c2e2b6a-c8ca-4c78-824e-32e304de4bd9\",\"display-name\":\"Card Isocountry\",\"default\":null,\"dimension\":[\"field\",756215,null],\"widget-type\":\"string/contains\",\"options\":{\"case-sensitive\":false}}},\"query\":\"with cte as(  \\n\\nselect to_date(REG_DT)                                                      as DT\\n                     , REG_SOURCE_MAIN                                                      as reg_source\\n                     , WIDGET_KYC_TYPE\\n                     , WIDGET_PARTNER_NAME\\n                     , KYC_SOURCE\\n                     , KYC_STATUS_KYC_SSN                                                   AS SSN_STATUS\\n                     , case when KYC_STATUS = 'GREEN' then 'Approved Checks'\\n                            when KYC_STATUS = 'RED' then 'Rejected Checks' end              AS Type_KYC\\n                from MART.USERS\\n                where KYC_STATUS in ('RED', 'GREEN') and REG_SOURCE_MAIN = 'widget'\\n                and DATE_TRUNC('week', REG_DT) != DATE_TRUNC('week', NOW()) \\n                and KYC_DOC_COUNTRY='United States of America' \\nand {{Registration}} \\nand {{PAY_SYSTEM}} and {{WIDGET_PARTNER_NAME}} and {{TYPE}} and {{CARD_BIN}}\\n ) select Type_KYC, dt, count(1) as cnt_value\\n                  from cte and {{Card_Geo}}group by\"}},\"parameter_mappings\":[],\"display\":\"bar\",\"archived_directly\":false,\"collection_preview\":true,\"visualization_settings\":{\"graph.show_goal\":false,\"graph.show_trendline\":false,\"graph.y_axis.title_text\":\"Count checks\",\"graph.show_values\":true,\"graph.x_axis.title_text\":\"Date\",\"graph.label_value_frequency\":\"fit\",\"graph.metrics\":[\"CNT_VALUE\"],\"graph.y_axis.axis_enabled\":true,\"graph.show_stack_values\":\"total\",\"graph.label_value_formatting\":\"auto\",\"graph.dimensions\":[\"DT\",\"TYPE_KYC\"],\"stackable.stack_type\":\"stacked\"},\"parameters\":[{\"id\":\"d08fbf9b-68ea-4906-bd1b-186b5aa73330\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"PAY_SYSTEM\"]],\"name\":\"Pay System\",\"slug\":\"PAY_SYSTEM\"},{\"id\":\"6327ab6f-1235-4157-b45e-4b1f9425b5d4\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"WIDGET_PARTNER_NAME\"]],\"name\":\"Widget Partner Name\",\"slug\":\"WIDGET_PARTNER_NAME\"},{\"id\":\"a716ead1-bce3-46fc-b726-9f883f099e5f\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"TYPE\"]],\"name\":\"Type\",\"slug\":\"TYPE\"},{\"id\":\"7aca042c-08a3-400a-8df1-8394c48ca875\",\"type\":\"string/=\",\"target\":[\"dimension\",[\"template-tag\",\"CARD_BIN\"]],\"name\":\"Card Bin\",\"slug\":\"CARD_BIN\"},{\"id\":\"764144ae-9181-4109-af3d-1fc83ae0e936\",\"type\":\"date/all-options\",\"target\":[\"dimension\",[\"template-tag\",\"Registration\"]],\"name\":\"Registration\",\"slug\":\"Registration\"}]}]}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"class metabase.db.connection.ApplicationDB\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":\"default\"}],[\"resolve connection\",{\"toucan2.connection/connectable\":null}]]},\"message\":\"Invalid Field Filter: Field 756074 \\\"MART__TRANSACTIONS\\\".\\\"CARD_GEOSCHEME\\\" belongs to Database 16 \\\"SR METABASE_VIEWS\\\", but the query is against Database 2 \\\"Exasol\\\"\",\"query-database\":2,\"field-filter-database\":16}"
    }
  ],
  "total_cards": 30
}